{"version":3,"names":["AuthMiddleware","require","jwt","assert","AuthSecurityTest","constructor","testResults","passed","failed","total","details","authMiddleware","mockRedis","runAllTests","console","log","setupMockRedis","testValidJWTAuthentication","testInvalidJWTToken","testExpiredJWTToken","testTokenBlacklist","testRateLimiting","testIPReputation","testRoleBasedAuthorization","testAPIKeyValidation","testSessionValidation","testSecurityLogging","generateTestReport","_getJestObj","mock","createClient","jest","fn","configService","get","key","config","getJWTConfig","secret","algorithm","issuer","isProduction","loggerService","error","info","warn","logSecurity","logAuth","data","connect","mockResolvedValue","on","Promise","resolve","setEx","ttl","value","del","hGetAll","hIncrBy","field","increment","parseInt","toString","hSet","expire","multi","zRemRangeByScore","mockReturnThis","zAdd","zCard","exec","reply","initializeRedis","validToken","sign","userId","role","iat","Math","floor","Date","now","exp","process","env","JWT_SECRET","mockReq","headers","authorization","ip","originalUrl","header","mockRes","status","json","mockNext","authenticate","called","user","userRole","token","push","test","message","calledWith","errorResponse","calls","expiredToken","blacklistToken","set","rateLimitMiddleware","rateLimit","max","windowMs","calledOnce","mockClear","suspiciousIP","i","recordFailedAttempt","includes","adminMiddleware","adminOnly","managerMiddleware","managerOrAdmin","validApiKeys","id","createdAt","apiKeyMiddleware","validateApiKey","sessionId","sessionData","expiresAt","lastActivity","JSON","stringify","sessionMiddleware","validateSession","session","securityDetails","userAgent","reason","path","mockLogger","logger","toFixed","forEach","detail","index","main","module","catch","exports"],"sources":["auth.test.js"],"sourcesContent":["const { AuthMiddleware } = require('../middleware/auth');\r\nconst jwt = require('jsonwebtoken');\r\nconst assert = require('assert');\r\n\r\n// Test Authentication Security Improvements (JWT, Rate Limiting, Token Blacklist)\r\nclass AuthSecurityTest {\r\n  constructor() {\r\n    this.testResults = {\r\n      passed: 0,\r\n      failed: 0,\r\n      total: 0,\r\n      details: []\r\n    };\r\n    this.authMiddleware = null;\r\n    this.mockRedis = null;\r\n  }\r\n\r\n  async runAllTests() {\r\n    console.log('üß™ Starting Authentication Security Tests...\\n');\r\n    \r\n    await this.setupMockRedis();\r\n    await this.testValidJWTAuthentication();\r\n    await this.testInvalidJWTToken();\r\n    await this.testExpiredJWTToken();\r\n    await this.testTokenBlacklist();\r\n    await this.testRateLimiting();\r\n    await this.testIPReputation();\r\n    await this.testRoleBasedAuthorization();\r\n    await this.testAPIKeyValidation();\r\n    await this.testSessionValidation();\r\n    await this.testSecurityLogging();\r\n    \r\n    this.generateTestReport();\r\n  }\r\n\r\n  async setupMockRedis() {\r\n    // Mock Redis for testing\r\n    this.mockRedis = {\r\n      data: {},\r\n      connect: jest.fn().mockResolvedValue(true),\r\n      on: jest.fn(),\r\n      get: jest.fn((key) => Promise.resolve(this.mockRedis.data[key] || null)),\r\n      setEx: jest.fn((key, ttl, value) => {\r\n        this.mockRedis.data[key] = value;\r\n        return Promise.resolve('OK');\r\n      }),\r\n      del: jest.fn((key) => {\r\n        delete this.mockRedis.data[key];\r\n        return Promise.resolve(1);\r\n      }),\r\n      hGetAll: jest.fn((key) => Promise.resolve(this.mockRedis.data[key] || {})),\r\n      hIncrBy: jest.fn((key, field, increment) => {\r\n        if (!this.mockRedis.data[key]) this.mockRedis.data[key] = {};\r\n        this.mockRedis.data[key][field] = (parseInt(this.mockRedis.data[key][field] || 0) + increment).toString();\r\n        return Promise.resolve(this.mockRedis.data[key][field]);\r\n      }),\r\n      hSet: jest.fn((key, field, value) => {\r\n        if (!this.mockRedis.data[key]) this.mockRedis.data[key] = {};\r\n        this.mockRedis.data[key][field] = value;\r\n        return Promise.resolve(1);\r\n      }),\r\n      expire: jest.fn((key, ttl) => Promise.resolve(1)),\r\n      multi: jest.fn(() => ({\r\n        zRemRangeByScore: jest.fn().mockReturnThis(),\r\n        zAdd: jest.fn().mockReturnThis(),\r\n        zCard: jest.fn().mockResolvedValue(1),\r\n        expire: jest.fn().mockReturnThis(),\r\n        exec: jest.fn().mockResolvedValue([{ reply: 1 }, { reply: 1 }, { reply: 1 }])\r\n      }))\r\n    };\r\n\r\n    // Mock Redis module\r\n    jest.mock('redis', () => ({\r\n      createClient: jest.fn(() => this.mockRedis)\r\n    }));\r\n\r\n    // Mock config service\r\n    jest.mock('../services/config', () => ({\r\n      configService: {\r\n        get: jest.fn((key) => {\r\n          const config = {\r\n            'REDIS_URL': 'redis://localhost:6379',\r\n            'NODE_ENV': 'test'\r\n          };\r\n          return config[key];\r\n        }),\r\n        getJWTConfig: jest.fn(() => ({\r\n          secret: 'test-jwt-secret',\r\n          algorithm: 'HS256',\r\n          issuer: 'smart-technologies-bd'\r\n        })),\r\n        isProduction: jest.fn(() => false)\r\n      }\r\n    }));\r\n\r\n    // Mock logger service\r\n    jest.mock('../services/logger', () => ({\r\n      loggerService: {\r\n        error: jest.fn(),\r\n        info: jest.fn(),\r\n        warn: jest.fn(),\r\n        logSecurity: jest.fn(),\r\n        logAuth: jest.fn()\r\n      }\r\n    }));\r\n\r\n    this.authMiddleware = new AuthMiddleware();\r\n    await this.authMiddleware.initializeRedis();\r\n  }\r\n\r\n  async testValidJWTAuthentication() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 1: Valid JWT Authentication');\r\n    \r\n    try {\r\n      // Create a valid JWT token\r\n      const validToken = jwt.sign(\r\n        { userId: 'user123', role: 'CUSTOMER', iat: Math.floor(Date.now() / 1000), exp: Math.floor(Date.now() / 1000) + 3600 },\r\n        process.env.JWT_SECRET || 'test-jwt-secret',\r\n        { algorithm: 'HS256', issuer: 'smart-technologies-bd' }\r\n      );\r\n\r\n      const mockReq = {\r\n        headers: { authorization: `Bearer ${validToken}` },\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const authMiddleware = this.authMiddleware.authenticate();\r\n      await authMiddleware(mockReq, mockRes, mockNext);\r\n\r\n      assert(mockNext.called, 'Next should be called for valid token');\r\n      assert(mockReq.user.userId === 'user123', 'User ID should be set');\r\n      assert(mockReq.userRole === 'CUSTOMER', 'User role should be set');\r\n      assert(mockReq.token === validToken, 'Token should be set');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Valid JWT Authentication',\r\n        status: 'PASSED',\r\n        message: 'Valid JWT token authenticated successfully'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Valid JWT authentication working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Valid JWT Authentication',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testInvalidJWTToken() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 2: Invalid JWT Token');\r\n    \r\n    try {\r\n      const mockReq = {\r\n        headers: { authorization: 'Bearer invalid-token' },\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const authMiddleware = this.authMiddleware.authenticate();\r\n      await authMiddleware(mockReq, mockRes, mockNext);\r\n\r\n      assert(!mockNext.called, 'Next should not be called for invalid token');\r\n      assert(mockRes.status.calledWith(401), 'Should return 401 status');\r\n      assert(mockRes.json.called, 'Should return error response');\r\n      \r\n      const errorResponse = mockRes.json.mock.calls[0][0];\r\n      assert(errorResponse.error === 'Authentication failed', 'Should return authentication error');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Invalid JWT Token',\r\n        status: 'PASSED',\r\n        message: 'Invalid JWT token properly rejected'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Invalid JWT token rejection working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Invalid JWT Token',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testExpiredJWTToken() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 3: Expired JWT Token');\r\n    \r\n    try {\r\n      // Create an expired JWT token\r\n      const expiredToken = jwt.sign(\r\n        { userId: 'user123', role: 'CUSTOMER', iat: Math.floor(Date.now() / 1000) - 7200, exp: Math.floor(Date.now() / 1000) - 3600 },\r\n        'test-jwt-secret',\r\n        { algorithm: 'HS256', issuer: 'smart-technologies-bd' }\r\n      );\r\n\r\n      const mockReq = {\r\n        headers: { authorization: `Bearer ${expiredToken}` },\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const authMiddleware = this.authMiddleware.authenticate();\r\n      await authMiddleware(mockReq, mockRes, mockNext);\r\n\r\n      assert(!mockNext.called, 'Next should not be called for expired token');\r\n      assert(mockRes.status.calledWith(401), 'Should return 401 status');\r\n      \r\n      const errorResponse = mockRes.json.mock.calls[0][0];\r\n      assert(errorResponse.error === 'Authentication failed', 'Should return authentication error');\r\n      assert(errorResponse.message === 'Token has expired', 'Should specify token expired');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Expired JWT Token',\r\n        status: 'PASSED',\r\n        message: 'Expired JWT token properly rejected'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Expired JWT token rejection working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Expired JWT Token',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testTokenBlacklist() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 4: Token Blacklist');\r\n    \r\n    try {\r\n      // Create a valid JWT token\r\n      const validToken = jwt.sign(\r\n        { userId: 'user123', role: 'CUSTOMER', iat: Math.floor(Date.now() / 1000), exp: Math.floor(Date.now() / 1000) + 3600 },\r\n        process.env.JWT_SECRET || 'test-jwt-secret',\r\n        { algorithm: 'HS256', issuer: 'smart-technologies-bd' }\r\n      );\r\n\r\n      // Blacklist the token\r\n      await this.authMiddleware.blacklistToken(validToken, 'Test logout');\r\n\r\n      const mockReq = {\r\n        headers: { authorization: `Bearer ${validToken}` },\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const authMiddleware = this.authMiddleware.authenticate();\r\n      await authMiddleware(mockReq, mockRes, mockNext);\r\n\r\n      assert(!mockNext.called, 'Next should not be called for blacklisted token');\r\n      assert(mockRes.status.calledWith(401), 'Should return 401 status');\r\n      \r\n      const errorResponse = mockRes.json.mock.calls[0][0];\r\n      assert(errorResponse.error === 'Token revoked', 'Should return token revoked error');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Token Blacklist',\r\n        status: 'PASSED',\r\n        message: 'Blacklisted token properly rejected'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Token blacklist working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Token Blacklist',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testRateLimiting() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 5: Rate Limiting');\r\n    \r\n    try {\r\n      const mockReq = {\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn(),\r\n        set: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const rateLimitMiddleware = this.authMiddleware.rateLimit({ max: 2, windowMs: 1000 });\r\n      \r\n      // First request should pass\r\n      await rateLimitMiddleware(mockReq, mockRes, mockNext);\r\n      assert(mockNext.calledOnce, 'First request should pass');\r\n      \r\n      // Second request should pass\r\n      mockNext.mockClear();\r\n      await rateLimitMiddleware(mockReq, mockRes, mockNext);\r\n      assert(mockNext.calledOnce, 'Second request should pass');\r\n      \r\n      // Third request should be rate limited\r\n      mockNext.mockClear();\r\n      await rateLimitMiddleware(mockReq, mockRes, mockNext);\r\n      assert(!mockNext.called, 'Third request should be rate limited');\r\n      assert(mockRes.status.calledWith(429), 'Should return 429 status');\r\n      \r\n      const errorResponse = mockRes.json.mock.calls[0][0];\r\n      assert(errorResponse.error === 'Too many requests', 'Should return rate limit error');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Rate Limiting',\r\n        status: 'PASSED',\r\n        message: 'Rate limiting working correctly'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Rate limiting working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Rate Limiting',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testIPReputation() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 6: IP Reputation');\r\n    \r\n    try {\r\n      // Record multiple failed attempts for an IP\r\n      const suspiciousIP = '192.168.1.100';\r\n      for (let i = 0; i < 15; i++) {\r\n        await this.authMiddleware.recordFailedAttempt(suspiciousIP, 'authentication');\r\n      }\r\n\r\n      // Create a valid JWT token\r\n      const validToken = jwt.sign(\r\n        { userId: 'user123', role: 'CUSTOMER', iat: Math.floor(Date.now() / 1000), exp: Math.floor(Date.now() / 1000) + 3600 },\r\n        'test-jwt-secret',\r\n        { algorithm: 'HS256', issuer: 'smart-technologies-bd' }\r\n      );\r\n\r\n      const mockReq = {\r\n        headers: { authorization: `Bearer ${validToken}` },\r\n        ip: suspiciousIP,\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const authMiddleware = this.authMiddleware.authenticate();\r\n      await authMiddleware(mockReq, mockRes, mockNext);\r\n\r\n      assert(!mockNext.called, 'Next should not be called for suspicious IP');\r\n      assert(mockRes.status.calledWith(403), 'Should return 403 status');\r\n      \r\n      const errorResponse = mockRes.json.mock.calls[0][0];\r\n      assert(errorResponse.error === 'Access denied', 'Should return access denied error');\r\n      assert(errorResponse.message.includes('Suspicious activity'), 'Should mention suspicious activity');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'IP Reputation',\r\n        status: 'PASSED',\r\n        message: 'Suspicious IP properly blocked'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: IP reputation system working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'IP Reputation',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testRoleBasedAuthorization() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 7: Role-Based Authorization');\r\n    \r\n    try {\r\n      // Test admin-only middleware\r\n      const mockReq = {\r\n        user: { userId: 'user123', role: 'ADMIN' }\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const adminMiddleware = this.authMiddleware.adminOnly();\r\n      adminMiddleware(mockReq, mockRes, mockNext);\r\n      assert(mockNext.calledOnce, 'Admin user should pass admin-only check');\r\n\r\n      // Test unauthorized user\r\n      mockReq.user.role = 'CUSTOMER';\r\n      mockNext.mockClear();\r\n      adminMiddleware(mockReq, mockRes, mockNext);\r\n      assert(!mockNext.called, 'Non-admin user should not pass admin-only check');\r\n      assert(mockRes.status.calledWith(403), 'Should return 403 for unauthorized role');\r\n      \r\n      // Test manager-or-admin middleware\r\n      mockReq.user.role = 'MANAGER';\r\n      mockNext.mockClear();\r\n      const managerMiddleware = this.authMiddleware.managerOrAdmin();\r\n      managerMiddleware(mockReq, mockRes, mockNext);\r\n      assert(mockNext.calledOnce, 'Manager should pass manager-or-admin check');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Role-Based Authorization',\r\n        status: 'PASSED',\r\n        message: 'Role-based authorization working correctly'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Role-based authorization working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Role-Based Authorization',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testAPIKeyValidation() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 8: API Key Validation');\r\n    \r\n    try {\r\n      const validApiKeys = [\r\n        'valid-api-key-1',\r\n        { key: 'valid-api-key-2', id: 'key2', createdAt: Date.now() - 86400000 }\r\n      ];\r\n\r\n      // Test valid API key\r\n      const mockReq = {\r\n        headers: { 'x-api-key': 'valid-api-key-1' },\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const apiKeyMiddleware = this.authMiddleware.validateApiKey(validApiKeys);\r\n      apiKeyMiddleware(mockReq, mockRes, mockNext);\r\n      assert(mockNext.calledOnce, 'Valid API key should pass');\r\n\r\n      // Test invalid API key\r\n      mockReq.headers['x-api-key'] = 'invalid-api-key';\r\n      mockNext.mockClear();\r\n      apiKeyMiddleware(mockReq, mockRes, mockNext);\r\n      assert(!mockNext.called, 'Invalid API key should not pass');\r\n      assert(mockRes.status.calledWith(401), 'Should return 401 for invalid API key');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'API Key Validation',\r\n        status: 'PASSED',\r\n        message: 'API key validation working correctly'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: API key validation working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'API Key Validation',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testSessionValidation() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 9: Session Validation');\r\n    \r\n    try {\r\n      // Create a valid session\r\n      const sessionId = 'session-123';\r\n      const sessionData = {\r\n        userId: 'user123',\r\n        ip: '192.168.1.1',\r\n        expiresAt: Date.now() + 3600000,\r\n        lastActivity: Date.now()\r\n      };\r\n      \r\n      this.mockRedis.data[`session:${sessionId}`] = JSON.stringify(sessionData);\r\n\r\n      const mockReq = {\r\n        headers: { 'x-session-id': sessionId },\r\n        ip: '192.168.1.1',\r\n        originalUrl: '/api/v1/products',\r\n        get: jest.fn((header) => header === 'User-Agent' ? 'test-agent' : null)\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      const sessionMiddleware = this.authMiddleware.validateSession();\r\n      await sessionMiddleware(mockReq, mockRes, mockNext);\r\n      assert(mockNext.calledOnce, 'Valid session should pass');\r\n      assert(mockReq.session.userId === 'user123', 'Session user should be set');\r\n\r\n      // Test invalid session\r\n      mockReq.headers['x-session-id'] = 'invalid-session';\r\n      mockNext.mockClear();\r\n      await sessionMiddleware(mockReq, mockRes, mockNext);\r\n      assert(!mockNext.called, 'Invalid session should not pass');\r\n      assert(mockRes.status.calledWith(401), 'Should return 401 for invalid session');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Session Validation',\r\n        status: 'PASSED',\r\n        message: 'Session validation working correctly'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Session validation working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Session Validation',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  async testSecurityLogging() {\r\n    this.testResults.total++;\r\n    console.log('üîç Test 10: Security Logging');\r\n    \r\n    try {\r\n      // Test security event logging\r\n      const securityDetails = {\r\n        ip: '192.168.1.1',\r\n        userAgent: 'test-agent',\r\n        reason: 'Invalid API key',\r\n        path: '/api/v1/products'\r\n      };\r\n\r\n      // Mock logger to capture security logs\r\n      const mockLogger = {\r\n        logSecurity: jest.fn()\r\n      };\r\n      \r\n      this.authMiddleware.logger = mockLogger;\r\n      this.authMiddleware.logSecurity('Invalid API Key Attempt', securityDetails);\r\n\r\n      assert(mockLogger.logSecurity.calledOnce, 'Security logging should be called');\r\n      assert(mockLogger.logSecurity.calledWith('Invalid API Key Attempt', null, securityDetails), 'Should log with correct details');\r\n      \r\n      this.testResults.passed++;\r\n      this.testResults.details.push({\r\n        test: 'Security Logging',\r\n        status: 'PASSED',\r\n        message: 'Security logging working correctly'\r\n      });\r\n      \r\n      console.log('‚úÖ PASSED: Security logging working correctly\\n');\r\n      \r\n    } catch (error) {\r\n      this.testResults.failed++;\r\n      this.testResults.details.push({\r\n        test: 'Security Logging',\r\n        status: 'FAILED',\r\n        message: error.message\r\n      });\r\n      \r\n      console.log(`‚ùå FAILED: ${error.message}\\n`);\r\n    }\r\n  }\r\n\r\n  generateTestReport() {\r\n    console.log('\\nüìä AUTHENTICATION SECURITY TEST REPORT');\r\n    console.log('======================================');\r\n    console.log(`Total Tests: ${this.testResults.total}`);\r\n    console.log(`Passed: ${this.testResults.passed}`);\r\n    console.log(`Failed: ${this.testResults.failed}`);\r\n    console.log(`Success Rate: ${((this.testResults.passed / this.testResults.total) * 100).toFixed(2)}%\\n`);\r\n    \r\n    console.log('üìã Detailed Results:');\r\n    this.testResults.details.forEach((detail, index) => {\r\n      const status = detail.status === 'PASSED' ? '‚úÖ' : '‚ùå';\r\n      console.log(`${index + 1}. ${status} ${detail.test}: ${detail.message}`);\r\n    });\r\n    \r\n    return this.testResults;\r\n  }\r\n}\r\n\r\n// Run tests if this file is executed directly\r\nif (require.main === module) {\r\n  const test = new AuthSecurityTest();\r\n  test.runAllTests().catch(console.error);\r\n}\r\n\r\nmodule.exports = AuthSecurityTest;"],"mappings":"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","ignoreList":[]}