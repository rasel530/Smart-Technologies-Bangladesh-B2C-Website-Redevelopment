{"version":3,"names":["PrismaClient","require","DatabaseService","constructor","connectionPool","activeConnections","idleConnections","totalConnections","maxConnections","connectionTimeout","idleTimeout","acquireTimeoutMillis","createTimeoutMillis","destroyTimeoutMillis","reapIntervalMillis","createRetryIntervalMillis","connectionStartTime","queryCount","errorCount","prisma","log","emit","level","datasources","db","url","process","env","DATABASE_URL","__internal","engine","connectionLimit","poolTimeout","setupEventListeners","connect","startTime","Date","now","maxRetries","retryDelay","attempt","$connect","connectionTime","console","poolStats","getConnectionPoolStats","error","message","code","timestamp","toISOString","Promise","resolve","setTimeout","totalAttempts","totalDuration","databaseUrl","config","environment","NODE_ENV","disconnect","$disconnect","healthCheck","result","$queryRaw","responseTime","status","database","getStats","userCount","productCount","categoryCount","brandCount","orderCount","reviewCount","couponCount","all","user","count","product","category","brand","order","review","coupon","users","products","categories","brands","orders","reviews","coupons","transaction","callback","$transaction","getClient","query","sql","params","getDivisions","divisions","map","row","division","getPaymentMethods","paymentMethods","paymentMethod","utilizationRate","toFixed","timeouts","connection","idle","acquire","$on","event","duration","target","warn","on","cleanupConnections","databaseService","module","exports"],"sources":["database.js"],"sourcesContent":["const { PrismaClient } = require('@prisma/client');\r\n\r\nclass DatabaseService {\r\n  constructor() {\r\n    this.connectionPool = {\r\n      activeConnections: 0,\r\n      idleConnections: 0,\r\n      totalConnections: 0,\r\n      maxConnections: 10,\r\n      connectionTimeout: 30000,\r\n      idleTimeout: 10000,\r\n      acquireTimeoutMillis: 30000,\r\n      createTimeoutMillis: 30000,\r\n      destroyTimeoutMillis: 5000,\r\n      reapIntervalMillis: 1000,\r\n      createRetryIntervalMillis: 200,\r\n      connectionStartTime: null,\r\n      queryCount: 0,\r\n      errorCount: 0\r\n    };\r\n    \r\n    this.prisma = new PrismaClient({\r\n      log: [\r\n        {\r\n          emit: 'event',\r\n          level: 'query',\r\n        },\r\n        {\r\n          emit: 'event',\r\n          level: 'error',\r\n        },\r\n        {\r\n          emit: 'event',\r\n          level: 'info',\r\n        },\r\n        {\r\n          emit: 'event',\r\n          level: 'warn',\r\n        }\r\n      ],\r\n      // Enhanced connection configuration\r\n      datasources: {\r\n        db: {\r\n          url: process.env.DATABASE_URL,\r\n        }\r\n      },\r\n      // Connection pool settings\r\n      __internal: {\r\n        engine: {\r\n          connectionLimit: this.connectionPool.maxConnections,\r\n          poolTimeout: this.connectionPool.acquireTimeoutMillis,\r\n          idleTimeout: this.connectionPool.idleTimeout,\r\n          connectionTimeout: this.connectionPool.connectionTimeout\r\n        }\r\n      }\r\n    });\r\n    \r\n    // Set up event listeners for connection monitoring\r\n    this.setupEventListeners();\r\n  }\r\n\r\n  async connect() {\r\n    const startTime = Date.now();\r\n    const maxRetries = 3;\r\n    const retryDelay = 1000; // 1 second\r\n    \r\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n      try {\r\n        await this.prisma.$connect();\r\n        const connectionTime = Date.now() - startTime;\r\n        console.log(`‚úÖ Database connected successfully (attempt ${attempt}, ${connectionTime}ms)`);\r\n        \r\n        // Log connection pool status\r\n        const poolStats = this.getConnectionPoolStats();\r\n        console.log('üîç Database connection pool stats:', poolStats);\r\n        \r\n        return true;\r\n      } catch (error) {\r\n        console.error(`‚ùå Database connection attempt ${attempt} failed:`, {\r\n          error: error.message,\r\n          code: error.code,\r\n          attempt,\r\n          maxRetries,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n        \r\n        if (attempt < maxRetries) {\r\n          console.log(`üîÑ Retrying database connection in ${retryDelay}ms...`);\r\n          await new Promise(resolve => setTimeout(resolve, retryDelay));\r\n        } else {\r\n          // Log final failure with diagnostic info\r\n          console.error('üí• All database connection attempts failed:', {\r\n            totalAttempts: maxRetries,\r\n            totalDuration: Date.now() - startTime,\r\n            databaseUrl: this.config?.DATABASE_URL ? 'CONFIGURED' : 'MISSING',\r\n            environment: process.env.NODE_ENV || 'unknown'\r\n          });\r\n          throw error;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  async disconnect() {\r\n    try {\r\n      await this.prisma.$disconnect();\r\n      console.log('‚úÖ Database disconnected successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Database disconnection failed:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async healthCheck() {\r\n    const startTime = Date.now();\r\n    try {\r\n      // Enhanced query with NOW() for better timing measurement\r\n      const result = await this.prisma.$queryRaw`SELECT 1 as status, NOW() as server_time`;\r\n      const responseTime = Date.now() - startTime;\r\n      const poolStats = this.getConnectionPoolStats();\r\n      \r\n      return {\r\n        status: 'healthy',\r\n        database: 'connected',\r\n        responseTime: `${responseTime}ms`,\r\n        connectionPool: poolStats,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    } catch (error) {\r\n      const responseTime = Date.now() - startTime;\r\n      return {\r\n        status: 'unhealthy',\r\n        database: 'disconnected',\r\n        responseTime: `${responseTime}ms`,\r\n        error: error.message,\r\n        connectionPool: this.getConnectionPoolStats(),\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    }\r\n  }\r\n\r\n  async getStats() {\r\n    try {\r\n      const [\r\n        userCount,\r\n        productCount,\r\n        categoryCount,\r\n        brandCount,\r\n        orderCount,\r\n        reviewCount,\r\n        couponCount\r\n      ] = await Promise.all([\r\n        this.prisma.user.count(),\r\n        this.prisma.product.count(),\r\n        this.prisma.category.count(),\r\n        this.prisma.brand.count(),\r\n        this.prisma.order.count(),\r\n        this.prisma.review.count(),\r\n        this.prisma.coupon.count()\r\n      ]);\r\n\r\n      return {\r\n        users: userCount,\r\n        products: productCount,\r\n        categories: categoryCount,\r\n        brands: brandCount,\r\n        orders: orderCount,\r\n        reviews: reviewCount,\r\n        coupons: couponCount,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting database stats:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Transaction helper\r\n  async transaction(callback) {\r\n    return await this.prisma.$transaction(callback);\r\n  }\r\n\r\n  // Get client instance\r\n  getClient() {\r\n    return this.prisma;\r\n  }\r\n\r\n  // Raw query helper\r\n  async query(sql, params = []) {\r\n    try {\r\n      return await this.prisma.$queryRaw`${sql}`;\r\n    } catch (error) {\r\n      console.error('Raw query error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Bangladesh-specific helpers\r\n  async getDivisions() {\r\n    try {\r\n      const divisions = await this.prisma.$queryRaw`\r\n        SELECT DISTINCT division FROM addresses \r\n        WHERE division IS NOT NULL \r\n        ORDER BY division\r\n      `;\r\n      return divisions.map(row => row.division);\r\n    } catch (error) {\r\n      console.error('Error getting divisions:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getPaymentMethods() {\r\n    try {\r\n      const paymentMethods = await this.prisma.$queryRaw`\r\n        SELECT DISTINCT paymentMethod FROM orders \r\n        WHERE paymentMethod IS NOT NULL \r\n        ORDER BY paymentMethod\r\n      `;\r\n      return paymentMethods.map(row => row.paymentMethod);\r\n    } catch (error) {\r\n      console.error('Error getting payment methods:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  // Get connection pool statistics for diagnostics\r\n  getConnectionPoolStats() {\r\n    try {\r\n      const utilizationRate = this.connectionPool.maxConnections > 0\r\n        ? (this.connectionPool.activeConnections / this.connectionPool.maxConnections * 100).toFixed(2)\r\n        : 0;\r\n      \r\n      return {\r\n        activeConnections: this.connectionPool.activeConnections,\r\n        idleConnections: this.connectionPool.idleConnections,\r\n        totalConnections: this.connectionPool.totalConnections,\r\n        maxConnections: this.connectionPool.maxConnections,\r\n        utilizationRate: `${utilizationRate}%`,\r\n        timeouts: {\r\n          connection: this.connectionPool.connectionTimeout,\r\n          idle: this.connectionPool.idleTimeout,\r\n          acquire: this.connectionPool.acquireTimeoutMillis\r\n        },\r\n        queryCount: this.connectionPool.queryCount,\r\n        errorCount: this.connectionPool.errorCount,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to get connection pool stats:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Setup event listeners for Prisma events\r\n  setupEventListeners() {\r\n    try {\r\n      // Monitor query events\r\n      this.prisma.$on('query', (event) => {\r\n        this.connectionPool.queryCount++;\r\n        console.log('üîç Query:', {\r\n          query: event.query,\r\n          params: event.params,\r\n          duration: `${event.duration}ms`,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Monitor error events\r\n      this.prisma.$on('error', (event) => {\r\n        this.connectionPool.errorCount++;\r\n        console.error('‚ùå Database Error:', {\r\n          target: event.target,\r\n          message: event.message,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Monitor info events\r\n      this.prisma.$on('info', (event) => {\r\n        console.log('‚ÑπÔ∏è Database Info:', {\r\n          target: event.target,\r\n          message: event.message,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Monitor warning events\r\n      this.prisma.$on('warn', (event) => {\r\n        console.warn('‚ö†Ô∏è Database Warning:', {\r\n          target: event.target,\r\n          message: event.message,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Handle process exit for graceful cleanup\r\n      process.on('beforeExit', async () => {\r\n        console.log('üîÑ Process exiting, cleaning up database connections...');\r\n        await this.cleanupConnections();\r\n      });\r\n\r\n      console.log('‚úÖ Database event listeners setup completed');\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to setup event listeners:', error);\r\n    }\r\n  }\r\n\r\n  // Cleanup connections gracefully\r\n  async cleanupConnections() {\r\n    try {\r\n      console.log('üßπ Starting connection cleanup...');\r\n      \r\n      // Reset connection tracking\r\n      this.connectionPool.activeConnections = 0;\r\n      this.connectionPool.idleConnections = 0;\r\n      this.connectionPool.totalConnections = 0;\r\n      \r\n      // Disconnect from database\r\n      await this.prisma.$disconnect();\r\n      \r\n      console.log('‚úÖ Database connections cleaned up successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to cleanup connections:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst databaseService = new DatabaseService();\r\n\r\nmodule.exports = {\r\n  DatabaseService,\r\n  databaseService\r\n};"],"mappings":"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","ignoreList":[]}