6f6b7a2823da2ca2adbdb82a40e002b7
// Simple remember me functionality test without database dependencies
const {
  SessionService
} = require('../services/sessionService');
describe('Remember Me Simple Functionality', () => {
  let sessionService;
  beforeAll(() => {
    // Create session service instance with mocked dependencies
    sessionService = new SessionService();

    // Mock the logger to prevent errors
    sessionService.logger = {
      error: jest.fn(),
      info: jest.fn(),
      logSecurity: jest.fn()
    };

    // Mock Redis to null to use database fallback
    sessionService.redis = null;

    // Mock Prisma to prevent database calls
    sessionService.prisma = {
      userSession: {
        create: jest.fn().mockResolvedValue({
          id: 'mock-session-id',
          userId: 'user-123',
          token: 'mock-token',
          expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000)
        })
      }
    };
  });
  describe('Session ID Generation', () => {
    test('should generate secure session IDs', () => {
      const sessionId1 = sessionService.generateSessionId();
      const sessionId2 = sessionService.generateSessionId();
      expect(sessionId1).toMatch(/^[a-f0-9]{64}$/);
      expect(sessionId2).toMatch(/^[a-f0-9]{64}$/);
      expect(sessionId1).not.toBe(sessionId2);
      expect(sessionId1).toHaveLength(64);
      console.log('✅ Session ID generation test passed');
    });
  });
  describe('Device Fingerprinting', () => {
    test('should generate consistent device fingerprints', () => {
      const mockReq1 = {
        ip: '127.0.0.1',
        get: jest.fn(header => {
          const headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)',
            'Accept-Language': 'en-US,en;q=0.9',
            'Accept-Encoding': 'gzip, deflate, br'
          };
          return headers[header] || '';
        })
      };
      const mockReq2 = {
        ip: '127.0.0.1',
        get: jest.fn(header => {
          const headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)',
            'Accept-Language': 'en-US,en;q=0.9',
            'Accept-Encoding': 'gzip, deflate, br'
          };
          return headers[header] || '';
        })
      };
      const fingerprint1 = sessionService.generateDeviceFingerprint(mockReq1);
      const fingerprint2 = sessionService.generateDeviceFingerprint(mockReq2);
      expect(fingerprint1).toMatch(/^[a-f0-9]{32}$/);
      expect(fingerprint2).toMatch(/^[a-f0-9]{32}$/);
      expect(fingerprint1).toBe(fingerprint2);
      console.log('✅ Device fingerprinting test passed');
    });
  });
  describe('Remember Me Token Management', () => {
    test('should create remember me token successfully', async () => {
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn(header => {
          const headers = {
            'User-Agent': 'Mozilla/5.0 (Test Browser)',
            'Accept-Language': 'en-US,en;q=0.9',
            'Accept-Encoding': 'gzip, deflate, br'
          };
          return headers[header] || '';
        })
      };

      // Mock Redis for this test
      sessionService.redis = {
        setEx: jest.fn().mockResolvedValue('OK'),
        zAdd: jest.fn().mockResolvedValue(1),
        expire: jest.fn().mockResolvedValue('OK')
      };
      const result = await sessionService.createRememberMeToken('user-123', mockReq);
      expect(result.success).toBe(true);
      expect(result.token).toBeDefined();
      expect(result.expiresAt).toBeInstanceOf(Date);
      console.log('✅ Remember me token creation test passed');
    });
    test('should validate remember me token successfully', async () => {
      // Mock Redis for this test
      const mockTokenData = {
        userId: 'user-123',
        deviceFingerprint: 'mock-fingerprint',
        createdAt: new Date(),
        expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)
      };
      sessionService.redis = {
        get: jest.fn().mockResolvedValue(JSON.stringify(mockTokenData))
      };
      const result = await sessionService.validateRememberMeToken('mock-token');
      expect(result.valid).toBe(true);
      expect(result.userId).toBe('user-123');
      console.log('✅ Remember me token validation test passed');
    });
  });
  describe('Session Configuration', () => {
    test('should configure session with correct max age for remember me', () => {
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn(header => {
          const headers = {
            'User-Agent': 'Mozilla/5.0 (Test Browser)',
            'Accept-Language': 'en-US,en;q=0.9',
            'Accept-Encoding': 'gzip, deflate, br'
          };
          return headers[header] || '';
        })
      };

      // Test session configuration logic
      const now = new Date();
      const rememberMeMaxAge = 7 * 24 * 60 * 60 * 1000; // 7 days
      const standardMaxAge = 24 * 60 * 60 * 1000; // 24 hours

      const rememberMeExpiry = new Date(now.getTime() + rememberMeMaxAge);
      const standardExpiry = new Date(now.getTime() + standardMaxAge);
      expect(rememberMeExpiry.getTime()).toBeGreaterThan(standardExpiry.getTime());
      expect(rememberMeMaxAge).toBe(604800000); // 7 days in ms
      expect(standardMaxAge).toBe(86400000); // 24 hours in ms

      console.log('✅ Session configuration test passed');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTZXNzaW9uU2VydmljZSIsInJlcXVpcmUiLCJkZXNjcmliZSIsInNlc3Npb25TZXJ2aWNlIiwiYmVmb3JlQWxsIiwibG9nZ2VyIiwiZXJyb3IiLCJqZXN0IiwiZm4iLCJpbmZvIiwibG9nU2VjdXJpdHkiLCJyZWRpcyIsInByaXNtYSIsInVzZXJTZXNzaW9uIiwiY3JlYXRlIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJpZCIsInVzZXJJZCIsInRva2VuIiwiZXhwaXJlc0F0IiwiRGF0ZSIsIm5vdyIsInRlc3QiLCJzZXNzaW9uSWQxIiwiZ2VuZXJhdGVTZXNzaW9uSWQiLCJzZXNzaW9uSWQyIiwiZXhwZWN0IiwidG9NYXRjaCIsIm5vdCIsInRvQmUiLCJ0b0hhdmVMZW5ndGgiLCJjb25zb2xlIiwibG9nIiwibW9ja1JlcTEiLCJpcCIsImdldCIsImhlYWRlciIsImhlYWRlcnMiLCJtb2NrUmVxMiIsImZpbmdlcnByaW50MSIsImdlbmVyYXRlRGV2aWNlRmluZ2VycHJpbnQiLCJmaW5nZXJwcmludDIiLCJtb2NrUmVxIiwic2V0RXgiLCJ6QWRkIiwiZXhwaXJlIiwicmVzdWx0IiwiY3JlYXRlUmVtZW1iZXJNZVRva2VuIiwic3VjY2VzcyIsInRvQmVEZWZpbmVkIiwidG9CZUluc3RhbmNlT2YiLCJtb2NrVG9rZW5EYXRhIiwiZGV2aWNlRmluZ2VycHJpbnQiLCJjcmVhdGVkQXQiLCJKU09OIiwic3RyaW5naWZ5IiwidmFsaWRhdGVSZW1lbWJlck1lVG9rZW4iLCJ2YWxpZCIsInJlbWVtYmVyTWVNYXhBZ2UiLCJzdGFuZGFyZE1heEFnZSIsInJlbWVtYmVyTWVFeHBpcnkiLCJnZXRUaW1lIiwic3RhbmRhcmRFeHBpcnkiLCJ0b0JlR3JlYXRlclRoYW4iXSwic291cmNlcyI6WyJyZW1lbWJlci1tZS1zaW1wbGUudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaW1wbGUgcmVtZW1iZXIgbWUgZnVuY3Rpb25hbGl0eSB0ZXN0IHdpdGhvdXQgZGF0YWJhc2UgZGVwZW5kZW5jaWVzXHJcbmNvbnN0IHsgU2Vzc2lvblNlcnZpY2UgfSA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL3Nlc3Npb25TZXJ2aWNlJyk7XHJcblxyXG5kZXNjcmliZSgnUmVtZW1iZXIgTWUgU2ltcGxlIEZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XHJcbiAgbGV0IHNlc3Npb25TZXJ2aWNlO1xyXG5cclxuICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgLy8gQ3JlYXRlIHNlc3Npb24gc2VydmljZSBpbnN0YW5jZSB3aXRoIG1vY2tlZCBkZXBlbmRlbmNpZXNcclxuICAgIHNlc3Npb25TZXJ2aWNlID0gbmV3IFNlc3Npb25TZXJ2aWNlKCk7XHJcbiAgICBcclxuICAgIC8vIE1vY2sgdGhlIGxvZ2dlciB0byBwcmV2ZW50IGVycm9yc1xyXG4gICAgc2Vzc2lvblNlcnZpY2UubG9nZ2VyID0ge1xyXG4gICAgICBlcnJvcjogamVzdC5mbigpLFxyXG4gICAgICBpbmZvOiBqZXN0LmZuKCksXHJcbiAgICAgIGxvZ1NlY3VyaXR5OiBqZXN0LmZuKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIE1vY2sgUmVkaXMgdG8gbnVsbCB0byB1c2UgZGF0YWJhc2UgZmFsbGJhY2tcclxuICAgIHNlc3Npb25TZXJ2aWNlLnJlZGlzID0gbnVsbDtcclxuICAgIFxyXG4gICAgLy8gTW9jayBQcmlzbWEgdG8gcHJldmVudCBkYXRhYmFzZSBjYWxsc1xyXG4gICAgc2Vzc2lvblNlcnZpY2UucHJpc21hID0ge1xyXG4gICAgICB1c2VyU2Vzc2lvbjoge1xyXG4gICAgICAgIGNyZWF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICAgIGlkOiAnbW9jay1zZXNzaW9uLWlkJyxcclxuICAgICAgICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcclxuICAgICAgICAgIHRva2VuOiAnbW9jay10b2tlbicsXHJcbiAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgKyAyNCAqIDYwICogNjAgKiAxMDAwKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdTZXNzaW9uIElEIEdlbmVyYXRpb24nLCAoKSA9PiB7XHJcbiAgICB0ZXN0KCdzaG91bGQgZ2VuZXJhdGUgc2VjdXJlIHNlc3Npb24gSURzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzZXNzaW9uSWQxID0gc2Vzc2lvblNlcnZpY2UuZ2VuZXJhdGVTZXNzaW9uSWQoKTtcclxuICAgICAgY29uc3Qgc2Vzc2lvbklkMiA9IHNlc3Npb25TZXJ2aWNlLmdlbmVyYXRlU2Vzc2lvbklkKCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3Qoc2Vzc2lvbklkMSkudG9NYXRjaCgvXlthLWYwLTldezY0fSQvKTtcclxuICAgICAgZXhwZWN0KHNlc3Npb25JZDIpLnRvTWF0Y2goL15bYS1mMC05XXs2NH0kLyk7XHJcbiAgICAgIGV4cGVjdChzZXNzaW9uSWQxKS5ub3QudG9CZShzZXNzaW9uSWQyKTtcclxuICAgICAgZXhwZWN0KHNlc3Npb25JZDEpLnRvSGF2ZUxlbmd0aCg2NCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU2Vzc2lvbiBJRCBnZW5lcmF0aW9uIHRlc3QgcGFzc2VkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0RldmljZSBGaW5nZXJwcmludGluZycsICgpID0+IHtcclxuICAgIHRlc3QoJ3Nob3VsZCBnZW5lcmF0ZSBjb25zaXN0ZW50IGRldmljZSBmaW5nZXJwcmludHMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tSZXExID0ge1xyXG4gICAgICAgIGlwOiAnMTI3LjAuMC4xJyxcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKGhlYWRlcikgPT4ge1xyXG4gICAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcclxuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCknLFxyXG4gICAgICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogJ2VuLVVTLGVuO3E9MC45JyxcclxuICAgICAgICAgICAgJ0FjY2VwdC1FbmNvZGluZyc6ICdnemlwLCBkZWZsYXRlLCBicidcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICByZXR1cm4gaGVhZGVyc1toZWFkZXJdIHx8ICcnO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBtb2NrUmVxMiA9IHtcclxuICAgICAgICBpcDogJzEyNy4wLjAuMScsXHJcbiAgICAgICAgZ2V0OiBqZXN0LmZuKChoZWFkZXIpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XHJcbiAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpJyxcclxuICAgICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsXHJcbiAgICAgICAgICAgICdBY2NlcHQtRW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZSwgYnInXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgcmV0dXJuIGhlYWRlcnNbaGVhZGVyXSB8fCAnJztcclxuICAgICAgICB9KVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgZmluZ2VycHJpbnQxID0gc2Vzc2lvblNlcnZpY2UuZ2VuZXJhdGVEZXZpY2VGaW5nZXJwcmludChtb2NrUmVxMSk7XHJcbiAgICAgIGNvbnN0IGZpbmdlcnByaW50MiA9IHNlc3Npb25TZXJ2aWNlLmdlbmVyYXRlRGV2aWNlRmluZ2VycHJpbnQobW9ja1JlcTIpO1xyXG5cclxuICAgICAgZXhwZWN0KGZpbmdlcnByaW50MSkudG9NYXRjaCgvXlthLWYwLTldezMyfSQvKTtcclxuICAgICAgZXhwZWN0KGZpbmdlcnByaW50MikudG9NYXRjaCgvXlthLWYwLTldezMyfSQvKTtcclxuICAgICAgZXhwZWN0KGZpbmdlcnByaW50MSkudG9CZShmaW5nZXJwcmludDIpO1xyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIERldmljZSBmaW5nZXJwcmludGluZyB0ZXN0IHBhc3NlZCcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdSZW1lbWJlciBNZSBUb2tlbiBNYW5hZ2VtZW50JywgKCkgPT4ge1xyXG4gICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSByZW1lbWJlciBtZSB0b2tlbiBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tSZXEgPSB7XHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIGdldDogamVzdC5mbigoaGVhZGVyKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBoZWFkZXJzID0ge1xyXG4gICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoVGVzdCBCcm93c2VyKScsXHJcbiAgICAgICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjknLFxyXG4gICAgICAgICAgICAnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUsIGJyJ1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHJldHVybiBoZWFkZXJzW2hlYWRlcl0gfHwgJyc7XHJcbiAgICAgICAgfSlcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgUmVkaXMgZm9yIHRoaXMgdGVzdFxyXG4gICAgICBzZXNzaW9uU2VydmljZS5yZWRpcyA9IHtcclxuICAgICAgICBzZXRFeDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdPSycpLFxyXG4gICAgICAgIHpBZGQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKSxcclxuICAgICAgICBleHBpcmU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgnT0snKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2Vzc2lvblNlcnZpY2UuY3JlYXRlUmVtZW1iZXJNZVRva2VuKCd1c2VyLTEyMycsIG1vY2tSZXEpO1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnRva2VuKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LmV4cGlyZXNBdCkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUmVtZW1iZXIgbWUgdG9rZW4gY3JlYXRpb24gdGVzdCBwYXNzZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSByZW1lbWJlciBtZSB0b2tlbiBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIE1vY2sgUmVkaXMgZm9yIHRoaXMgdGVzdFxyXG4gICAgICBjb25zdCBtb2NrVG9rZW5EYXRhID0ge1xyXG4gICAgICAgIHVzZXJJZDogJ3VzZXItMTIzJyxcclxuICAgICAgICBkZXZpY2VGaW5nZXJwcmludDogJ21vY2stZmluZ2VycHJpbnQnLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgKyAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDApXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzZXNzaW9uU2VydmljZS5yZWRpcyA9IHtcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShKU09OLnN0cmluZ2lmeShtb2NrVG9rZW5EYXRhKSlcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlc3Npb25TZXJ2aWNlLnZhbGlkYXRlUmVtZW1iZXJNZVRva2VuKCdtb2NrLXRva2VuJyk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QocmVzdWx0LnZhbGlkKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnVzZXJJZCkudG9CZSgndXNlci0xMjMnKTtcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBSZW1lbWJlciBtZSB0b2tlbiB2YWxpZGF0aW9uIHRlc3QgcGFzc2VkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1Nlc3Npb24gQ29uZmlndXJhdGlvbicsICgpID0+IHtcclxuICAgIHRlc3QoJ3Nob3VsZCBjb25maWd1cmUgc2Vzc2lvbiB3aXRoIGNvcnJlY3QgbWF4IGFnZSBmb3IgcmVtZW1iZXIgbWUnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tSZXEgPSB7XHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIGdldDogamVzdC5mbigoaGVhZGVyKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBoZWFkZXJzID0ge1xyXG4gICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoVGVzdCBCcm93c2VyKScsXHJcbiAgICAgICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjknLFxyXG4gICAgICAgICAgICAnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUsIGJyJ1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHJldHVybiBoZWFkZXJzW2hlYWRlcl0gfHwgJyc7XHJcbiAgICAgICAgfSlcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFRlc3Qgc2Vzc2lvbiBjb25maWd1cmF0aW9uIGxvZ2ljXHJcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICAgIGNvbnN0IHJlbWVtYmVyTWVNYXhBZ2UgPSA3ICogMjQgKiA2MCAqIDYwICogMTAwMDsgLy8gNyBkYXlzXHJcbiAgICAgIGNvbnN0IHN0YW5kYXJkTWF4QWdlID0gMjQgKiA2MCAqIDYwICogMTAwMDsgLy8gMjQgaG91cnNcclxuXHJcbiAgICAgIGNvbnN0IHJlbWVtYmVyTWVFeHBpcnkgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpICsgcmVtZW1iZXJNZU1heEFnZSk7XHJcbiAgICAgIGNvbnN0IHN0YW5kYXJkRXhwaXJ5ID0gbmV3IERhdGUobm93LmdldFRpbWUoKSArIHN0YW5kYXJkTWF4QWdlKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZW1lbWJlck1lRXhwaXJ5LmdldFRpbWUoKSkudG9CZUdyZWF0ZXJUaGFuKHN0YW5kYXJkRXhwaXJ5LmdldFRpbWUoKSk7XHJcbiAgICAgIGV4cGVjdChyZW1lbWJlck1lTWF4QWdlKS50b0JlKDYwNDgwMDAwMCk7IC8vIDcgZGF5cyBpbiBtc1xyXG4gICAgICBleHBlY3Qoc3RhbmRhcmRNYXhBZ2UpLnRvQmUoODY0MDAwMDApOyAvLyAyNCBob3VycyBpbiBtc1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBTZXNzaW9uIGNvbmZpZ3VyYXRpb24gdGVzdCBwYXNzZWQnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0EsTUFBTTtFQUFFQTtBQUFlLENBQUMsR0FBR0MsT0FBTyxDQUFDLDRCQUE0QixDQUFDO0FBRWhFQyxRQUFRLENBQUMsa0NBQWtDLEVBQUUsTUFBTTtFQUNqRCxJQUFJQyxjQUFjO0VBRWxCQyxTQUFTLENBQUMsTUFBTTtJQUNkO0lBQ0FELGNBQWMsR0FBRyxJQUFJSCxjQUFjLENBQUMsQ0FBQzs7SUFFckM7SUFDQUcsY0FBYyxDQUFDRSxNQUFNLEdBQUc7TUFDdEJDLEtBQUssRUFBRUMsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztNQUNoQkMsSUFBSSxFQUFFRixJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO01BQ2ZFLFdBQVcsRUFBRUgsSUFBSSxDQUFDQyxFQUFFLENBQUM7SUFDdkIsQ0FBQzs7SUFFRDtJQUNBTCxjQUFjLENBQUNRLEtBQUssR0FBRyxJQUFJOztJQUUzQjtJQUNBUixjQUFjLENBQUNTLE1BQU0sR0FBRztNQUN0QkMsV0FBVyxFQUFF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