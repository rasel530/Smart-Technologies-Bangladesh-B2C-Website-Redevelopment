{"version":3,"names":["cov_1obf5pk3pg","actualCoverage","crypto","s","require","PrismaClient","configService","loggerService","SessionService","constructor","f","prisma","redis","config","logger","initializeRedis","Redis","redisUrl","get","b","warn","createClient","url","retry_delay_on_failover","max_retries_per_request","connectTimeout","lazyConnect","on","err","error","message","info","connect","generateSessionId","randomBytes","toString","generateDeviceFingerprint","req","userAgent","acceptLanguage","acceptEncoding","fingerprint","createHash","update","digest","substring","createSession","userId","options","sessionId","deviceFingerprint","now","Date","defaultMaxAge","rememberMe","sessionConfig","ip","createdAt","lastActivity","expiresAt","getTime","maxAge","isActive","loginType","securityLevel","persistent","deviceTrusted","sessionKey","ttl","Math","floor","setEx","JSON","stringify","userSessionsKey","zAdd","score","value","expire","userSession","create","data","token","logSecurity","Error","validateSession","valid","reason","sessionData","sessionString","parse","session","findUnique","where","include","user","path","originalUrl","destroySession","securityChecks","performSecurityChecks","passed","ipChanged","isIPChangeAllowed","currentFingerprint","oldIP","newIP","oldParts","split","newParts","length","refreshSession","validation","success","newExpiry","toISOString","zRem","del","delete","id","destroyAllUserSessions","exceptSessionId","destroyedSessions","sessionIds","zRange","push","sessions","findMany","not","destroyedCount","getUserSessions","dbSessions","gt","orderBy","map","cleanupExpiredSessions","cleanedCount","pattern","keys","key","validSessions","exists","result","deleteMany","lt","count","timestamp","getSessionStats","stats","totalSessions","activeSessions","expiredSessions","redisAvailable","total","active","Promise","all","validateRememberMeToken","tokenKey","tokenString","tokenData","rememberMeToken","createRememberMeToken","userTokensKey","refreshFromRememberMeToken","expectedFingerprint","actualFingerprint","sessionResult","newSessionId","cleanupExpiredRememberMeTokens","sessionService","module","exports"],"sources":["sessionService.js"],"sourcesContent":["const crypto = require('crypto');\r\nconst { PrismaClient } = require('@prisma/client');\r\nconst { configService } = require('./config');\r\nconst { loggerService } = require('./logger');\r\n\r\nclass SessionService {\r\n  constructor() {\r\n    this.prisma = new PrismaClient();\r\n    this.redis = null;\r\n    this.config = configService;\r\n    this.logger = loggerService;\r\n    this.initializeRedis();\r\n  }\r\n\r\n  async initializeRedis() {\r\n    try {\r\n      const Redis = require('redis');\r\n      const redisUrl = this.config.get('REDIS_URL');\r\n      \r\n      if (!redisUrl) {\r\n        this.logger.warn('REDIS_URL not configured, session management will use database only');\r\n        return;\r\n      }\r\n\r\n      this.redis = Redis.createClient({\r\n        url: redisUrl,\r\n        retry_delay_on_failover: 100,\r\n        max_retries_per_request: 3,\r\n        connectTimeout: 5000,\r\n        lazyConnect: true\r\n      });\r\n\r\n      this.redis.on('error', (err) => {\r\n        this.logger.error('Redis connection error in session service', err.message);\r\n        this.redis = null;\r\n      });\r\n\r\n      this.redis.on('connect', () => {\r\n        this.logger.info('Redis connected for session service');\r\n      });\r\n\r\n      await this.redis.connect();\r\n    } catch (error) {\r\n      this.logger.error('Failed to initialize Redis for session service', error.message);\r\n      this.redis = null;\r\n    }\r\n  }\r\n\r\n  // Generate secure session ID\r\n  generateSessionId() {\r\n    return crypto.randomBytes(32).toString('hex');\r\n  }\r\n\r\n  // Generate device fingerprint\r\n  generateDeviceFingerprint(req) {\r\n    const userAgent = req.get('User-Agent') || '';\r\n    const acceptLanguage = req.get('Accept-Language') || '';\r\n    const acceptEncoding = req.get('Accept-Encoding') || '';\r\n    \r\n    const fingerprint = crypto\r\n      .createHash('sha256')\r\n      .update(`${userAgent}|${acceptLanguage}|${acceptEncoding}`)\r\n      .digest('hex');\r\n    \r\n    return fingerprint.substring(0, 32); // Truncate for storage efficiency\r\n  }\r\n\r\n  // Create new session\r\n  async createSession(userId, req, options = {}) {\r\n    try {\r\n      const sessionId = this.generateSessionId();\r\n      const deviceFingerprint = this.generateDeviceFingerprint(req);\r\n      const now = new Date();\r\n      \r\n      // Enhanced session configuration for remember me functionality\r\n      const defaultMaxAge = options.rememberMe ?\r\n        7 * 24 * 60 * 60 * 1000 : // 7 days for remember me\r\n        24 * 60 * 60 * 1000;  // 24 hours default\r\n      \r\n      const sessionConfig = {\r\n        userId,\r\n        sessionId,\r\n        deviceFingerprint,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        createdAt: now,\r\n        lastActivity: now,\r\n        expiresAt: new Date(now.getTime() + (options.maxAge || defaultMaxAge)),\r\n        isActive: true,\r\n        loginType: options.loginType || 'password',\r\n        rememberMe: options.rememberMe || false,\r\n        securityLevel: options.securityLevel || 'standard',\r\n        // Enhanced remember me features\r\n        persistent: options.rememberMe || false,\r\n        deviceTrusted: options.rememberMe || false,\r\n        maxAge: options.maxAge || defaultMaxAge\r\n      };\r\n\r\n      // Store in Redis if available\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const ttl = Math.floor((sessionConfig.expiresAt.getTime() - now.getTime()) / 1000);\r\n        \r\n        await this.redis.setEx(sessionKey, ttl, JSON.stringify(sessionConfig));\r\n        \r\n        // Also store user session index for easy lookup\r\n        const userSessionsKey = `user_sessions:${userId}`;\r\n        await this.redis.zAdd(userSessionsKey, [{ \r\n          score: now.getTime(), \r\n          value: sessionId \r\n        }]);\r\n        await this.redis.expire(userSessionsKey, 7 * 24 * 60 * 60); // 7 days\r\n        \r\n        this.logger.info('Session created in Redis', { sessionId, userId });\r\n      } else {\r\n        // Fallback to database\r\n        await this.prisma.userSession.create({\r\n          data: {\r\n            userId,\r\n            token: sessionId,\r\n            expiresAt: sessionConfig.expiresAt\r\n          }\r\n        });\r\n        \r\n        this.logger.info('Session created in database', { sessionId, userId });\r\n      }\r\n\r\n      // Log session creation with enhanced remember me details\r\n      this.logger.logSecurity('Session Created', userId, {\r\n        sessionId,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        loginType: options.loginType,\r\n        rememberMe: options.rememberMe,\r\n        persistent: sessionConfig.persistent,\r\n        maxAge: sessionConfig.maxAge,\r\n        expiresAt: sessionConfig.expiresAt\r\n      });\r\n\r\n      return {\r\n        sessionId,\r\n        expiresAt: sessionConfig.expiresAt,\r\n        maxAge: sessionConfig.maxAge,\r\n        rememberMe: sessionConfig.rememberMe,\r\n        persistent: sessionConfig.persistent\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to create session', error.message);\r\n      throw new Error('Session creation failed');\r\n    }\r\n  }\r\n\r\n  // Validate session\r\n  async validateSession(sessionId, req) {\r\n    try {\r\n      if (!sessionId) {\r\n        return { valid: false, reason: 'No session ID provided' };\r\n      }\r\n\r\n      let sessionData = null;\r\n\r\n      // Try Redis first\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const sessionString = await this.redis.get(sessionKey);\r\n        \r\n        if (sessionString) {\r\n          sessionData = JSON.parse(sessionString);\r\n        }\r\n      } else {\r\n        // Fallback to database\r\n        const session = await this.prisma.userSession.findUnique({\r\n          where: { token: sessionId },\r\n          include: { user: true }\r\n        });\r\n\r\n        if (session && session.expiresAt > new Date()) {\r\n          sessionData = {\r\n            userId: session.userId,\r\n            sessionId,\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            createdAt: session.createdAt,\r\n            lastActivity: session.createdAt,\r\n            expiresAt: session.expiresAt,\r\n            isActive: true\r\n          };\r\n        }\r\n      }\r\n\r\n      if (!sessionData) {\r\n        this.logger.logSecurity('Invalid Session Attempt', null, {\r\n          sessionId,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          path: req.originalUrl\r\n        });\r\n        return { valid: false, reason: 'Session not found or expired' };\r\n      }\r\n\r\n      // Check expiration\r\n      const now = new Date();\r\n      if (sessionData.expiresAt && now > sessionData.expiresAt) {\r\n        await this.destroySession(sessionId);\r\n        return { valid: false, reason: 'Session expired' };\r\n      }\r\n\r\n      // Security checks\r\n      const securityChecks = this.performSecurityChecks(sessionData, req);\r\n      if (!securityChecks.passed) {\r\n        await this.destroySession(sessionId);\r\n        this.logger.logSecurity('Session Security Check Failed', sessionData.userId, {\r\n          sessionId,\r\n          reason: securityChecks.reason,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent')\r\n        });\r\n        return { valid: false, reason: securityChecks.reason };\r\n      }\r\n\r\n      // Update last activity\r\n      sessionData.lastActivity = now;\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const ttl = Math.floor((sessionData.expiresAt.getTime() - now.getTime()) / 1000);\r\n        await this.redis.setEx(sessionKey, ttl, JSON.stringify(sessionData));\r\n      }\r\n\r\n      return {\r\n        valid: true,\r\n        session: sessionData,\r\n        userId: sessionData.userId\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session validation error', error.message);\r\n      return { valid: false, reason: 'Session validation failed' };\r\n    }\r\n  }\r\n\r\n  // Perform security checks on session\r\n  performSecurityChecks(sessionData, req) {\r\n    // IP address validation (optional, can be disabled for mobile networks)\r\n    if (sessionData.ip && sessionData.ip !== req.ip) {\r\n      // Allow some flexibility for mobile networks\r\n      const ipChanged = !this.isIPChangeAllowed(sessionData.ip, req.ip);\r\n      if (ipChanged) {\r\n        return { passed: false, reason: 'IP address mismatch' };\r\n      }\r\n    }\r\n\r\n    // User Agent validation\r\n    if (sessionData.userAgent && sessionData.userAgent !== req.get('User-Agent')) {\r\n      return { passed: false, reason: 'User agent mismatch' };\r\n    }\r\n\r\n    // Device fingerprint validation\r\n    const currentFingerprint = this.generateDeviceFingerprint(req);\r\n    if (sessionData.deviceFingerprint && sessionData.deviceFingerprint !== currentFingerprint) {\r\n      return { passed: false, reason: 'Device fingerprint mismatch' };\r\n    }\r\n\r\n    return { passed: true };\r\n  }\r\n\r\n  // Check if IP change is allowed (for mobile networks)\r\n  isIPChangeAllowed(oldIP, newIP) {\r\n    // Allow changes within same subnet or geographic region\r\n    // This is a simplified implementation\r\n    const oldParts = oldIP.split('.');\r\n    const newParts = newIP.split('.');\r\n    \r\n    // Allow changes if first two octets are the same (same subnet)\r\n    return oldParts.length === 4 && newParts.length === 4 && \r\n           oldParts[0] === newParts[0] && oldParts[1] === newParts[1];\r\n  }\r\n\r\n  // Refresh/extend session\r\n  async refreshSession(sessionId, req, options = {}) {\r\n    try {\r\n      const validation = await this.validateSession(sessionId, req);\r\n      if (!validation.valid) {\r\n        return { success: false, reason: validation.reason };\r\n      }\r\n\r\n      const session = validation.session;\r\n      const now = new Date();\r\n      const newExpiry = new Date(now.getTime() + (options.maxAge || 24 * 60 * 60 * 1000));\r\n\r\n      session.lastActivity = now;\r\n      session.expiresAt = newExpiry;\r\n\r\n      // Update in Redis\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const ttl = Math.floor((newExpiry.getTime() - now.getTime()) / 1000);\r\n        await this.redis.setEx(sessionKey, ttl, JSON.stringify(session));\r\n      } else {\r\n        // Update in database\r\n        await this.prisma.userSession.update({\r\n          where: { token: sessionId },\r\n          data: { expiresAt: newExpiry }\r\n        });\r\n      }\r\n\r\n      this.logger.logSecurity('Session Refreshed', session.userId, {\r\n        sessionId,\r\n        ip: req.ip,\r\n        newExpiry: newExpiry.toISOString()\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        sessionId,\r\n        expiresAt: newExpiry,\r\n        maxAge: options.maxAge || 24 * 60 * 60 * 1000\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session refresh error', error.message);\r\n      return { success: false, reason: 'Session refresh failed' };\r\n    }\r\n  }\r\n\r\n  // Destroy session\r\n  async destroySession(sessionId, reason = 'logout') {\r\n    try {\r\n      // Remove from Redis\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const sessionString = await this.redis.get(sessionKey);\r\n        \r\n        if (sessionString) {\r\n          const sessionData = JSON.parse(sessionString);\r\n          const userSessionsKey = `user_sessions:${sessionData.userId}`;\r\n          \r\n          // Remove from user sessions index\r\n          await this.redis.zRem(userSessionsKey, sessionId);\r\n          await this.redis.del(sessionKey);\r\n          \r\n          this.logger.logSecurity('Session Destroyed', sessionData.userId, {\r\n            sessionId,\r\n            reason,\r\n            ip: sessionData.ip\r\n          });\r\n        }\r\n      } else {\r\n        // Remove from database\r\n        const session = await this.prisma.userSession.findUnique({\r\n          where: { token: sessionId }\r\n        });\r\n\r\n        if (session) {\r\n          await this.prisma.userSession.delete({\r\n            where: { id: session.id }\r\n          });\r\n          \r\n          this.logger.logSecurity('Session Destroyed', session.userId, {\r\n            sessionId,\r\n            reason\r\n          });\r\n        }\r\n      }\r\n\r\n      return { success: true };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session destruction error', error.message);\r\n      return { success: false, reason: 'Session destruction failed' };\r\n    }\r\n  }\r\n\r\n  // Destroy all user sessions (except current)\r\n  async destroyAllUserSessions(userId, exceptSessionId = null) {\r\n    try {\r\n      let destroyedSessions = [];\r\n\r\n      if (this.redis) {\r\n        const userSessionsKey = `user_sessions:${userId}`;\r\n        const sessionIds = await this.redis.zRange(userSessionsKey, 0, -1);\r\n        \r\n        for (const sessionId of sessionIds) {\r\n          if (sessionId !== exceptSessionId) {\r\n            await this.destroySession(sessionId, 'mass_logout');\r\n            destroyedSessions.push(sessionId);\r\n          }\r\n        }\r\n      } else {\r\n        // Database fallback\r\n        const sessions = await this.prisma.userSession.findMany({\r\n          where: { \r\n            userId,\r\n            ...(exceptSessionId && { token: { not: exceptSessionId } })\r\n          }\r\n        });\r\n\r\n        for (const session of sessions) {\r\n          await this.destroySession(session.token, 'mass_logout');\r\n          destroyedSessions.push(session.token);\r\n        }\r\n      }\r\n\r\n      this.logger.logSecurity('All User Sessions Destroyed', userId, {\r\n        destroyedCount: destroyedSessions.length,\r\n        exceptSessionId\r\n      });\r\n\r\n      return { success: true, destroyedCount: destroyedSessions.length };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Mass session destruction error', error.message);\r\n      return { success: false, reason: 'Mass session destruction failed' };\r\n    }\r\n  }\r\n\r\n  // Get active sessions for user\r\n  async getUserSessions(userId) {\r\n    try {\r\n      let sessions = [];\r\n\r\n      if (this.redis) {\r\n        const userSessionsKey = `user_sessions:${userId}`;\r\n        const sessionIds = await this.redis.zRange(userSessionsKey, 0, -1);\r\n        \r\n        for (const sessionId of sessionIds) {\r\n          const sessionKey = `session:${sessionId}`;\r\n          const sessionString = await this.redis.get(sessionKey);\r\n          \r\n          if (sessionString) {\r\n            const sessionData = JSON.parse(sessionString);\r\n            if (sessionData.expiresAt > new Date()) {\r\n              sessions.push({\r\n                sessionId,\r\n                createdAt: sessionData.createdAt,\r\n                lastActivity: sessionData.lastActivity,\r\n                expiresAt: sessionData.expiresAt,\r\n                ip: sessionData.ip,\r\n                userAgent: sessionData.userAgent,\r\n                loginType: sessionData.loginType,\r\n                isActive: sessionData.isActive\r\n              });\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // Database fallback\r\n        const dbSessions = await this.prisma.userSession.findMany({\r\n          where: { \r\n            userId,\r\n            expiresAt: { gt: new Date() }\r\n          },\r\n          orderBy: { createdAt: 'desc' }\r\n        });\r\n\r\n        sessions = dbSessions.map(session => ({\r\n          sessionId: session.token,\r\n          createdAt: session.createdAt,\r\n          expiresAt: session.expiresAt,\r\n          isActive: true\r\n        }));\r\n      }\r\n\r\n      return { success: true, sessions };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Get user sessions error', error.message);\r\n      return { success: false, reason: 'Failed to retrieve user sessions' };\r\n    }\r\n  }\r\n\r\n  // Cleanup expired sessions\r\n  async cleanupExpiredSessions() {\r\n    try {\r\n      let cleanedCount = 0;\r\n\r\n      if (this.redis) {\r\n        // Redis handles expiration automatically, but we can clean up user session indexes\r\n        const pattern = 'user_sessions:*';\r\n        const keys = await this.redis.keys(pattern);\r\n        \r\n        for (const key of keys) {\r\n          const sessionIds = await this.redis.zRange(key, 0, -1);\r\n          const validSessions = [];\r\n          \r\n          for (const sessionId of sessionIds) {\r\n            const sessionKey = `session:${sessionId}`;\r\n            const exists = await this.redis.exists(sessionKey);\r\n            if (exists) {\r\n              validSessions.push(sessionId);\r\n            }\r\n          }\r\n          \r\n          // Update user sessions index with only valid sessions\r\n          await this.redis.del(key);\r\n          if (validSessions.length > 0) {\r\n            await this.redis.zAdd(key, validSessions.map(id => ({ score: Date.now(), value: id })));\r\n          }\r\n          \r\n          cleanedCount += sessionIds.length - validSessions.length;\r\n        }\r\n      } else {\r\n        // Database cleanup\r\n        const result = await this.prisma.userSession.deleteMany({\r\n          where: { expiresAt: { lt: new Date() } }\r\n        });\r\n        cleanedCount = result.count;\r\n      }\r\n\r\n      this.logger.info('Session cleanup completed', {\r\n        cleanedCount,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      return { success: true, cleanedCount };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session cleanup error', error.message);\r\n      return { success: false, reason: 'Session cleanup failed' };\r\n    }\r\n  }\r\n\r\n  // Get session statistics\r\n  async getSessionStats() {\r\n    try {\r\n      let stats = {\r\n        totalSessions: 0,\r\n        activeSessions: 0,\r\n        expiredSessions: 0,\r\n        redisAvailable: this.redis !== null\r\n      };\r\n\r\n      if (this.redis) {\r\n        const pattern = 'session:*';\r\n        const keys = await this.redis.keys(pattern);\r\n        stats.totalSessions = keys.length;\r\n        \r\n        const now = new Date();\r\n        for (const key of keys) {\r\n          const sessionString = await this.redis.get(key);\r\n          if (sessionString) {\r\n            const sessionData = JSON.parse(sessionString);\r\n            if (sessionData.expiresAt > now) {\r\n              stats.activeSessions++;\r\n            } else {\r\n              stats.expiredSessions++;\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // Database stats\r\n        const [total, active] = await Promise.all([\r\n          this.prisma.userSession.count(),\r\n          this.prisma.userSession.count({\r\n            where: { expiresAt: { gt: new Date() } }\r\n          })\r\n        ]);\r\n        \r\n        stats.totalSessions = total;\r\n        stats.activeSessions = active;\r\n        stats.expiredSessions = total - active;\r\n      }\r\n\r\n      return { success: true, stats };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session stats error', error.message);\r\n      return { success: false, reason: 'Failed to get session statistics' };\r\n    }\r\n  }\r\n\r\n  // Validate remember me token\r\n  async validateRememberMeToken(token) {\r\n    try {\r\n      if (!token) {\r\n        return { valid: false, reason: 'No remember me token provided' };\r\n      }\r\n\r\n      // Try Redis first\r\n      if (this.redis) {\r\n        const tokenKey = `remember_me:${token}`;\r\n        const tokenString = await this.redis.get(tokenKey);\r\n        \r\n        if (tokenString) {\r\n          const tokenData = JSON.parse(tokenString);\r\n          \r\n          // Check if token has expired\r\n          if (tokenData.expiresAt && new Date() > tokenData.expiresAt) {\r\n            await this.redis.del(tokenKey);\r\n            return { valid: false, reason: 'Remember me token expired' };\r\n          }\r\n          \r\n          return {\r\n            valid: true,\r\n            userId: tokenData.userId,\r\n            deviceFingerprint: tokenData.deviceFingerprint,\r\n            createdAt: tokenData.createdAt\r\n          };\r\n        }\r\n      } else {\r\n        // Database fallback for remember me tokens\r\n        const rememberMeToken = await this.prisma.rememberMeToken.findUnique({\r\n          where: { token },\r\n          include: { user: true }\r\n        });\r\n\r\n        if (!rememberMeToken || rememberMeToken.expiresAt < new Date()) {\r\n          return { valid: false, reason: 'Remember me token not found or expired' };\r\n        }\r\n\r\n        return {\r\n          valid: true,\r\n          userId: rememberMeToken.userId,\r\n          deviceFingerprint: rememberMeToken.deviceFingerprint,\r\n          createdAt: rememberMeToken.createdAt\r\n        };\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logger.error('Remember me token validation error', error.message);\r\n      return { valid: false, reason: 'Token validation failed' };\r\n    }\r\n  }\r\n\r\n  // Create remember me token\r\n  async createRememberMeToken(userId, req) {\r\n    try {\r\n      const token = this.generateSessionId(); // Use same secure generation\r\n      const deviceFingerprint = this.generateDeviceFingerprint(req);\r\n      const now = new Date();\r\n      const expiresAt = new Date(now.getTime() + (30 * 24 * 60 * 60 * 1000)); // 30 days\r\n\r\n      const tokenData = {\r\n        userId,\r\n        token,\r\n        deviceFingerprint,\r\n        createdAt: now,\r\n        expiresAt,\r\n        isActive: true\r\n      };\r\n\r\n      // Store in Redis if available\r\n      if (this.redis) {\r\n        const tokenKey = `remember_me:${token}`;\r\n        const ttl = Math.floor((expiresAt.getTime() - now.getTime()) / 1000);\r\n        await this.redis.setEx(tokenKey, ttl, JSON.stringify(tokenData));\r\n        \r\n        // Also store user remember me tokens index\r\n        const userTokensKey = `user_remember_me:${userId}`;\r\n        await this.redis.zAdd(userTokensKey, [{\r\n          score: now.getTime(),\r\n          value: token\r\n        }]);\r\n        await this.redis.expire(userTokensKey, 30 * 24 * 60 * 60); // 30 days\r\n      } else {\r\n        // Database fallback - would need to create rememberMeToken table\r\n        this.logger.warn('Remember me tokens require Redis for full functionality');\r\n      }\r\n\r\n      this.logger.logSecurity('Remember Me Token Created', userId, {\r\n        token,\r\n        deviceFingerprint,\r\n        expiresAt: expiresAt.toISOString(),\r\n        ip: req.ip\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        token,\r\n        expiresAt\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to create remember me token', error.message);\r\n      return { success: false, reason: 'Token creation failed' };\r\n    }\r\n  }\r\n\r\n  // Refresh session using remember me token\r\n  async refreshFromRememberMeToken(token, req) {\r\n    try {\r\n      const validation = await this.validateRememberMeToken(token);\r\n      \r\n      if (!validation.valid) {\r\n        return { success: false, reason: validation.reason };\r\n      }\r\n\r\n      // Verify device fingerprint matches\r\n      const currentFingerprint = this.generateDeviceFingerprint(req);\r\n      if (validation.deviceFingerprint !== currentFingerprint) {\r\n        this.logger.logSecurity('Remember Me Device Mismatch', validation.userId, {\r\n          token,\r\n          expectedFingerprint: validation.deviceFingerprint,\r\n          actualFingerprint: currentFingerprint,\r\n          ip: req.ip\r\n        });\r\n        return { success: false, reason: 'Device fingerprint mismatch' };\r\n      }\r\n\r\n      // Create new session\r\n      const sessionResult = await this.createSession(validation.userId, req, {\r\n        loginType: 'remember_me',\r\n        rememberMe: true,\r\n        maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days for remembered sessions\r\n        securityLevel: 'standard'\r\n      });\r\n\r\n      if (!sessionResult.sessionId) {\r\n        return { success: false, reason: 'Failed to create session from remember me token' };\r\n      }\r\n\r\n      // Clean up old remember me token for security\r\n      if (this.redis) {\r\n        const tokenKey = `remember_me:${token}`;\r\n        await this.redis.del(tokenKey);\r\n      }\r\n\r\n      this.logger.logSecurity('Session Refreshed from Remember Me', validation.userId, {\r\n        newSessionId: sessionResult.sessionId,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent')\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        sessionId: sessionResult.sessionId,\r\n        expiresAt: sessionResult.expiresAt,\r\n        maxAge: sessionResult.maxAge,\r\n        userId: validation.userId\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Remember me session refresh error', error.message);\r\n      return { success: false, reason: 'Session refresh failed' };\r\n    }\r\n  }\r\n\r\n  // Clean up expired remember me tokens\r\n  async cleanupExpiredRememberMeTokens() {\r\n    try {\r\n      let cleanedCount = 0;\r\n\r\n      if (this.redis) {\r\n        const pattern = 'remember_me:*';\r\n        const keys = await this.redis.keys(pattern);\r\n        \r\n        for (const key of keys) {\r\n          const tokenString = await this.redis.get(key);\r\n          if (tokenString) {\r\n            const tokenData = JSON.parse(tokenString);\r\n            if (tokenData.expiresAt && new Date() > tokenData.expiresAt) {\r\n              await this.redis.del(key);\r\n              cleanedCount++;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      this.logger.info('Remember me token cleanup completed', {\r\n        cleanedCount,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      return { success: true, cleanedCount };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Remember me token cleanup error', error.message);\r\n      return { success: false, reason: 'Cleanup failed' };\r\n    }\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst sessionService = new SessionService();\r\n\r\nmodule.exports = {\r\n  SessionService,\r\n  sessionService\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}