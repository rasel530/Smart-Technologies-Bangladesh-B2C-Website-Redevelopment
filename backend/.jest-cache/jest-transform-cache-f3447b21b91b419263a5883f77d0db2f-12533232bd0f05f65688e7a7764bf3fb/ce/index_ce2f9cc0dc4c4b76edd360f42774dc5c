d70e3eb668b8b71c263a4e07251c14c1
'use strict';

/**
 * Module dependencies.
 */
const methods = require('methods');
let http2;
try {
  http2 = require('http2'); // eslint-disable-line global-require
} catch (_) {
  // eslint-disable-line no-empty
}
const Test = require('./lib/test.js');
const agent = require('./lib/agent.js');

/**
 * Test against the given `app`,
 * returning a new `Test`.
 *
 * @param {Function|Server|String} app
 * @return {Test}
 * @api public
 */
module.exports = function (app, options = {}) {
  const obj = {};
  if (typeof app === 'function') {
    if (options.http2) {
      if (!http2) {
        throw new Error('supertest: this version of Node.js does not support http2');
      }
    }
  }
  methods.forEach(function (method) {
    obj[method] = function (url) {
      var test = new Test(app, method, url, options.http2);
      if (options.http2) {
        test.http2();
      }
      return test;
    };
  });

  // Support previous use of del
  obj.del = obj.delete;
  return obj;
};

/**
 * Expose `Test`
 */
module.exports.Test = Test;

/**
 * Expose the agent function
 */
module.exports.agent = agent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtZXRob2RzIiwicmVxdWlyZSIsImh0dHAyIiwiXyIsIlRlc3QiLCJhZ2VudCIsIm1vZHVsZSIsImV4cG9ydHMiLCJhcHAiLCJvcHRpb25zIiwib2JqIiwiRXJyb3IiLCJmb3JFYWNoIiwibWV0aG9kIiwidXJsIiwidGVzdCIsImRlbCIsImRlbGV0ZSJdLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICovXG5jb25zdCBtZXRob2RzID0gcmVxdWlyZSgnbWV0aG9kcycpO1xubGV0IGh0dHAyO1xudHJ5IHtcbiAgaHR0cDIgPSByZXF1aXJlKCdodHRwMicpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGdsb2JhbC1yZXF1aXJlXG59IGNhdGNoIChfKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZW1wdHlcbn1cbmNvbnN0IFRlc3QgPSByZXF1aXJlKCcuL2xpYi90ZXN0LmpzJyk7XG5jb25zdCBhZ2VudCA9IHJlcXVpcmUoJy4vbGliL2FnZW50LmpzJyk7XG5cbi8qKlxuICogVGVzdCBhZ2FpbnN0IHRoZSBnaXZlbiBgYXBwYCxcbiAqIHJldHVybmluZyBhIG5ldyBgVGVzdGAuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbnxTZXJ2ZXJ8U3RyaW5nfSBhcHBcbiAqIEByZXR1cm4ge1Rlc3R9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IG9iaiA9IHt9O1xuXG4gIGlmICh0eXBlb2YgYXBwID09PSAnZnVuY3Rpb24nKSB7XG4gICAgaWYgKG9wdGlvbnMuaHR0cDIpIHtcbiAgICAgIGlmICghaHR0cDIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICdzdXBlcnRlc3Q6IHRoaXMgdmVyc2lvbiBvZiBOb2RlLmpzIGRvZXMgbm90IHN1cHBvcnQgaHR0cDInXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbWV0aG9kcy5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgIG9ialttZXRob2RdID0gZnVuY3Rpb24odXJsKSB7XG4gICAgICB2YXIgdGVzdCA9IG5ldyBUZXN0KGFwcCwgbWV0aG9kLCB1cmwsIG9wdGlvbnMuaHR0cDIpO1xuICAgICAgaWYgKG9wdGlvbnMuaHR0cDIpIHtcbiAgICAgICAgdGVzdC5odHRwMigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRlc3Q7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gU3VwcG9ydCBwcmV2aW91cyB1c2Ugb2YgZGVsXG4gIG9iai5kZWwgPSBvYmouZGVsZXRlO1xuXG4gIHJldHVybiBvYmo7XG59O1xuXG4vKipcbiAqIEV4cG9zZSBgVGVzdGBcbiAqL1xubW9kdWxlLmV4cG9ydHMuVGVzdCA9IFRlc3Q7XG5cbi8qKlxuICogRXhwb3NlIHRoZSBhZ2VudCBmdW5jdGlvblxuICovXG5tb2R1bGUuZXhwb3J0cy5hZ2VudCA9IGFnZW50O1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaO0FBQ0E7QUFDQTtBQUNBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxJQUFJQyxLQUFLO0FBQ1QsSUFBSTtFQUNGQSxLQUFLLEdBQUdELE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0FBQzVCLENBQUMsQ0FBQyxPQUFPRSxDQUFDLEVBQUU7RUFDVjtBQUFBO0FBRUYsTUFBTUMsSUFBSSxHQUFHSCxPQUFPLENBQUMsZUFBZSxDQUFDO0FBQ3JDLE1BQU1JLEtBQUssR0FBR0osT0FBTyxDQUFDLGdCQUFnQixDQUFDOztBQUV2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0FLLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLFVBQVNDLEdBQUcsRUFBRUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxFQUFFO0VBQzNDLE1BQU1DLEdBQUcsR0FBRyxDQUFDLENBQUM7RUFFZCxJQUFJLE9BQU9GLEdBQUcsS0FBSyxVQUFVLEVBQUU7SUFDN0IsSUFBSUMsT0FBTyxDQUFDUCxLQUFLLEVBQUU7TUFDakIsSUFBSSxDQUFDQSxLQUFLLEVBQUU7UUFDVixNQUFNLElBQUlTLEtBQUssQ0FDYiwyREFDRixDQUFDO01BQ0g7SUFDRjtFQUNGO0VBRUFYLE9BQU8sQ0FBQ1ksT0FBTyxDQUFDLFVBQVNDLE1BQU0sRUFBRTtJQUMvQkgsR0FBRyxDQUFDRyxNQUFNLENBQUMsR0FBRyxVQUFTQyxHQUFHLEVBQUU7TUFDMUIsSUFBSUMsSUFBSSxHQUFHLElBQUlYLElBQUksQ0FBQ0ksR0FBRyxFQUFFSyxNQUFNLEVBQUVDLEdBQUcsRUFBRUwsT0FBTyxDQUFDUCxLQUFLLENBQUM7TUFDcEQsSUFBSU8sT0FBTyxDQUFDUCxLQUFLLEVBQUU7UUFDakJhLElBQUksQ0FBQ2IsS0FBSyxDQUFDLENBQUM7TUFDZDtNQUNBLE9BQU9hLElBQUk7SUFDYixDQUFDO0VBQ0gsQ0FBQyxDQUFDOztFQUVGO0VBQ0FMLEdBQUcsQ0FBQ00sR0FBRyxHQUFHTixHQUFHLENBQUNPLE1BQU07RUFFcEIsT0FBT1AsR0FBRztBQUNaLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0FKLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDSCxJQUFJLEdBQUdBLElBQUk7O0FBRTFCO0FBQ0E7QUFDQTtBQUNBRSxNQUFNLENBQUNDLE9BQU8sQ0FBQ0YsS0FBSyxHQUFHQSxLQUFLIiwiaWdub3JlTGlzdCI6W119