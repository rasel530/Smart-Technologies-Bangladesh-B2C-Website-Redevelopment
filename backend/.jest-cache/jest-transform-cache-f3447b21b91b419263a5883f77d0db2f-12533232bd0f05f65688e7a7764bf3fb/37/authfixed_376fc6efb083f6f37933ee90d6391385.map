{"version":3,"names":["cov_20ecsb1o7q","actualCoverage","jwt","s","require","crypto","configService","loggerService","AuthMiddleware","constructor","f","config","logger","redis","initializeRedis","catch","err","b","console","error","message","Redis","redisUrl","get","warn","createClient","url","retry_delay_on_failover","max_retries_per_request","connectTimeout","lazyConnect","on","info","Promise","race","connect","_","reject","setTimeout","Error","authenticate","req","res","next","authHeader","headers","authorization","status","json","token","replace","isBlacklisted","isTokenBlacklisted","logSecurity","ip","userAgent","path","originalUrl","jwtConfig","getJWTConfig","decoded","verify","secret","algorithms","algorithm","issuer","clockTolerance","userId","role","iat","exp","now","Math","floor","Date","ipReputation","checkIPReputation","isSuspicious","reputation","user","userRole","logAuth","errorType","name","errorMessage","statusCode","rotateToken","refreshToken","body","newAccessToken","sign","email","tokenType","rotatedAt","toISOString","expiresIn","newRefreshToken","blacklistToken","oldTokenExpiry","newAccessTokenExpiry","accessToken","validateAndRotateToken","expirationBuffer","timeUntilExpiry","currentExpiry","authorize","roles","hasRequiredRole","some","requiredRole","join","adminOnly","managerOrAdmin","customerOrAdmin","selfOrAdmin","isOwner","isAdmin","targetUserId","optional","rateLimit","options","windowMs","max","isProduction","standardHeaders","key","windowStart","pipeline","zRemRangeByScore","zAdd","score","value","random","zCard","expire","ceil","results","exec","currentCount","reply","count","limit","retryAfter","set","reason","decode","ttl","createHash","update","digest","setEx","JSON","stringify","blacklistedAt","originalExp","result","data","hGetAll","Object","keys","length","failedAttempts","parseInt","lastAttempt","recordFailedAttempt","hIncrBy","hSet","toString","requestId","id","generateRequestId","setHeader","substr","validateApiKey","apiKeys","apiKey","validKey","find","isApiKeyValid","substring","expiresAt","warningThreshold","keyId","keyObject","createdAt","revokedAt","validateSession","sessionId","sessionKey","sessionData","session","parse","del","originalIp","currentIp","lastActivity","cors","getCORSConfig","header","origin","methods","allowedHeaders","exposedHeaders","credentials","method","end","errorLogger","timestamp","authMiddleware","module","exports"],"sources":["auth-fixed.js"],"sourcesContent":["const jwt = require('jsonwebtoken');\r\nconst crypto = require('crypto');\r\nconst configService = require('../services/config');\r\nconst loggerService = require('../services/logger');\r\n\r\nclass AuthMiddleware {\r\n  constructor() {\r\n    this.config = configService;\r\n    this.logger = loggerService;\r\n    this.redis = null;\r\n    // Initialize Redis asynchronously to avoid blocking\r\n    this.initializeRedis().catch(err => {\r\n      if (err) {\r\n        console.error('Failed to initialize Redis:', err.message);\r\n      }\r\n    });\r\n  }\r\n\r\n  async initializeRedis() {\r\n    try {\r\n      const Redis = require('redis');\r\n      const redisUrl = this.config.get('REDIS_URL');\r\n      \r\n      // Check if Redis URL is available\r\n      if (!redisUrl) {\r\n        this.logger.warn('REDIS_URL not configured, running without Redis');\r\n          this.redis = null;\r\n          return;\r\n        }\r\n      \r\n      this.redis = Redis.createClient({\r\n        url: redisUrl,\r\n        retry_delay_on_failover: 100,\r\n        max_retries_per_request: 3,\r\n        connectTimeout: 5000,\r\n        lazyConnect: true\r\n      });\r\n      \r\n      this.redis.on('error', (err) => {\r\n        this.logger.error('Redis connection error', err.message);\r\n        this.redis = null; // Reset to null on error\r\n      });\r\n      \r\n      this.redis.on('connect', () => {\r\n        this.logger.info('Redis connected successfully');\r\n      });\r\n      \r\n      this.redis.on('end', () => {\r\n        this.logger.warn('Redis connection ended');\r\n        this.redis = null;\r\n      });\r\n      \r\n      // Try to connect with timeout\r\n      await Promise.race([\r\n        this.redis.connect(),\r\n        new Promise((_, reject) =>\r\n          setTimeout(() => reject(new Error('Redis connection timeout')), 5000)\r\n        )\r\n      ]);\r\n      \r\n    } catch (error) {\r\n      if (this.logger && typeof this.logger.error === 'function') {\r\n        this.logger.error('Failed to initialize Redis', error.message);\r\n      }\r\n      // Don't throw error, just set redis to null and continue\r\n      this.redis = null;\r\n      if (this.logger && typeof this.logger.warn === 'function') {\r\n        this.logger.warn('Running without Redis - some security features will be limited');\r\n      } else {\r\n        console.warn('Running without Redis - some security features will be limited');\r\n      }\r\n    }\r\n  }\r\n\r\n  // Enhanced JWT authentication middleware with proper security\r\n  authenticate() {\r\n    return async (req, res, next) => {\r\n      try {\r\n        const authHeader = req.headers.authorization;\r\n        \r\n        if (!authHeader) {\r\n          return res.status(401).json({\r\n            error: 'Access token required',\r\n            message: 'Authorization header is missing'\r\n          });\r\n        }\r\n\r\n        const token = authHeader.replace('Bearer ', '');\r\n        \r\n        if (!token) {\r\n          return res.status(401).json({\r\n            error: 'Invalid token format',\r\n            message: 'Authorization header must be in format \"Bearer <token>\"'\r\n          });\r\n        }\r\n\r\n        // Check if token is blacklisted\r\n        const isBlacklisted = await this.isTokenBlacklisted(token);\r\n        if (isBlacklisted) {\r\n          this.logger.logSecurity('Blacklisted Token Access Attempt', null, {\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            path: req.originalUrl\r\n          });\r\n          \r\n          return res.status(401).json({\r\n            error: 'Token revoked',\r\n            message: 'This token has been revoked and cannot be used'\r\n          });\r\n        }\r\n\r\n        // Enhanced JWT verification with proper algorithm validation\r\n        const jwtConfig = this.config.getJWTConfig();\r\n        const decoded = jwt.verify(token, jwtConfig.secret, {\r\n          algorithms: [jwtConfig.algorithm],\r\n          issuer: jwtConfig.issuer,\r\n          clockTolerance: 30 // 30 seconds clock skew tolerance\r\n        });\r\n        \r\n        if (!decoded) {\r\n          return res.status(401).json({\r\n            error: 'Invalid token',\r\n            message: 'Token is expired or invalid'\r\n          });\r\n        }\r\n\r\n        // Validate token structure and required fields\r\n        if (!decoded.userId || !decoded.role || !decoded.iat || !decoded.exp) {\r\n          return res.status(401).json({\r\n            error: 'Invalid token structure',\r\n            message: 'Token is missing required claims'\r\n          });\r\n        }\r\n\r\n        // Check token expiration with additional buffer\r\n        const now = Math.floor(Date.now() / 1000);\r\n        if (decoded.exp <= now) {\r\n          return res.status(401).json({\r\n            error: 'Token expired',\r\n            message: 'Authentication token has expired'\r\n          });\r\n        }\r\n\r\n        // Check for suspicious activity from this IP\r\n        const ipReputation = await this.checkIPReputation(req.ip);\r\n        if (ipReputation.isSuspicious) {\r\n          this.logger.logSecurity('Suspicious IP Access Attempt', decoded.userId, {\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            reputation: ipReputation,\r\n            path: req.originalUrl\r\n          });\r\n          \r\n          return res.status(403).json({\r\n            error: 'Access denied',\r\n            message: 'Suspicious activity detected from your IP address'\r\n          });\r\n        }\r\n\r\n        // Attach user info to request\r\n        req.user = decoded;\r\n        req.userId = decoded.userId;\r\n        req.userRole = decoded.role;\r\n        req.token = token;\r\n\r\n        this.logger.logAuth('Token Verified', decoded.userId, {\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent')\r\n        });\r\n\r\n        next();\r\n\r\n      } catch (error) {\r\n        this.logger.error('Authentication Error', error.message, {\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          errorType: error.name\r\n        });\r\n\r\n        // Enhanced error handling for different JWT errors\r\n        let errorMessage = 'Authentication failed';\r\n        let statusCode = 401;\r\n\r\n        if (error.name === 'TokenExpiredError') {\r\n          errorMessage = 'Token has expired';\r\n        } else if (error.name === 'JsonWebTokenError') {\r\n          errorMessage = 'Invalid token format or signature';\r\n        } else if (error.name === 'NotBeforeError') {\r\n          errorMessage = 'Token not yet active';\r\n        }\r\n\r\n        return res.status(statusCode).json({\r\n          error: 'Authentication failed',\r\n          message: errorMessage\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  // JWT token rotation and refresh mechanism\r\n  async rotateToken(req, res) {\r\n    try {\r\n      const { refreshToken } = req.body;\r\n      \r\n      if (!refreshToken) {\r\n        return res.status(400).json({\r\n          error: 'Refresh token required',\r\n          message: 'Refresh token is required for token rotation'\r\n        });\r\n      }\r\n\r\n      // Verify refresh token\r\n      const jwtConfig = this.config.getJWTConfig();\r\n      const decoded = jwt.verify(refreshToken, jwtConfig.secret, {\r\n        algorithms: [jwtConfig.algorithm],\r\n        issuer: jwtConfig.issuer\r\n      });\r\n\r\n      // Generate new access token with shorter expiration\r\n      const newAccessToken = jwt.sign(\r\n        {\r\n          userId: decoded.userId,\r\n          email: decoded.email,\r\n          role: decoded.role,\r\n          tokenType: 'access',\r\n          rotatedAt: new Date().toISOString()\r\n        },\r\n        jwtConfig.secret,\r\n        { expiresIn: '15m' } // Shorter expiration for access tokens\r\n      );\r\n\r\n      // Generate new refresh token with longer expiration\r\n      const newRefreshToken = jwt.sign(\r\n        {\r\n          userId: decoded.userId,\r\n          email: decoded.email,\r\n          role: decoded.role,\r\n          tokenType: 'refresh',\r\n          rotatedAt: new Date().toISOString()\r\n        },\r\n        jwtConfig.secret,\r\n        { expiresIn: '7d' } // Longer expiration for refresh tokens\r\n      );\r\n\r\n      // Blacklist old refresh token\r\n      await this.blacklistToken(refreshToken, 'Token rotation');\r\n\r\n      this.logger.logSecurity('Token Rotation Completed', decoded.userId, {\r\n        oldTokenExpiry: new Date(decoded.exp * 1000).toISOString(),\r\n        newAccessTokenExpiry: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        path: req.originalUrl\r\n      });\r\n\r\n      return res.status(200).json({\r\n        message: 'Token rotated successfully',\r\n        accessToken: newAccessToken,\r\n        refreshToken: newRefreshToken,\r\n        tokenType: 'rotated'\r\n      });\r\n\r\n    } catch (error) {\r\n      this.logger.error('Token rotation error', error.message, {\r\n        userId: decoded?.userId || 'unknown',\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        path: req.originalUrl\r\n      });\r\n\r\n      return res.status(401).json({\r\n        error: 'Token rotation failed',\r\n        message: 'Failed to rotate authentication token'\r\n      });\r\n    }\r\n  }\r\n\r\n  // Enhanced token validation with rotation check\r\n  async validateAndRotateToken(req, res, next) {\r\n    const authHeader = req.headers.authorization;\r\n    \r\n    if (!authHeader) {\r\n      return res.status(401).json({\r\n        error: 'Access token required',\r\n        message: 'Authorization header is missing'\r\n      });\r\n    }\r\n\r\n    const token = authHeader.replace('Bearer ', '');\r\n    \r\n    if (!token) {\r\n      return res.status(401).json({\r\n        error: 'Invalid token format',\r\n        message: 'Authorization header must be in format \"Bearer <token>\"'\r\n      });\r\n    }\r\n\r\n    // Check if token is blacklisted\r\n    const isBlacklisted = await this.isTokenBlacklisted(token);\r\n    if (isBlacklisted) {\r\n      this.logger.logSecurity('Blacklisted Token Access Attempt', null, {\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        path: req.originalUrl\r\n      });\r\n      \r\n      return res.status(401).json({\r\n        error: 'Token revoked',\r\n        message: 'This token has been revoked and cannot be used'\r\n      });\r\n    }\r\n\r\n    // Enhanced JWT verification with proper algorithm validation\r\n    const jwtConfig = this.config.getJWTConfig();\r\n    const decoded = jwt.verify(token, jwtConfig.secret, {\r\n      algorithms: [jwtConfig.algorithm],\r\n      issuer: jwtConfig.issuer,\r\n      clockTolerance: 30 // 30 seconds clock skew tolerance\r\n    });\r\n    \r\n    if (!decoded) {\r\n      return res.status(401).json({\r\n        error: 'Invalid token',\r\n        message: 'Token is expired or invalid'\r\n      });\r\n    }\r\n\r\n    // Validate token structure and required fields\r\n    if (!decoded.userId || !decoded.role || !decoded.iat || !decoded.exp) {\r\n      return res.status(401).json({\r\n        error: 'Invalid token structure',\r\n        message: 'Token is missing required claims'\r\n      });\r\n    }\r\n\r\n    // Check token expiration with additional buffer and rotation check\r\n    const now = Math.floor(Date.now() / 1000);\r\n    const expirationBuffer = 300; // 5 minutes buffer before expiration\r\n    const timeUntilExpiry = decoded.exp - now;\r\n    \r\n    if (decoded.exp <= now) {\r\n      return res.status(401).json({\r\n        error: 'Token expired',\r\n        message: 'Authentication token has expired'\r\n      });\r\n    }\r\n\r\n    // Check if token is close to expiration and needs rotation\r\n    if (timeUntilExpiry <= expirationBuffer) {\r\n      this.logger.logSecurity('Token Rotation Required', decoded.userId, {\r\n        timeUntilExpiry,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        path: req.originalUrl,\r\n        currentExpiry: new Date(decoded.exp * 1000).toISOString()\r\n      });\r\n      \r\n      // Attempt automatic token rotation\r\n      return await this.rotateToken(req, res);\r\n    }\r\n\r\n    // Attach user info to request\r\n    req.user = decoded;\r\n    req.userId = decoded.userId;\r\n    req.userRole = decoded.role;\r\n    req.token = token;\r\n\r\n    this.logger.logAuth('Token Verified', decoded.userId, {\r\n      ip: req.ip,\r\n      userAgent: req.get('User-Agent')\r\n    });\r\n\r\n    next();\r\n  }\r\n\r\n  // Role-based authorization middleware\r\n  authorize(roles) {\r\n    return (req, res, next) => {\r\n      if (!req.user) {\r\n        return res.status(401).json({\r\n          error: 'Authentication required',\r\n          message: 'You must be authenticated to access this resource'\r\n        });\r\n      }\r\n\r\n      const userRole = req.userRole;\r\n      const hasRequiredRole = roles.some(role => userRole === role);\r\n\r\n      if (!hasRequiredRole) {\r\n        this.logger.logSecurity('Unauthorized Access Attempt', req.userId, {\r\n          requiredRole: roles,\r\n          userRole,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          path: req.originalUrl\r\n        });\r\n\r\n        return res.status(403).json({\r\n          error: 'Insufficient permissions',\r\n          message: `Access denied. Required roles: ${roles.join(', ')}`\r\n        });\r\n      }\r\n\r\n      this.logger.logAuth('Access Granted', req.userId, {\r\n        requiredRole: roles,\r\n        userRole,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        path: req.originalUrl\r\n      });\r\n\r\n      next();\r\n    };\r\n  }\r\n\r\n  // Admin only middleware\r\n  adminOnly() {\r\n    return this.authorize(['ADMIN']);\r\n  }\r\n\r\n  // Manager or Admin middleware\r\n  managerOrAdmin() {\r\n    return this.authorize(['MANAGER', 'ADMIN']);\r\n  }\r\n\r\n  // Customer or Admin middleware\r\n  customerOrAdmin() {\r\n    return this.authorize(['CUSTOMER', 'ADMIN']);\r\n  }\r\n\r\n  // Self or Admin middleware (users can access their own resources)\r\n  selfOrAdmin(userId) {\r\n    return (req, res, next) => {\r\n      if (!req.user) {\r\n        return res.status(401).json({\r\n          error: 'Authentication required',\r\n          message: 'You must be authenticated to access this resource'\r\n        });\r\n      }\r\n\r\n      // Allow access if user is admin or accessing their own resource\r\n      const isOwner = req.userId === userId;\r\n      const isAdmin = req.userRole === 'ADMIN';\r\n\r\n      if (!isOwner && !isAdmin) {\r\n        this.logger.logSecurity('Unauthorized Access Attempt', req.userId, {\r\n          targetUserId: userId,\r\n          userRole: req.userRole,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          path: req.originalUrl\r\n        });\r\n\r\n        return res.status(403).json({\r\n          error: 'Access denied',\r\n          message: 'You can only access your own resources or need admin privileges'\r\n        });\r\n      }\r\n\r\n      this.logger.logAuth('Access Granted', req.userId, {\r\n        targetUserId: userId,\r\n        userRole: req.userRole,\r\n        isOwner,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        path: req.originalUrl\r\n      });\r\n\r\n      next();\r\n    };\r\n  }\r\n\r\n  // Optional authentication (guest access allowed)\r\n  optional() {\r\n    return async (req, res, next) => {\r\n      const authHeader = req.headers.authorization;\r\n      \r\n      if (!authHeader) {\r\n        // No authentication provided, continue as guest\r\n        req.user = null;\r\n        req.userId = null;\r\n        req.userRole = null;\r\n        return next();\r\n      }\r\n\r\n      try {\r\n        const token = authHeader.replace('Bearer ', '');\r\n        \r\n        // Check if token is blacklisted\r\n        const isBlacklisted = await this.isTokenBlacklisted(token);\r\n        if (isBlacklisted) {\r\n          req.user = null;\r\n          req.userId = null;\r\n          req.userRole = null;\r\n          return next();\r\n        }\r\n\r\n        const jwtConfig = this.config.getJWTConfig();\r\n        const decoded = jwt.verify(token, jwtConfig.secret, {\r\n          algorithms: [jwtConfig.algorithm],\r\n          issuer: jwtConfig.issuer\r\n        });\r\n        \r\n        // Attach user info if token is valid\r\n        req.user = decoded;\r\n        req.userId = decoded.userId;\r\n        req.userRole = decoded.role;\r\n\r\n        this.logger.logAuth('Optional Authentication', decoded.userId, {\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent')\r\n        });\r\n\r\n      } catch (error) {\r\n        // Invalid token, continue as guest\r\n        req.user = null;\r\n        req.userId = null;\r\n        req.userRole = null;\r\n        \r\n        this.logger.warn('Invalid Optional Token', error.message, {\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent')\r\n        });\r\n      }\r\n\r\n      next();\r\n    };\r\n  }\r\n\r\n  // Redis-based rate limiting middleware\r\n  rateLimit(options = {}) {\r\n    return async (req, res, next) => {\r\n      try {\r\n        if (!this.redis) {\r\n          if (this.logger && typeof this.logger.warn === 'function') {\r\n            this.logger.warn('Rate limiting disabled - Redis not available');\r\n          } else {\r\n            console.warn('Rate limiting disabled - Redis not available');\r\n          }\r\n          // Allow request without rate limiting\r\n          return next();\r\n        }\r\n\r\n        const config = {\r\n          windowMs: options.windowMs || 15 * 60 * 1000, // 15 minutes\r\n          max: options.max || this.config.isProduction() ? 100 : 1000,\r\n          message: options.message || 'Too many requests from this IP, please try again later.',\r\n          standardHeaders: true\r\n        };\r\n\r\n        const key = `rate_limit:${req.ip}`;\r\n        const now = Date.now();\r\n        const windowStart = now - config.windowMs;\r\n        \r\n        // Use Redis pipeline for atomic operations\r\n        const pipeline = this.redis.pipeline();\r\n        \r\n        // Remove old entries\r\n        pipeline.zRemRangeByScore(key, 0, windowStart);\r\n        \r\n        // Add current request\r\n        pipeline.zAdd(key, [{ score: now, value: `${now}-${Math.random()}` }]);\r\n        \r\n        // Get current count\r\n        pipeline.zCard(key);\r\n        \r\n        // Set expiration\r\n        pipeline.expire(key, Math.ceil(config.windowMs / 1000));\r\n        \r\n        const results = await pipeline.exec();\r\n        const currentCount = results[2].reply;\r\n\r\n        if (currentCount > config.max) {\r\n          this.logger.logSecurity('Rate Limit Exceeded', null, {\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            path: req.originalUrl,\r\n            count: currentCount,\r\n            limit: config.max,\r\n            windowMs: config.windowMs\r\n          });\r\n\r\n          return res.status(429).json({\r\n            error: 'Too many requests',\r\n            message: config.message,\r\n            retryAfter: Math.ceil(config.windowMs / 1000)\r\n          });\r\n        }\r\n\r\n        // Add rate limit headers\r\n        res.set({\r\n          'X-RateLimit-Limit': config.max,\r\n          'X-RateLimit-Remaining': Math.max(0, config.max - currentCount),\r\n          'X-RateLimit-Reset': new Date(now + config.windowMs).toISOString()\r\n        });\r\n\r\n        next();\r\n\r\n      } catch (error) {\r\n        this.logger.error('Rate limiting error', error.message, {\r\n          ip: req.ip,\r\n          path: req.originalUrl\r\n        });\r\n        \r\n        // Fail open - allow request but log error\r\n        next();\r\n      }\r\n    };\r\n  }\r\n\r\n  // Token blacklist management\r\n  async blacklistToken(token, reason = 'User logout') {\r\n    try {\r\n      if (!this.redis) {\r\n        if (this.logger && typeof this.logger.warn === 'function') {\r\n          this.logger.warn('Token blacklisting disabled - Redis not available', { reason });\r\n        } else {\r\n          console.warn('Token blacklisting disabled - Redis not available', { reason });\r\n        }\r\n        return; // Skip blacklisting but continue\r\n      }\r\n\r\n      // Decode token to get expiration\r\n      const decoded = jwt.decode(token);\r\n      if (!decoded || !decoded.exp) {\r\n        throw new Error('Invalid token for blacklisting');\r\n      }\r\n\r\n      const ttl = decoded.exp - Math.floor(Date.now() / 1000);\r\n      if (ttl <= 0) {\r\n        return; // Token already expired\r\n      }\r\n\r\n      const key = `blacklist:${crypto.createHash('sha256').update(token).digest('hex')}`;\r\n      await this.redis.setEx(key, ttl, JSON.stringify({\r\n        reason,\r\n        blacklistedAt: new Date().toISOString(),\r\n        originalExp: new Date(decoded.exp * 1000).toISOString()\r\n      }));\r\n\r\n      this.logger.info('Token blacklisted successfully', {\r\n        reason,\r\n        ttl,\r\n        userId: decoded.userId\r\n      });\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to blacklist token', error.message);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async isTokenBlacklisted(token) {\r\n    try {\r\n      if (!this.redis) {\r\n        if (this.logger && typeof this.logger.warn === 'function') {\r\n          this.logger.warn('Token blacklist check disabled - Redis not available');\r\n        } else {\r\n          console.warn('Token blacklist check disabled - Redis not available');\r\n        }\r\n        return false;\r\n      }\r\n\r\n      const key = `blacklist:${crypto.createHash('sha256').update(token).digest('hex')}`;\r\n      const result = await this.redis.get(key);\r\n      return result !== null;\r\n    } catch (error) {\r\n      this.logger.error('Error checking token blacklist', error.message);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // IP reputation checking\r\n  async checkIPReputation(ip) {\r\n    try {\r\n      if (!this.redis) {\r\n        if (this.logger && typeof this.logger.warn === 'function') {\r\n          this.logger.warn('IP reputation check disabled - Redis not available');\r\n        } else {\r\n          console.warn('IP reputation check disabled - Redis not available');\r\n        }\r\n        return { isSuspicious: false, score: 0 };\r\n      }\r\n\r\n      const key = `ip_reputation:${ip}`;\r\n      const data = await this.redis.hGetAll(key);\r\n      \r\n      if (!data || Object.keys(data).length === 0) {\r\n        return { isSuspicious: false, score: 0 };\r\n      }\r\n\r\n      const failedAttempts = parseInt(data.failedAttempts || '0');\r\n      const lastAttempt = parseInt(data.lastAttempt || '0');\r\n      const now = Date.now();\r\n      \r\n      // Calculate reputation score\r\n      let score = 0;\r\n      if (failedAttempts > 10) score += 3;\r\n      if (failedAttempts > 5) score += 2;\r\n      if (now - lastAttempt < 60000) score += 1; // Recent activity\r\n\r\n      return {\r\n        isSuspicious: score >= 3,\r\n        score,\r\n        failedAttempts,\r\n        lastAttempt: new Date(lastAttempt).toISOString()\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Error checking IP reputation', error.message);\r\n      return { isSuspicious: false, score: 0 };\r\n    }\r\n  }\r\n\r\n  async recordFailedAttempt(ip, reason = 'authentication') {\r\n    try {\r\n      if (!this.redis) {\r\n        if (this.logger && typeof this.logger.warn === 'function') {\r\n          this.logger.warn('Failed attempt recording disabled - Redis not available');\r\n        } else {\r\n          console.warn('Failed attempt recording disabled - Redis not available');\r\n        }\r\n        return;\r\n      }\r\n\r\n      const key = `ip_reputation:${ip}`;\r\n      const now = Date.now();\r\n      \r\n      await this.redis.hIncrBy(key, 'failedAttempts', 1);\r\n      await this.redis.hSet(key, 'lastAttempt', now.toString());\r\n      await this.redis.expire(key, 24 * 60 * 60); // 24 hours\r\n\r\n    } catch (error) {\r\n      this.logger.error('Error recording failed attempt', error.message);\r\n    }\r\n  }\r\n\r\n  // Request ID middleware\r\n  requestId() {\r\n    return (req, res, next) => {\r\n      req.id = this.generateRequestId();\r\n      res.setHeader('X-Request-ID', req.id);\r\n      next();\r\n    };\r\n  }\r\n\r\n  // Generate unique request ID\r\n  generateRequestId() {\r\n    return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  // Enhanced API key validation with rotation support\r\n  validateApiKey(apiKeys = []) {\r\n    return async (req, res, next) => {\r\n      try {\r\n        const apiKey = req.headers['x-api-key'];\r\n        \r\n        if (!apiKey) {\r\n          return res.status(401).json({\r\n            error: 'API key required',\r\n            message: 'X-API-Key header is required'\r\n          });\r\n        }\r\n\r\n        // Check if API key is in valid list\r\n        const validKey = apiKeys.find(key => {\r\n          if (typeof key === 'string') {\r\n            return key === apiKey;\r\n          } else if (typeof key === 'object') {\r\n            return key.key === apiKey && this.isApiKeyValid(key);\r\n          }\r\n          return false;\r\n        });\r\n\r\n        if (!validKey) {\r\n          await this.recordFailedAttempt(req.ip, 'api_key');\r\n          \r\n          this.logger.logSecurity('Invalid API Key', null, {\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            path: req.originalUrl,\r\n            apiKey: apiKey.substring(0, 8) + '...'\r\n          });\r\n\r\n          return res.status(401).json({\r\n            error: 'Invalid API key',\r\n            message: 'The provided API key is not valid'\r\n          });\r\n        }\r\n\r\n        // Check for API key rotation if it's an object with expiration\r\n        if (typeof validKey === 'object' && validKey.expiresAt) {\r\n          const now = Date.now();\r\n          if (now > validKey.expiresAt) {\r\n            return res.status(401).json({\r\n              error: 'API key expired',\r\n              message: 'The provided API key has expired and needs rotation'\r\n            });\r\n          }\r\n\r\n          // Add warning if key is close to expiration\r\n          const timeUntilExpiry = validKey.expiresAt - now;\r\n          const warningThreshold = 7 * 24 * 60 * 60 * 1000; // 7 days\r\n          \r\n          if (timeUntilExpiry < warningThreshold) {\r\n            res.set('X-API-Key-Expires-Soon', 'true');\r\n            res.set('X-API-Key-Expiry-Date', new Date(validKey.expiresAt).toISOString());\r\n          }\r\n        }\r\n\r\n        this.logger.logSecurity('API Key Validated', null, {\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          path: req.originalUrl,\r\n          keyId: typeof validKey === 'object' ? validKey.id : 'unknown'\r\n        });\r\n\r\n        req.apiKey = validKey;\r\n        next();\r\n\r\n      } catch (error) {\r\n        this.logger.error('API key validation error', error.message, {\r\n          ip: req.ip,\r\n          path: req.originalUrl\r\n        });\r\n\r\n        return res.status(500).json({\r\n          error: 'Internal server error',\r\n          message: 'API key validation failed'\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  isApiKeyValid(keyObject) {\r\n    if (!keyObject.key || !keyObject.createdAt) {\r\n      return false;\r\n    }\r\n\r\n    const now = Date.now();\r\n    \r\n    // Check if key has expired\r\n    if (keyObject.expiresAt && now > keyObject.expiresAt) {\r\n      return false;\r\n    }\r\n\r\n    // Check if key has been revoked\r\n    if (keyObject.revokedAt && now > keyObject.revokedAt) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // Enhanced session validation with proper expiration\r\n  validateSession() {\r\n    return async (req, res, next) => {\r\n      try {\r\n        const sessionId = req.headers['x-session-id'];\r\n        \r\n        if (!sessionId) {\r\n          return res.status(401).json({\r\n            error: 'Session required',\r\n            message: 'X-Session-ID header is required'\r\n          });\r\n        }\r\n\r\n        if (!this.redis) {\r\n          if (this.logger && typeof this.logger.warn === 'function') {\r\n            this.logger.warn('Session validation disabled - Redis not available');\r\n          } else {\r\n            console.warn('Session validation disabled - Redis not available');\r\n          }\r\n          return res.status(503).json({\r\n            error: 'Service unavailable',\r\n            message: 'Session validation temporarily unavailable'\r\n          });\r\n        }\r\n\r\n        const sessionKey = `session:${sessionId}`;\r\n        const sessionData = await this.redis.get(sessionKey);\r\n\r\n        if (!sessionData) {\r\n          this.logger.logSecurity('Invalid Session', null, {\r\n            sessionId,\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            path: req.originalUrl\r\n          });\r\n\r\n          return res.status(401).json({\r\n            error: 'Invalid session',\r\n            message: 'Session not found or has expired'\r\n          });\r\n        }\r\n\r\n        const session = JSON.parse(sessionData);\r\n        \r\n        // Check session expiration\r\n        const now = Date.now();\r\n        if (session.expiresAt && now > session.expiresAt) {\r\n          await this.redis.del(sessionKey);\r\n          \r\n          return res.status(401).json({\r\n            error: 'Session expired',\r\n            message: 'Your session has expired, please login again'\r\n          });\r\n        }\r\n\r\n        // Check if session is for same IP (optional security measure)\r\n        if (session.ip && session.ip !== req.ip) {\r\n          this.logger.logSecurity('Session IP Mismatch', session.userId, {\r\n            sessionId,\r\n            originalIp: session.ip,\r\n            currentIp: req.ip,\r\n            userAgent: req.get('User-Agent')\r\n          });\r\n\r\n          return res.status(401).json({\r\n            error: 'Session invalid',\r\n            message: 'Session IP address mismatch detected'\r\n          });\r\n        }\r\n\r\n        // Update last activity\r\n        session.lastActivity = now;\r\n        await this.redis.setEx(sessionKey, \r\n          Math.ceil((session.expiresAt - now) / 1000), \r\n          JSON.stringify(session)\r\n        );\r\n\r\n        req.sessionId = sessionId;\r\n        req.session = session;\r\n\r\n        this.logger.logAuth('Session Validated', session.userId, {\r\n          sessionId,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          path: req.originalUrl\r\n        });\r\n\r\n        next();\r\n\r\n      } catch (error) {\r\n        this.logger.error('Session validation error', error.message, {\r\n          ip: req.ip,\r\n          path: req.originalUrl\r\n        });\r\n\r\n        return res.status(500).json({\r\n          error: 'Internal server error',\r\n          message: 'Session validation failed'\r\n        });\r\n      }\r\n    };\r\n  }\r\n\r\n  // CORS middleware\r\n  cors(options = {}) {\r\n    return (req, res, next) => {\r\n      const config = this.config.getCORSConfig();\r\n      \r\n      // Set CORS headers\r\n      res.header('Access-Control-Allow-Origin', options.origin || config.origin);\r\n      res.header('Access-Control-Allow-Methods', config.methods.join(', '));\r\n      res.header('Access-Control-Allow-Headers', config.allowedHeaders.join(', '));\r\n      res.header('Access-Control-Expose-Headers', config.exposedHeaders.join(', '));\r\n      \r\n      if (config.credentials) {\r\n        res.header('Access-Control-Allow-Credentials', 'true');\r\n      }\r\n\r\n      // Handle preflight requests\r\n      if (req.method === 'OPTIONS') {\r\n        res.status(200).end();\r\n        return;\r\n      }\r\n\r\n      next();\r\n    };\r\n  }\r\n}\r\n\r\n// Error logging middleware\r\nfunction errorLogger() {\r\n  return (req, res, next) => {\r\n    // Use console since loggerService might not be available in all contexts\r\n    console.error('Request Error', {\r\n      method: req.method,\r\n      url: req.originalUrl,\r\n      ip: req.ip,\r\n      userAgent: req.get('User-Agent'),\r\n      error: req.error || 'Unknown error',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n    \r\n    res.status(500).json({\r\n      error: 'Internal server error',\r\n      message: 'An unexpected error occurred',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  };\r\n}\r\n\r\n// Singleton instance\r\nconst authMiddleware = new AuthMiddleware();\r\n\r\nmodule.exports = {\r\n  AuthMiddleware,\r\n  authMiddleware,\r\n  errorLogger\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}