{"version":3,"names":["_getJestObj","mock","emailService","sendVerificationEmail","jest","fn","mockResolvedValue","success","messageId","sendWelcomeEmail","sendPasswordResetEmail","validateEmail","email","emailRegex","test","isDisposableEmail","disposableDomains","domain","split","toLowerCase","includes","generateVerificationToken","Math","random","toString","substr","isAvailable","loggerService","info","warn","error","debug","logAuth","logSecurity","logPerformance","configService","get","key","defaults","getJWTConfig","secret","algorithm","issuer","expiresIn","getEmailConfig","host","port","secure","user","pass","from","authMiddleware","authenticate","req","res","next","userId","role","userRole","PrismaClient","$connect","$disconnect","findUnique","findFirst","create","update","delete","deleteMany","emailVerificationToken","require","request","express","jwt","app","use","json","authRoutes","emailVerificationMiddleware","prisma","describe","beforeEach","clearAllMocks","expect","toBe","token1","token2","toBeTruthy","not","id","firstName","lastName","status","createdAt","Date","token","expiresAt","now","userData","password","response","post","send","body","message","toContain","requiresEmailVerification","toHaveBeenCalled","emailVerified","emailVerificationTokens","lastLoginAt","middleware","requireEmailVerification","mockReq","ip","originalUrl","mockRes","mockReturnThis","mockNext","toHaveBeenCalledWith","mockResolvedValueOnce","response1","response2"],"sources":["email-verification-isolated.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\nconst { PrismaClient } = require('@prisma/client');\r\nconst jwt = require('jsonwebtoken');\r\n\r\n// Create isolated test environment\r\nconst app = express();\r\napp.use(express.json());\r\n\r\n// Mock all dependencies before importing routes\r\njest.mock('../services/smsService');\r\njest.mock('../services/otpService');\r\njest.mock('../services/passwordService');\r\njest.mock('../services/phoneValidationService');\r\njest.mock('../services/logger');\r\njest.mock('../services/config');\r\njest.mock('../middleware/auth');\r\n\r\n// Mock email service with comprehensive methods\r\njest.mock('../services/emailService', () => ({\r\n  emailService: {\r\n    sendVerificationEmail: jest.fn().mockResolvedValue({\r\n      success: true,\r\n      messageId: 'test-message-id'\r\n    }),\r\n    sendWelcomeEmail: jest.fn().mockResolvedValue({\r\n      success: true,\r\n      messageId: 'welcome-message-id'\r\n    }),\r\n    sendPasswordResetEmail: jest.fn().mockResolvedValue({\r\n      success: true,\r\n      messageId: 'reset-message-id'\r\n    }),\r\n    validateEmail: jest.fn((email) => {\r\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n      return emailRegex.test(email);\r\n    }),\r\n    isDisposableEmail: jest.fn((email) => {\r\n      const disposableDomains = [\r\n        '10minutemail.com',\r\n        'tempmail.org',\r\n        'guerrillamail.com',\r\n        'mailinator.com',\r\n        'yopmail.com',\r\n        'throwaway.email'\r\n      ];\r\n      const domain = email.split('@')[1]?.toLowerCase();\r\n      return disposableDomains.includes(domain);\r\n    }),\r\n    generateVerificationToken: jest.fn(() => 'test-verification-token-' + Math.random().toString(36).substr(2, 9)),\r\n    isAvailable: jest.fn(() => true)\r\n  }\r\n}));\r\n\r\n// Mock logger service\r\njest.mock('../services/logger', () => ({\r\n  loggerService: {\r\n    info: jest.fn(),\r\n    warn: jest.fn(),\r\n    error: jest.fn(),\r\n    debug: jest.fn(),\r\n    logAuth: jest.fn(),\r\n    logSecurity: jest.fn(),\r\n    logPerformance: jest.fn()\r\n  }\r\n}));\r\n\r\n// Mock config service\r\njest.mock('../services/config', () => ({\r\n  configService: {\r\n    get: jest.fn((key) => {\r\n      const defaults = {\r\n        'JWT_SECRET': 'test-jwt-secret-key',\r\n        'DATABASE_URL': 'postgresql://test:test@localhost:5432/test_db',\r\n        'REDIS_URL': 'redis://localhost:6379',\r\n        'NODE_ENV': 'test'\r\n      };\r\n      return defaults[key] || null;\r\n    }),\r\n    getJWTConfig: jest.fn(() => ({\r\n      secret: 'test-jwt-secret-key',\r\n      algorithm: 'HS256',\r\n      issuer: 'smart-technologies-bd',\r\n      expiresIn: '1h'\r\n    })),\r\n    getEmailConfig: jest.fn(() => ({\r\n      host: 'smtp.test.com',\r\n      port: 587,\r\n      secure: false,\r\n      user: 'test@test.com',\r\n      pass: 'test-password',\r\n      from: 'test@test.com'\r\n    }))\r\n  }\r\n}));\r\n\r\n// Mock auth middleware\r\njest.mock('../middleware/auth', () => ({\r\n  authMiddleware: {\r\n    authenticate: jest.fn(() => (req, res, next) => {\r\n      // Simple mock that just calls next for testing\r\n      req.user = { userId: 'test-user-id', role: 'CUSTOMER' };\r\n      req.userId = 'test-user-id';\r\n      req.userRole = 'CUSTOMER';\r\n      next();\r\n    })\r\n  }\r\n}));\r\n\r\n// Mock Prisma client\r\njest.mock('@prisma/client', () => ({\r\n  PrismaClient: jest.fn(() => ({\r\n    $connect: jest.fn().mockResolvedValue(),\r\n    $disconnect: jest.fn().mockResolvedValue(),\r\n    user: {\r\n      findUnique: jest.fn(),\r\n      findFirst: jest.fn(),\r\n      create: jest.fn(),\r\n      update: jest.fn(),\r\n      delete: jest.fn(),\r\n      deleteMany: jest.fn()\r\n    },\r\n    emailVerificationToken: {\r\n      findUnique: jest.fn(),\r\n      create: jest.fn(),\r\n      delete: jest.fn(),\r\n      deleteMany: jest.fn()\r\n    }\r\n  }))\r\n}));\r\n\r\n// Import routes after mocking\r\nconst authRoutes = require('../routes/auth');\r\nconst { emailVerificationMiddleware } = require('../middleware/emailVerification');\r\n\r\napp.use('/api/auth', authRoutes);\r\n\r\nconst prisma = new PrismaClient();\r\n\r\ndescribe('Email Verification System - Isolated Tests', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('Email Service Validation', () => {\r\n    test('should validate email format correctly', () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      expect(emailService.validateEmail('test@example.com')).toBe(true);\r\n      expect(emailService.validateEmail('user.name@domain.co.uk')).toBe(true);\r\n      expect(emailService.validateEmail('user+tag@example.org')).toBe(true);\r\n      \r\n      expect(emailService.validateEmail('invalid-email')).toBe(false);\r\n      expect(emailService.validateEmail('test@')).toBe(false);\r\n      expect(emailService.validateEmail('@example.com')).toBe(false);\r\n      expect(emailService.validateEmail('test@.com')).toBe(false);\r\n    });\r\n\r\n    test('should detect disposable emails', () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      expect(emailService.isDisposableEmail('test@10minutemail.com')).toBe(true);\r\n      expect(emailService.isDisposableEmail('user@tempmail.org')).toBe(true);\r\n      expect(emailService.isDisposableEmail('demo@guerrillamail.com')).toBe(true);\r\n      expect(emailService.isDisposableEmail('sample@mailinator.com')).toBe(true);\r\n      \r\n      expect(emailService.isDisposableEmail('user@gmail.com')).toBe(false);\r\n      expect(emailService.isDisposableEmail('test@yahoo.com')).toBe(false);\r\n      expect(emailService.isDisposableEmail('user@outlook.com')).toBe(false);\r\n    });\r\n\r\n    test('should generate secure verification tokens', () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      const token1 = emailService.generateVerificationToken();\r\n      const token2 = emailService.generateVerificationToken();\r\n      \r\n      expect(token1).toBeTruthy();\r\n      expect(token2).toBeTruthy();\r\n      expect(token1).not.toBe(token2);\r\n      expect(typeof token1).toBe('string');\r\n      expect(typeof token2).toBe('string');\r\n    });\r\n  });\r\n\r\n  describe('Email Registration Endpoint Tests', () => {\r\n    test('should handle registration with valid data', async () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      // Mock successful user creation\r\n      prisma.user.findFirst.mockResolvedValue(null);\r\n      prisma.user.create.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'test@example.com',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        role: 'CUSTOMER',\r\n        status: 'PENDING',\r\n        createdAt: new Date()\r\n      });\r\n      \r\n      // Mock token creation\r\n      prisma.emailVerificationToken.create.mockResolvedValue({\r\n        id: 'token-id',\r\n        userId: 'user-id',\r\n        token: 'test-token',\r\n        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000)\r\n      });\r\n\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'Password123!',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(201);\r\n\r\n      expect(response.body.message).toContain('Please check your email to verify your account');\r\n      expect(response.body.user.status).toBe('PENDING');\r\n      expect(response.body.requiresEmailVerification).toBe(true);\r\n      expect(emailService.sendVerificationEmail).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should reject disposable email addresses', async () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      const userData = {\r\n        email: 'test@10minutemail.com',\r\n        password: 'Password123!',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Disposable email not allowed');\r\n    });\r\n\r\n    test('should reject invalid email format', async () => {\r\n      const userData = {\r\n        email: 'invalid-email',\r\n        password: 'Password123!',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Invalid email format');\r\n    });\r\n\r\n    test('should reject weak password', async () => {\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: '123',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Password does not meet requirements');\r\n    });\r\n\r\n    test('should handle existing user', async () => {\r\n      prisma.user.findFirst.mockResolvedValue({\r\n        id: 'existing-user-id',\r\n        email: 'test@example.com'\r\n      });\r\n\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'Password123!',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(409);\r\n\r\n      expect(response.body.error).toBe('User already exists');\r\n    });\r\n  });\r\n\r\n  describe('Email Verification Endpoint Tests', () => {\r\n    test('should verify email with valid token', async () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      // Mock user and token lookup\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue({\r\n        id: 'token-id',\r\n        userId: 'user-id',\r\n        token: 'valid-token',\r\n        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000),\r\n        user: {\r\n          id: 'user-id',\r\n          email: 'test@example.com',\r\n          firstName: 'Test',\r\n          lastName: 'User',\r\n          status: 'PENDING'\r\n        }\r\n      });\r\n\r\n      prisma.user.update.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'test@example.com',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        status: 'ACTIVE',\r\n        emailVerified: new Date()\r\n      });\r\n\r\n      prisma.emailVerificationToken.delete.mockResolvedValue();\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/verify-email')\r\n        .send({ token: 'valid-token' })\r\n        .expect(200);\r\n\r\n      expect(response.body.message).toBe('Email verified successfully');\r\n      expect(response.body.user.status).toBe('ACTIVE');\r\n      expect(emailService.sendWelcomeEmail).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should reject expired token', async () => {\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue({\r\n        id: 'token-id',\r\n        userId: 'user-id',\r\n        token: 'expired-token',\r\n        expiresAt: new Date(Date.now() - 60 * 60 * 1000), // 1 hour ago\r\n        user: {\r\n          id: 'user-id',\r\n          email: 'test@example.com',\r\n          status: 'PENDING'\r\n        }\r\n      });\r\n\r\n      prisma.emailVerificationToken.delete.mockResolvedValue();\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/verify-email')\r\n        .send({ token: 'expired-token' })\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Token expired');\r\n    });\r\n\r\n    test('should reject invalid token', async () => {\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/verify-email')\r\n        .send({ token: 'invalid-token' })\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Invalid token');\r\n    });\r\n\r\n    test('should reject already verified user', async () => {\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue({\r\n        id: 'token-id',\r\n        userId: 'user-id',\r\n        token: 'valid-token',\r\n        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000),\r\n        user: {\r\n          id: 'user-id',\r\n          email: 'test@example.com',\r\n          status: 'ACTIVE',\r\n          emailVerified: new Date()\r\n        }\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/verify-email')\r\n        .send({ token: 'valid-token' })\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Already verified');\r\n    });\r\n  });\r\n\r\n  describe('Resend Verification Endpoint Tests', () => {\r\n    test('should resend verification email for unverified user', async () => {\r\n      const { emailService } = require('../services/emailService');\r\n      \r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'test@example.com',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        status: 'PENDING',\r\n        emailVerificationTokens: []\r\n      });\r\n\r\n      prisma.emailVerificationToken.deleteMany.mockResolvedValue();\r\n      prisma.emailVerificationToken.create.mockResolvedValue({\r\n        id: 'new-token-id',\r\n        userId: 'user-id',\r\n        token: 'new-token',\r\n        expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000)\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/resend-verification')\r\n        .send({ email: 'test@example.com' })\r\n        .expect(200);\r\n\r\n      expect(response.body.message).toBe('Verification email sent successfully');\r\n      expect(emailService.sendVerificationEmail).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should reject already verified user', async () => {\r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'verified@example.com',\r\n        firstName: 'Verified',\r\n        lastName: 'User',\r\n        status: 'ACTIVE',\r\n        emailVerified: new Date()\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/resend-verification')\r\n        .send({ email: 'verified@example.com' })\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Already verified');\r\n    });\r\n\r\n    test('should handle non-existent user', async () => {\r\n      prisma.user.findUnique.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/resend-verification')\r\n        .send({ email: 'nonexistent@example.com' })\r\n        .expect(404);\r\n\r\n      expect(response.body.error).toBe('User not found');\r\n    });\r\n\r\n    test('should implement rate limiting', async () => {\r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'test@example.com',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        status: 'PENDING',\r\n        emailVerificationTokens: [{\r\n          createdAt: new Date(Date.now() - 2 * 60 * 1000), // 2 minutes ago\r\n          expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000)\r\n        }]\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/resend-verification')\r\n        .send({ email: 'test@example.com' })\r\n        .expect(429);\r\n\r\n      expect(response.body.error).toBe('Too many requests');\r\n      expect(response.body.message).toContain('Please wait before requesting');\r\n    });\r\n  });\r\n\r\n  describe('Login with Email Verification Tests', () => {\r\n    test('should reject login for unverified user', async () => {\r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'test@example.com',\r\n        password: '$2a$12$hashedpassword',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        role: 'CUSTOMER',\r\n        status: 'PENDING'\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/login')\r\n        .send({\r\n          email: 'test@example.com',\r\n          password: 'password123'\r\n        })\r\n        .expect(403);\r\n\r\n      expect(response.body.error).toBe('Email not verified');\r\n      expect(response.body.message).toContain('Please verify your email address');\r\n    });\r\n\r\n    test('should allow login for verified user', async () => {\r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'verified@example.com',\r\n        password: '$2a$12$hashedpassword',\r\n        firstName: 'Verified',\r\n        lastName: 'User',\r\n        role: 'CUSTOMER',\r\n        status: 'ACTIVE',\r\n        emailVerified: new Date()\r\n      });\r\n\r\n      prisma.user.update.mockResolvedValue({\r\n        id: 'user-id',\r\n        lastLoginAt: new Date()\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/login')\r\n        .send({\r\n          email: 'verified@example.com',\r\n          password: 'password123'\r\n        })\r\n        .expect(200);\r\n\r\n      expect(response.body.message).toBe('Login successful');\r\n      expect(response.body.user.status).toBe('ACTIVE');\r\n      expect(response.body.token).toBeTruthy();\r\n    });\r\n  });\r\n\r\n  describe('Email Verification Middleware Tests', () => {\r\n    test('should allow access for verified user', async () => {\r\n      const middleware = emailVerificationMiddleware.requireEmailVerification();\r\n      \r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'verified@example.com',\r\n        status: 'ACTIVE',\r\n        emailVerified: new Date()\r\n      });\r\n\r\n      const mockReq = {\r\n        user: { userId: 'user-id', role: 'CUSTOMER' },\r\n        userId: 'user-id',\r\n        ip: '127.0.0.1',\r\n        originalUrl: '/api/protected-route',\r\n        get: jest.fn()\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      await middleware(mockReq, mockRes, mockNext);\r\n\r\n      expect(mockNext).toHaveBeenCalled();\r\n      expect(mockRes.status).not.toHaveBeenCalledWith(403);\r\n    });\r\n\r\n    test('should block access for unverified user', async () => {\r\n      const middleware = emailVerificationMiddleware.requireEmailVerification();\r\n      \r\n      prisma.user.findUnique.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'unverified@example.com',\r\n        status: 'PENDING'\r\n      });\r\n\r\n      const mockReq = {\r\n        user: { userId: 'user-id', role: 'CUSTOMER' },\r\n        userId: 'user-id',\r\n        ip: '127.0.0.1',\r\n        originalUrl: '/api/protected-route',\r\n        get: jest.fn()\r\n      };\r\n\r\n      const mockRes = {\r\n        status: jest.fn().mockReturnThis(),\r\n        json: jest.fn()\r\n      };\r\n\r\n      const mockNext = jest.fn();\r\n\r\n      await middleware(mockReq, mockRes, mockNext);\r\n\r\n      expect(mockNext).not.toHaveBeenCalled();\r\n      expect(mockRes.status).toHaveBeenCalledWith(403);\r\n      expect(mockRes.json).toHaveBeenCalledWith({\r\n        error: 'Email not verified',\r\n        message: 'Please verify your email address to access this resource',\r\n        requiresEmailVerification: true\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Security and Edge Cases', () => {\r\n    test('should handle SQL injection attempts', async () => {\r\n      const userData = {\r\n        email: \"'; DROP TABLE users; --\",\r\n        password: 'Password123!',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Invalid email format');\r\n    });\r\n\r\n    test('should handle XSS attempts', async () => {\r\n      const userData = {\r\n        email: '<script>alert(\"xss\")</script>@example.com',\r\n        password: 'Password123!',\r\n        firstName: 'Test',\r\n        lastName: 'User'\r\n      };\r\n\r\n      const response = await request(app)\r\n        .post('/api/auth/register')\r\n        .send(userData)\r\n        .expect(400);\r\n\r\n      expect(response.body.error).toBe('Invalid email format');\r\n    });\r\n\r\n    test('should prevent token reuse', async () => {\r\n      // First verification succeeds\r\n      prisma.emailVerificationToken.findUnique\r\n        .mockResolvedValueOnce({\r\n          id: 'token-id',\r\n          userId: 'user-id',\r\n          token: 'reusable-token',\r\n          expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000),\r\n          user: {\r\n            id: 'user-id',\r\n            email: 'test@example.com',\r\n            status: 'PENDING'\r\n          }\r\n        })\r\n        .mockResolvedValueOnce(null); // Second call returns null (token not found)\r\n\r\n      prisma.user.update.mockResolvedValue({\r\n        id: 'user-id',\r\n        email: 'test@example.com',\r\n        status: 'ACTIVE',\r\n        emailVerified: new Date()\r\n      });\r\n\r\n      prisma.emailVerificationToken.delete.mockResolvedValue();\r\n\r\n      // First verification should succeed\r\n      const response1 = await request(app)\r\n        .post('/api/auth/verify-email')\r\n        .send({ token: 'reusable-token' })\r\n        .expect(200);\r\n\r\n      expect(response1.body.message).toBe('Email verified successfully');\r\n\r\n      // Second verification with same token should fail\r\n      const response2 = await request(app)\r\n        .post('/api/auth/verify-email')\r\n        .send({ token: 'reusable-token' })\r\n        .expect(400);\r\n\r\n      expect(response2.body.error).toBe('Invalid token');\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}