75815856aa5ae4f16ade1cf5b9ec0ec6
const express = require('express');
const {
  body,
  param,
  query,
  validationResult
} = require('express-validator');
const {
  PrismaClient
} = require('@prisma/client');
const {
  authMiddleware
} = require('../middleware/auth');
const router = express.Router();
const prisma = new PrismaClient();

// Validation middleware
const handleValidationErrors = (req, res, next) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({
      error: 'Validation failed',
      details: errors.array()
    });
  }
  next();
};

// Get all brands
router.get('/', [query('includeInactive').optional().isBoolean(), query('search').optional().isString().trim()], handleValidationErrors, async (req, res) => {
  try {
    const {
      includeInactive = false,
      search
    } = req.query;
    const where = includeInactive ? {} : {
      isActive: true
    };
    if (search) {
      where.OR = [{
        name: {
          contains: search,
          mode: 'insensitive'
        }
      }, {
        description: {
          contains: search,
          mode: 'insensitive'
        }
      }];
    }
    const brands = await prisma.brand.findMany({
      where,
      include: {
        _count: {
          products: true
        }
      },
      orderBy: {
        name: 'asc'
      }
    });
    res.json({
      brands
    });
  } catch (error) {
    console.error('Get brands error:', error);
    res.status(500).json({
      error: 'Failed to fetch brands',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Get brand by ID
router.get('/:id', [param('id').isUUID()], handleValidationErrors, async (req, res) => {
  try {
    const {
      id
    } = req.params;
    const brand = await prisma.brand.findUnique({
      where: {
        id
      },
      include: {
        _count: {
          products: true
        },
        products: {
          where: {
            status: 'ACTIVE'
          },
          take: 10,
          include: {
            images: {
              where: {
                sortOrder: 0
              },
              take: 1,
              select: {
                id: true,
                url: true,
                alt: true
              }
            },
            _count: {
              reviews: true
            }
          },
          orderBy: {
            createdAt: 'desc'
          }
        }
      }
    });
    if (!brand) {
      return res.status(404).json({
        error: 'Brand not found'
      });
    }
    res.json({
      brand
    });
  } catch (error) {
    console.error('Get brand error:', error);
    res.status(500).json({
      error: 'Failed to fetch brand',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Create brand (admin only)
router.post('/', [body('name').notEmpty().trim(), body('slug').isSlug(), body('description').optional().isString(), body('website').optional().isURL(), body('isActive').optional().isBoolean()], handleValidationErrors, authMiddleware.adminOnly(), async (req, res) => {
  try {
    const brandData = req.body;

    // Check if slug already exists
    const existingBrand = await prisma.brand.findUnique({
      where: {
        slug: brandData.slug
      }
    });
    if (existingBrand) {
      return res.status(409).json({
        error: 'Brand with this slug already exists'
      });
    }
    const brand = await prisma.brand.create({
      data: {
        ...brandData,
        isActive: brandData.isActive !== undefined ? brandData.isActive : true
      }
    });
    res.status(201).json({
      message: 'Brand created successfully',
      brand
    });
  } catch (error) {
    console.error('Create brand error:', error);
    res.status(500).json({
      error: 'Failed to create brand',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Update brand (admin only)
router.put('/:id', [param('id').isUUID(), body('name').optional().notEmpty().trim(), body('slug').optional().isSlug(), body('description').optional().isString(), body('website').optional().isURL(), body('isActive').optional().isBoolean()], handleValidationErrors, authMiddleware.adminOnly(), async (req, res) => {
  try {
    const {
      id
    } = req.params;
    const updateData = req.body;

    // Check if brand exists
    const existingBrand = await prisma.brand.findUnique({
      where: {
        id
      }
    });
    if (!existingBrand) {
      return res.status(404).json({
        error: 'Brand not found'
      });
    }

    // Check if slug conflicts with another brand
    if (updateData.slug && updateData.slug !== existingBrand.slug) {
      const slugConflict = await prisma.brand.findFirst({
        where: {
          slug: updateData.slug,
          NOT: {
            id
          }
        }
      });
      if (slugConflict) {
        return res.status(409).json({
          error: 'Brand with this slug already exists'
        });
      }
    }
    const updatedBrand = await prisma.brand.update({
      where: {
        id
      },
      data: updateData
    });
    res.json({
      message: 'Brand updated successfully',
      brand: updatedBrand
    });
  } catch (error) {
    console.error('Update brand error:', error);
    res.status(500).json({
      error: 'Failed to update brand',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Delete brand (admin only)
router.delete('/:id', [param('id').isUUID()], handleValidationErrors, authMiddleware.adminOnly(), async (req, res) => {
  try {
    const {
      id
    } = req.params;

    // Check if brand exists
    const brand = await prisma.brand.findUnique({
      where: {
        id
      },
      include: {
        _count: {
          select: {
            products: true
          }
        }
      }
    });
    if (!brand) {
      return res.status(404).json({
        error: 'Brand not found'
      });
    }

    // Check if brand has products
    if (brand._count.products > 0) {
      return res.status(400).json({
        error: 'Cannot delete brand with existing products',
        suggestion: 'Consider deactivating the brand instead'
      });
    }
    await prisma.brand.delete({
      where: {
        id
      }
    });
    res.json({
      message: 'Brand deleted successfully'
    });
  } catch (error) {
    console.error('Delete brand error:', error);
    res.status(500).json({
      error: 'Failed to delete brand',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJvZHkiLCJwYXJhbSIsInF1ZXJ5IiwidmFsaWRhdGlvblJlc3VsdCIsIlByaXNtYUNsaWVudCIsImF1dGhNaWRkbGV3YXJlIiwicm91dGVyIiwiUm91dGVyIiwicHJpc21hIiwiaGFuZGxlVmFsaWRhdGlvbkVycm9ycyIsInJlcSIsInJlcyIsIm5leHQiLCJlcnJvcnMiLCJpc0VtcHR5Iiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZGV0YWlscyIsImFycmF5IiwiZ2V0Iiwib3B0aW9uYWwiLCJpc0Jvb2xlYW4iLCJpc1N0cmluZyIsInRyaW0iLCJpbmNsdWRlSW5hY3RpdmUiLCJzZWFyY2giLCJ3aGVyZSIsImlzQWN0aXZlIiwiT1IiLCJuYW1lIiwiY29udGFpbnMiLCJtb2RlIiwiZGVzY3JpcHRpb24iLCJicmFuZHMiLCJicmFuZCIsImZpbmRNYW55IiwiaW5jbHVkZSIsIl9jb3VudCIsInByb2R1Y3RzIiwib3JkZXJCeSIsImNvbnNvbGUiLCJtZXNzYWdlIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiaXNVVUlEIiwiaWQiLCJwYXJhbXMiLCJmaW5kVW5pcXVlIiwidGFrZSIsImltYWdlcyIsInNvcnRPcmRlciIsInNlbGVjdCIsInVybCIsImFsdCIsInJldmlld3MiLCJjcmVhdGVkQXQiLCJwb3N0Iiwibm90RW1wdHkiLCJpc1NsdWciLCJpc1VSTCIsImFkbWluT25seSIsImJyYW5kRGF0YSIsImV4aXN0aW5nQnJhbmQiLCJzbHVnIiwiY3JlYXRlIiwiZGF0YSIsInVuZGVmaW5lZCIsInB1dCIsInVwZGF0ZURhdGEiLCJzbHVnQ29uZmxpY3QiLCJmaW5kRmlyc3QiLCJOT1QiLCJ1cGRhdGVkQnJhbmQiLCJ1cGRhdGUiLCJkZWxldGUiLCJzdWdnZXN0aW9uIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImJyYW5kcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCB7IGJvZHksIHBhcmFtLCBxdWVyeSwgdmFsaWRhdGlvblJlc3VsdCB9ID0gcmVxdWlyZSgnZXhwcmVzcy12YWxpZGF0b3InKTtcclxuY29uc3QgeyBQcmlzbWFDbGllbnQgfSA9IHJlcXVpcmUoJ0BwcmlzbWEvY2xpZW50Jyk7XHJcbmNvbnN0IHsgYXV0aE1pZGRsZXdhcmUgfSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvYXV0aCcpO1xyXG5cclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xyXG5cclxuLy8gVmFsaWRhdGlvbiBtaWRkbGV3YXJlXHJcbmNvbnN0IGhhbmRsZVZhbGlkYXRpb25FcnJvcnMgPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICBjb25zdCBlcnJvcnMgPSB2YWxpZGF0aW9uUmVzdWx0KHJlcSk7XHJcbiAgaWYgKCFlcnJvcnMuaXNFbXB0eSgpKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICBlcnJvcjogJ1ZhbGlkYXRpb24gZmFpbGVkJyxcclxuICAgICAgZGV0YWlsczogZXJyb3JzLmFycmF5KClcclxuICAgIH0pO1xyXG4gIH1cclxuICBuZXh0KCk7XHJcbn07XHJcblxyXG4vLyBHZXQgYWxsIGJyYW5kc1xyXG5yb3V0ZXIuZ2V0KCcvJywgW1xyXG4gIHF1ZXJ5KCdpbmNsdWRlSW5hY3RpdmUnKS5vcHRpb25hbCgpLmlzQm9vbGVhbigpLFxyXG4gIHF1ZXJ5KCdzZWFyY2gnKS5vcHRpb25hbCgpLmlzU3RyaW5nKCkudHJpbSgpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGluY2x1ZGVJbmFjdGl2ZSA9IGZhbHNlLCBzZWFyY2ggfSA9IHJlcS5xdWVyeTtcclxuXHJcbiAgICBjb25zdCB3aGVyZSA9IGluY2x1ZGVJbmFjdGl2ZSA/IHt9IDogeyBpc0FjdGl2ZTogdHJ1ZSB9O1xyXG4gICAgXHJcbiAgICBpZiAoc2VhcmNoKSB7XHJcbiAgICAgIHdoZXJlLk9SID0gW1xyXG4gICAgICAgIHsgbmFtZTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9XHJcbiAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYnJhbmRzID0gYXdhaXQgcHJpc21hLmJyYW5kLmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBfY291bnQ6IHtcclxuICAgICAgICAgIHByb2R1Y3RzOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBvcmRlckJ5OiB7IG5hbWU6ICdhc2MnIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJlcy5qc29uKHsgYnJhbmRzIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignR2V0IGJyYW5kcyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGJyYW5kcycsXHJcbiAgICAgIG1lc3NhZ2U6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gR2V0IGJyYW5kIGJ5IElEXHJcbnJvdXRlci5nZXQoJy86aWQnLCBbXHJcbiAgcGFyYW0oJ2lkJykuaXNVVUlEKClcclxuXSwgaGFuZGxlVmFsaWRhdGlvbkVycm9ycywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcblxyXG4gICAgY29uc3QgYnJhbmQgPSBhd2FpdCBwcmlzbWEuYnJhbmQuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBfY291bnQ6IHtcclxuICAgICAgICAgIHByb2R1Y3RzOiB0cnVlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcm9kdWN0czoge1xyXG4gICAgICAgICAgd2hlcmU6IHsgc3RhdHVzOiAnQUNUSVZFJyB9LFxyXG4gICAgICAgICAgdGFrZTogMTAsXHJcbiAgICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICAgIGltYWdlczoge1xyXG4gICAgICAgICAgICAgIHdoZXJlOiB7IHNvcnRPcmRlcjogMCB9LFxyXG4gICAgICAgICAgICAgIHRha2U6IDEsXHJcbiAgICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCB1cmw6IHRydWUsIGFsdDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9jb3VudDoge1xyXG4gICAgICAgICAgICAgIHJldmlld3M6IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCFicmFuZCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgIGVycm9yOiAnQnJhbmQgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXMuanNvbih7IGJyYW5kIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignR2V0IGJyYW5kIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggYnJhbmQnLFxyXG4gICAgICBtZXNzYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVycm9yLm1lc3NhZ2UgOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIENyZWF0ZSBicmFuZCAoYWRtaW4gb25seSlcclxucm91dGVyLnBvc3QoJy8nLCBbXHJcbiAgYm9keSgnbmFtZScpLm5vdEVtcHR5KCkudHJpbSgpLFxyXG4gIGJvZHkoJ3NsdWcnKS5pc1NsdWcoKSxcclxuICBib2R5KCdkZXNjcmlwdGlvbicpLm9wdGlvbmFsKCkuaXNTdHJpbmcoKSxcclxuICBib2R5KCd3ZWJzaXRlJykub3B0aW9uYWwoKS5pc1VSTCgpLFxyXG4gIGJvZHkoJ2lzQWN0aXZlJykub3B0aW9uYWwoKS5pc0Jvb2xlYW4oKVxyXG5dLCBoYW5kbGVWYWxpZGF0aW9uRXJyb3JzLCBhdXRoTWlkZGxld2FyZS5hZG1pbk9ubHkoKSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJyYW5kRGF0YSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHNsdWcgYWxyZWFkeSBleGlzdHNcclxuICAgIGNvbnN0IGV4aXN0aW5nQnJhbmQgPSBhd2FpdCBwcmlzbWEuYnJhbmQuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IHNsdWc6IGJyYW5kRGF0YS5zbHVnIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChleGlzdGluZ0JyYW5kKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwOSkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdCcmFuZCB3aXRoIHRoaXMgc2x1ZyBhbHJlYWR5IGV4aXN0cydcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYnJhbmQgPSBhd2FpdCBwcmlzbWEuYnJhbmQuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIC4uLmJyYW5kRGF0YSxcclxuICAgICAgICBpc0FjdGl2ZTogYnJhbmREYXRhLmlzQWN0aXZlICE9PSB1bmRlZmluZWQgPyBicmFuZERhdGEuaXNBY3RpdmUgOiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcclxuICAgICAgbWVzc2FnZTogJ0JyYW5kIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgICAgYnJhbmRcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignQ3JlYXRlIGJyYW5kIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIGJyYW5kJyxcclxuICAgICAgbWVzc2FnZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5tZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcidcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBVcGRhdGUgYnJhbmQgKGFkbWluIG9ubHkpXHJcbnJvdXRlci5wdXQoJy86aWQnLCBbXHJcbiAgcGFyYW0oJ2lkJykuaXNVVUlEKCksXHJcbiAgYm9keSgnbmFtZScpLm9wdGlvbmFsKCkubm90RW1wdHkoKS50cmltKCksXHJcbiAgYm9keSgnc2x1ZycpLm9wdGlvbmFsKCkuaXNTbHVnKCksXHJcbiAgYm9keSgnZGVzY3JpcHRpb24nKS5vcHRpb25hbCgpLmlzU3RyaW5nKCksXHJcbiAgYm9keSgnd2Vic2l0ZScpLm9wdGlvbmFsKCkuaXNVUkwoKSxcclxuICBib2R5KCdpc0FjdGl2ZScpLm9wdGlvbmFsKCkuaXNCb29sZWFuKClcclxuXSwgaGFuZGxlVmFsaWRhdGlvbkVycm9ycywgYXV0aE1pZGRsZXdhcmUuYWRtaW5Pbmx5KCksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgY29uc3QgdXBkYXRlRGF0YSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIC8vIENoZWNrIGlmIGJyYW5kIGV4aXN0c1xyXG4gICAgY29uc3QgZXhpc3RpbmdCcmFuZCA9IGF3YWl0IHByaXNtYS5icmFuZC5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCFleGlzdGluZ0JyYW5kKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdCcmFuZCBub3QgZm91bmQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHNsdWcgY29uZmxpY3RzIHdpdGggYW5vdGhlciBicmFuZFxyXG4gICAgaWYgKHVwZGF0ZURhdGEuc2x1ZyAmJiB1cGRhdGVEYXRhLnNsdWcgIT09IGV4aXN0aW5nQnJhbmQuc2x1Zykge1xyXG4gICAgICBjb25zdCBzbHVnQ29uZmxpY3QgPSBhd2FpdCBwcmlzbWEuYnJhbmQuZmluZEZpcnN0KHtcclxuICAgICAgICB3aGVyZTogeyBzbHVnOiB1cGRhdGVEYXRhLnNsdWcsIE5PVDogeyBpZCB9IH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoc2x1Z0NvbmZsaWN0KSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA5KS5qc29uKHtcclxuICAgICAgICAgIGVycm9yOiAnQnJhbmQgd2l0aCB0aGlzIHNsdWcgYWxyZWFkeSBleGlzdHMnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1cGRhdGVkQnJhbmQgPSBhd2FpdCBwcmlzbWEuYnJhbmQudXBkYXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgZGF0YTogdXBkYXRlRGF0YVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiAnQnJhbmQgdXBkYXRlZCBzdWNjZXNzZnVsbHknLFxyXG4gICAgICBicmFuZDogdXBkYXRlZEJyYW5kXHJcbiAgICB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1VwZGF0ZSBicmFuZCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSBicmFuZCcsXHJcbiAgICAgIG1lc3NhZ2U6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gRGVsZXRlIGJyYW5kIChhZG1pbiBvbmx5KVxyXG5yb3V0ZXIuZGVsZXRlKCcvOmlkJywgW1xyXG4gIHBhcmFtKCdpZCcpLmlzVVVJRCgpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGF1dGhNaWRkbGV3YXJlLmFkbWluT25seSgpLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuXHJcbiAgICAvLyBDaGVjayBpZiBicmFuZCBleGlzdHNcclxuICAgIGNvbnN0IGJyYW5kID0gYXdhaXQgcHJpc21hLmJyYW5kLmZpbmRVbmlxdWUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgX2NvdW50OiB7XHJcbiAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgcHJvZHVjdHM6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghYnJhbmQpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBlcnJvcjogJ0JyYW5kIG5vdCBmb3VuZCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgYnJhbmQgaGFzIHByb2R1Y3RzXHJcbiAgICBpZiAoYnJhbmQuX2NvdW50LnByb2R1Y3RzID4gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBicmFuZCB3aXRoIGV4aXN0aW5nIHByb2R1Y3RzJyxcclxuICAgICAgICBzdWdnZXN0aW9uOiAnQ29uc2lkZXIgZGVhY3RpdmF0aW5nIHRoZSBicmFuZCBpbnN0ZWFkJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhd2FpdCBwcmlzbWEuYnJhbmQuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiAnQnJhbmQgZGVsZXRlZCBzdWNjZXNzZnVsbHknXHJcbiAgICB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RlbGV0ZSBicmFuZCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGRlbGV0ZSBicmFuZCcsXHJcbiAgICAgIG1lc3NhZ2U6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTTtF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