87e42436e4df52ba6ec4d765682b4343
/* istanbul ignore next */
function cov_2ibzdjuob3() {
  var path = "E:\\Drive D Backup\\Smart Technologies Bangladesh B2C Website Redevelopment\\backend\\services\\smsService.js";
  var hash = "984afaacb4ef9282a115029de64b218776a99c46";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "E:\\Drive D Backup\\Smart Technologies Bangladesh B2C Website Redevelopment\\backend\\services\\smsService.js",
    statementMap: {
      "0": {
        start: {
          line: 1,
          column: 15
        },
        end: {
          line: 1,
          column: 32
        }
      },
      "1": {
        start: {
          line: 2,
          column: 22
        },
        end: {
          line: 2,
          column: 41
        }
      },
      "2": {
        start: {
          line: 3,
          column: 22
        },
        end: {
          line: 3,
          column: 41
        }
      },
      "3": {
        start: {
          line: 4,
          column: 35
        },
        end: {
          line: 4,
          column: 70
        }
      },
      "4": {
        start: {
          line: 8,
          column: 4
        },
        end: {
          line: 8,
          column: 32
        }
      },
      "5": {
        start: {
          line: 9,
          column: 4
        },
        end: {
          line: 9,
          column: 32
        }
      },
      "6": {
        start: {
          line: 10,
          column: 4
        },
        end: {
          line: 10,
          column: 29
        }
      },
      "7": {
        start: {
          line: 11,
          column: 4
        },
        end: {
          line: 11,
          column: 28
        }
      },
      "8": {
        start: {
          line: 15,
          column: 4
        },
        end: {
          line: 28,
          column: 5
        }
      },
      "9": {
        start: {
          line: 16,
          column: 24
        },
        end: {
          line: 16,
          column: 50
        }
      },
      "10": {
        start: {
          line: 18,
          column: 6
        },
        end: {
          line: 21,
          column: 7
        }
      },
      "11": {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 19,
          column: 84
        }
      },
      "12": {
        start: {
          line: 20,
          column: 8
        },
        end: {
          line: 20,
          column: 15
        }
      },
      "13": {
        start: {
          line: 23,
          column: 6
        },
        end: {
          line: 23,
          column: 88
        }
      },
      "14": {
        start: {
          line: 24,
          column: 6
        },
        end: {
          line: 24,
          column: 70
        }
      },
      "15": {
        start: {
          line: 26,
          column: 6
        },
        end: {
          line: 26,
          column: 82
        }
      },
      "16": {
        start: {
          line: 27,
          column: 6
        },
        end: {
          line: 27,
          column: 31
        }
      },
      "17": {
        start: {
          line: 33,
          column: 4
        },
        end: {
          line: 33,
          column: 67
        }
      },
      "18": {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 42,
          column: 6
        }
      },
      "19": {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 112,
          column: 5
        }
      },
      "20": {
        start: {
          line: 48,
          column: 25
        },
        end: {
          line: 48,
          column: 66
        }
      },
      "21": {
        start: {
          line: 49,
          column: 6
        },
        end: {
          line: 56,
          column: 7
        }
      },
      "22": {
        start: {
          line: 50,
          column: 8
        },
        end: {
          line: 55,
          column: 10
        }
      },
      "23": {
        start: {
          line: 58,
          column: 6
        },
        end: {
          line: 74,
          column: 7
        }
      },
      "24": {
        start: {
          line: 60,
          column: 8
        },
        end: {
          line: 64,
          column: 11
        }
      },
      "25": {
        start: {
          line: 66,
          column: 8
        },
        end: {
          line: 73,
          column: 10
        }
      },
      "26": {
        start: {
          line: 76,
          column: 24
        },
        end: {
          line: 76,
          column: 50
        }
      },
      "27": {
        start: {
          line: 77,
          column: 23
        },
        end: {
          line: 77,
          column: 60
        }
      },
      "28": {
        start: {
          line: 79,
          column: 22
        },
        end: {
          line: 83,
          column: 8
        }
      },
      "29": {
        start: {
          line: 85,
          column: 6
        },
        end: {
          line: 90,
          column: 9
        }
      },
      "30": {
        start: {
          line: 92,
          column: 6
        },
        end: {
          line: 98,
          column: 8
        }
      },
      "31": {
        start: {
          line: 101,
          column: 6
        },
        end: {
          line: 105,
          column: 9
        }
      },
      "32": {
        start: {
          line: 107,
          column: 6
        },
        end: {
          line: 111,
          column: 8
        }
      },
      "33": {
        start: {
          line: 117,
          column: 4
        },
        end: {
          line: 182,
          column: 5
        }
      },
      "34": {
        start: {
          line: 118,
          column: 25
        },
        end: {
          line: 118,
          column: 66
        }
      },
      "35": {
        start: {
          line: 119,
          column: 6
        },
        end: {
          line: 126,
          column: 7
        }
      },
      "36": {
        start: {
          line: 120,
          column: 8
        },
        end: {
          line: 125,
          column: 10
        }
      },
      "37": {
        start: {
          line: 128,
          column: 6
        },
        end: {
          line: 144,
          column: 7
        }
      },
      "38": {
        start: {
          line: 130,
          column: 8
        },
        end: {
          line: 134,
          column: 11
        }
      },
      "39": {
        start: {
          line: 136,
          column: 8
        },
        end: {
          line: 143,
          column: 10
        }
      },
      "40": {
        start: {
          line: 146,
          column: 24
        },
        end: {
          line: 146,
          column: 50
        }
      },
      "41": {
        start: {
          line: 148,
          column: 28
        },
        end: {
          line: 153,
          column: 8
        }
      },
      "42": {
        start: {
          line: 155,
          column: 6
        },
        end: {
          line: 160,
          column: 9
        }
      },
      "43": {
        start: {
          line: 162,
          column: 6
        },
        end: {
          line: 168,
          column: 8
        }
      },
      "44": {
        start: {
          line: 171,
          column: 6
        },
        end: {
          line: 175,
          column: 9
        }
      },
      "45": {
        start: {
          line: 177,
          column: 6
        },
        end: {
          line: 181,
          column: 8
        }
      },
      "46": {
        start: {
          line: 187,
          column: 4
        },
        end: {
          line: 216,
          column: 5
        }
      },
      "47": {
        start: {
          line: 188,
          column: 6
        },
        end: {
          line: 193,
          column: 7
        }
      },
      "48": {
        start: {
          line: 189,
          column: 8
        },
        end: {
          line: 192,
          column: 10
        }
      },
      "49": {
        start: {
          line: 195,
          column: 22
        },
        end: {
          line: 195,
          column: 73
        }
      },
      "50": {
        start: {
          line: 197,
          column: 6
        },
        end: {
          line: 205,
          column: 8
        }
      },
      "51": {
        start: {
          line: 208,
          column: 6
        },
        end: {
          line: 210,
          column: 9
        }
      },
      "52": {
        start: {
          line: 212,
          column: 6
        },
        end: {
          line: 215,
          column: 8
        }
      },
      "53": {
        start: {
          line: 221,
          column: 4
        },
        end: {
          line: 221,
          column: 57
        }
      },
      "54": {
        start: {
          line: 226,
          column: 4
        },
        end: {
          line: 226,
          column: 38
        }
      },
      "55": {
        start: {
          line: 231,
          column: 4
        },
        end: {
          line: 231,
          column: 67
        }
      },
      "56": {
        start: {
          line: 236,
          column: 4
        },
        end: {
          line: 236,
          column: 58
        }
      },
      "57": {
        start: {
          line: 241,
          column: 4
        },
        end: {
          line: 241,
          column: 69
        }
      },
      "58": {
        start: {
          line: 246,
          column: 19
        },
        end: {
          line: 246,
          column: 35
        }
      },
      "59": {
        start: {
          line: 248,
          column: 0
        },
        end: {
          line: 251,
          column: 2
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 2
          },
          end: {
            line: 7,
            column: 3
          }
        },
        loc: {
          start: {
            line: 7,
            column: 16
          },
          end: {
            line: 12,
            column: 3
          }
        },
        line: 7
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 14,
            column: 2
          },
          end: {
            line: 14,
            column: 3
          }
        },
        loc: {
          start: {
            line: 14,
            column: 21
          },
          end: {
            line: 29,
            column: 3
          }
        },
        line: 14
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 32,
            column: 2
          },
          end: {
            line: 32,
            column: 3
          }
        },
        loc: {
          start: {
            line: 32,
            column: 39
          },
          end: {
            line: 34,
            column: 3
          }
        },
        line: 32
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 37,
            column: 2
          },
          end: {
            line: 37,
            column: 3
          }
        },
        loc: {
          start: {
            line: 37,
            column: 35
          },
          end: {
            line: 43,
            column: 3
          }
        },
        line: 37
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 46,
            column: 2
          },
          end: {
            line: 46,
            column: 3
          }
        },
        loc: {
          start: {
            line: 46,
            column: 43
          },
          end: {
            line: 113,
            column: 3
          }
        },
        line: 46
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 116,
            column: 2
          },
          end: {
            line: 116,
            column: 3
          }
        },
        loc: {
          start: {
            line: 116,
            column: 46
          },
          end: {
            line: 183,
            column: 3
          }
        },
        line: 116
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 186,
            column: 2
          },
          end: {
            line: 186,
            column: 3
          }
        },
        loc: {
          start: {
            line: 186,
            column: 37
          },
          end: {
            line: 217,
            column: 3
          }
        },
        line: 186
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 220,
            column: 2
          },
          end: {
            line: 220,
            column: 3
          }
        },
        loc: {
          start: {
            line: 220,
            column: 25
          },
          end: {
            line: 222,
            column: 3
          }
        },
        line: 220
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 225,
            column: 2
          },
          end: {
            line: 225,
            column: 3
          }
        },
        loc: {
          start: {
            line: 225,
            column: 16
          },
          end: {
            line: 227,
            column: 3
          }
        },
        line: 225
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 230,
            column: 2
          },
          end: {
            line: 230,
            column: 3
          }
        },
        loc: {
          start: {
            line: 230,
            column: 47
          },
          end: {
            line: 232,
            column: 3
          }
        },
        line: 230
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 235,
            column: 2
          },
          end: {
            line: 235,
            column: 3
          }
        },
        loc: {
          start: {
            line: 235,
            column: 26
          },
          end: {
            line: 237,
            column: 3
          }
        },
        line: 235
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 240,
            column: 2
          },
          end: {
            line: 240,
            column: 3
          }
        },
        loc: {
          start: {
            line: 240,
            column: 37
          },
          end: {
            line: 242,
            column: 3
          }
        },
        line: 240
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 18,
            column: 6
          },
          end: {
            line: 21,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 18,
            column: 6
          },
          end: {
            line: 21,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 18
      },
      "1": {
        loc: {
          start: {
            line: 18,
            column: 10
          },
          end: {
            line: 18,
            column: 99
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 18,
            column: 10
          },
          end: {
            line: 18,
            column: 37
          }
        }, {
          start: {
            line: 18,
            column: 41
          },
          end: {
            line: 18,
            column: 67
          }
        }, {
          start: {
            line: 18,
            column: 71
          },
          end: {
            line: 18,
            column: 99
          }
        }],
        line: 18
      },
      "2": {
        loc: {
          start: {
            line: 46,
            column: 28
          },
          end: {
            line: 46,
            column: 41
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 46,
            column: 39
          },
          end: {
            line: 46,
            column: 41
          }
        }],
        line: 46
      },
      "3": {
        loc: {
          start: {
            line: 49,
            column: 6
          },
          end: {
            line: 56,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 49,
            column: 6
          },
          end: {
            line: 56,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 49
      },
      "4": {
        loc: {
          start: {
            line: 54,
            column: 16
          },
          end: {
            line: 54,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 54,
            column: 16
          },
          end: {
            line: 54,
            column: 31
          }
        }, {
          start: {
            line: 54,
            column: 35
          },
          end: {
            line: 54,
            column: 50
          }
        }],
        line: 54
      },
      "5": {
        loc: {
          start: {
            line: 58,
            column: 6
          },
          end: {
            line: 74,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 58,
            column: 6
          },
          end: {
            line: 74,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 58
      },
      "6": {
        loc: {
          start: {
            line: 110,
            column: 14
          },
          end: {
            line: 110,
            column: 45
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 110,
            column: 14
          },
          end: {
            line: 110,
            column: 24
          }
        }, {
          start: {
            line: 110,
            column: 28
          },
          end: {
            line: 110,
            column: 45
          }
        }],
        line: 110
      },
      "7": {
        loc: {
          start: {
            line: 116,
            column: 32
          },
          end: {
            line: 116,
            column: 44
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 116,
            column: 42
          },
          end: {
            line: 116,
            column: 44
          }
        }],
        line: 116
      },
      "8": {
        loc: {
          start: {
            line: 119,
            column: 6
          },
          end: {
            line: 126,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 119,
            column: 6
          },
          end: {
            line: 126,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 119
      },
      "9": {
        loc: {
          start: {
            line: 124,
            column: 16
          },
          end: {
            line: 124,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 124,
            column: 16
          },
          end: {
            line: 124,
            column: 31
          }
        }, {
          start: {
            line: 124,
            column: 35
          },
          end: {
            line: 124,
            column: 50
          }
        }],
        line: 124
      },
      "10": {
        loc: {
          start: {
            line: 128,
            column: 6
          },
          end: {
            line: 144,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 128,
            column: 6
          },
          end: {
            line: 144,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 128
      },
      "11": {
        loc: {
          start: {
            line: 180,
            column: 14
          },
          end: {
            line: 180,
            column: 45
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 180,
            column: 14
          },
          end: {
            line: 180,
            column: 24
          }
        }, {
          start: {
            line: 180,
            column: 28
          },
          end: {
            line: 180,
            column: 45
          }
        }],
        line: 180
      },
      "12": {
        loc: {
          start: {
            line: 188,
            column: 6
          },
          end: {
            line: 193,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 188,
            column: 6
          },
          end: {
            line: 193,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 188
      },
      "13": {
        loc: {
          start: {
            line: 188,
            column: 10
          },
          end: {
            line: 188,
            column: 42
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 188,
            column: 10
          },
          end: {
            line: 188,
            column: 28
          }
        }, {
          start: {
            line: 188,
            column: 32
          },
          end: {
            line: 188,
            column: 42
          }
        }],
        line: 188
      },
      "14": {
        loc: {
          start: {
            line: 230,
            column: 27
          },
          end: {
            line: 230,
            column: 45
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 230,
            column: 36
          },
          end: {
            line: 230,
            column: 45
          }
        }],
        line: 230
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0, 0],
      "2": [0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "984afaacb4ef9282a115029de64b218776a99c46"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2ibzdjuob3 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2ibzdjuob3();
const twilio =
/* istanbul ignore next */
(cov_2ibzdjuob3().s[0]++, require('twilio'));
const configService =
/* istanbul ignore next */
(cov_2ibzdjuob3().s[1]++, require('./config'));
const loggerService =
/* istanbul ignore next */
(cov_2ibzdjuob3().s[2]++, require('./logger'));
const {
  phoneValidationService
} =
/* istanbul ignore next */
(cov_2ibzdjuob3().s[3]++, require('./phoneValidationService'));
class SMSService {
  constructor() {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[0]++;
    cov_2ibzdjuob3().s[4]++;
    this.config = configService;
    /* istanbul ignore next */
    cov_2ibzdjuob3().s[5]++;
    this.logger = loggerService;
    /* istanbul ignore next */
    cov_2ibzdjuob3().s[6]++;
    this.twilioClient = null;
    /* istanbul ignore next */
    cov_2ibzdjuob3().s[7]++;
    this.initializeTwilio();
  }
  initializeTwilio() {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[1]++;
    cov_2ibzdjuob3().s[8]++;
    try {
      const smsConfig =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[9]++, this.config.getSMSConfig());
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[10]++;
      if (
      /* istanbul ignore next */
      (cov_2ibzdjuob3().b[1][0]++, !smsConfig.twilioAccountSid) ||
      /* istanbul ignore next */
      (cov_2ibzdjuob3().b[1][1]++, !smsConfig.twilioAuthToken) ||
      /* istanbul ignore next */
      (cov_2ibzdjuob3().b[1][2]++, !smsConfig.twilioPhoneNumber)) {
        /* istanbul ignore next */
        cov_2ibzdjuob3().b[0][0]++;
        cov_2ibzdjuob3().s[11]++;
        this.logger.warn('Twilio SMS service not configured - missing credentials');
        /* istanbul ignore next */
        cov_2ibzdjuob3().s[12]++;
        return;
      } else
      /* istanbul ignore next */
      {
        cov_2ibzdjuob3().b[0][1]++;
      }
      cov_2ibzdjuob3().s[13]++;
      this.twilioClient = twilio(smsConfig.twilioAccountSid, smsConfig.twilioAuthToken);
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[14]++;
      this.logger.info('Twilio SMS service initialized successfully');
    } catch (error) {
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[15]++;
      this.logger.error('Failed to initialize Twilio SMS service', error.message);
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[16]++;
      this.twilioClient = null;
    }
  }

  // Validate Bangladesh phone number format (enhanced with centralized service)
  validateBangladeshPhoneNumber(phone) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[2]++;
    cov_2ibzdjuob3().s[17]++;
    return phoneValidationService.validateForUseCase(phone, 'sms');
  }

  // Create OTP SMS template with Bangladesh localization
  createOTPTemplate(otp, userName) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[3]++;
    cov_2ibzdjuob3().s[18]++;
    return {
      text: `Smart Technologies Bangladesh: আপনার OTP কোডটি ${otp}। এটি 5 মিনিটের মধ্যে ব্যবহার করুন। Your OTP is ${otp}. Use within 5 minutes.`,
      textEn: `Smart Technologies Bangladesh: Your OTP is ${otp}. Use within 5 minutes.`,
      textBn: `স্মার্ট টেকনোলজিস বাংলাদেশ: আপনার OTP কোডটি ${otp}। এটি 5 মিনিটের মধ্যে ব্যবহার করুন।`
    };
  }

  // Send OTP via SMS
  async sendOTP(phone, otp, userName =
  /* istanbul ignore next */
  (cov_2ibzdjuob3().b[2][0]++, '')) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[4]++;
    cov_2ibzdjuob3().s[19]++;
    try {
      const validation =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[20]++, this.validateBangladeshPhoneNumber(phone));
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[21]++;
      if (!validation.isValid) {
        /* istanbul ignore next */
        cov_2ibzdjuob3().b[3][0]++;
        cov_2ibzdjuob3().s[22]++;
        return {
          success: false,
          error: validation.error,
          errorBn: validation.errorBn,
          code:
          /* istanbul ignore next */
          (cov_2ibzdjuob3().b[4][0]++, validation.code) ||
          /* istanbul ignore next */
          (cov_2ibzdjuob3().b[4][1]++, 'INVALID_PHONE')
        };
      } else
      /* istanbul ignore next */
      {
        cov_2ibzdjuob3().b[3][1]++;
      }
      cov_2ibzdjuob3().s[23]++;
      if (!this.twilioClient) {
        /* istanbul ignore next */
        cov_2ibzdjuob3().b[5][0]++;
        cov_2ibzdjuob3().s[24]++;
        // Fallback to mock SMS for development
        this.logger.warn('SMS service not available, using mock SMS', {
          phone: validation.normalizedPhone,
          otp,
          timestamp: new Date().toISOString()
        });
        /* istanbul ignore next */
        cov_2ibzdjuob3().s[25]++;
        return {
          success: true,
          messageId: `mock_${Date.now()}`,
          phone: validation.normalizedPhone,
          operator: validation.operator,
          mock: true,
          timestamp: new Date().toISOString()
        };
      } else
      /* istanbul ignore next */
      {
        cov_2ibzdjuob3().b[5][1]++;
      }
      const smsConfig =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[26]++, this.config.getSMSConfig());
      const template =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[27]++, this.createOTPTemplate(otp, userName));
      const message =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[28]++, await this.twilioClient.messages.create({
        body: template.text,
        from: smsConfig.twilioPhoneNumber,
        to: validation.normalizedPhone
      }));
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[29]++;
      this.logger.info('OTP SMS sent successfully', {
        to: validation.normalizedPhone,
        messageId: message.sid,
        operator: validation.operator,
        timestamp: new Date().toISOString()
      });
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[30]++;
      return {
        success: true,
        messageId: message.sid,
        phone: validation.normalizedPhone,
        operator: validation.operator,
        timestamp: new Date().toISOString()
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[31]++;
      this.logger.error('Failed to send OTP SMS', error.message, {
        phone,
        errorType: error.name,
        errorCode: error.code
      });
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[32]++;
      return {
        success: false,
        error: error.message,
        code:
        /* istanbul ignore next */
        (cov_2ibzdjuob3().b[6][0]++, error.code) ||
        /* istanbul ignore next */
        (cov_2ibzdjuob3().b[6][1]++, 'SMS_SEND_FAILED')
      };
    }
  }

  // Send general SMS
  async sendSMS(phone, message, options =
  /* istanbul ignore next */
  (cov_2ibzdjuob3().b[7][0]++, {})) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[5]++;
    cov_2ibzdjuob3().s[33]++;
    try {
      const validation =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[34]++, this.validateBangladeshPhoneNumber(phone));
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[35]++;
      if (!validation.isValid) {
        /* istanbul ignore next */
        cov_2ibzdjuob3().b[8][0]++;
        cov_2ibzdjuob3().s[36]++;
        return {
          success: false,
          error: validation.error,
          errorBn: validation.errorBn,
          code:
          /* istanbul ignore next */
          (cov_2ibzdjuob3().b[9][0]++, validation.code) ||
          /* istanbul ignore next */
          (cov_2ibzdjuob3().b[9][1]++, 'INVALID_PHONE')
        };
      } else
      /* istanbul ignore next */
      {
        cov_2ibzdjuob3().b[8][1]++;
      }
      cov_2ibzdjuob3().s[37]++;
      if (!this.twilioClient) {
        /* istanbul ignore next */
        cov_2ibzdjuob3().b[10][0]++;
        cov_2ibzdjuob3().s[38]++;
        // Fallback to mock SMS for development
        this.logger.warn('SMS service not available, using mock SMS', {
          phone: validation.normalizedPhone,
          message: message.substring(0, 100) + '...',
          timestamp: new Date().toISOString()
        });
        /* istanbul ignore next */
        cov_2ibzdjuob3().s[39]++;
        return {
          success: true,
          messageId: `mock_${Date.now()}`,
          phone: validation.normalizedPhone,
          operator: validation.operator,
          mock: true,
          timestamp: new Date().toISOString()
        };
      } else
      /* istanbul ignore next */
      {
        cov_2ibzdjuob3().b[10][1]++;
      }
      const smsConfig =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[40]++, this.config.getSMSConfig());
      const twilioMessage =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[41]++, await this.twilioClient.messages.create({
        body: message,
        from: smsConfig.twilioPhoneNumber,
        to: validation.normalizedPhone,
        ...options
      }));
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[42]++;
      this.logger.info('SMS sent successfully', {
        to: validation.normalizedPhone,
        messageId: twilioMessage.sid,
        operator: validation.operator,
        timestamp: new Date().toISOString()
      });
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[43]++;
      return {
        success: true,
        messageId: twilioMessage.sid,
        phone: validation.normalizedPhone,
        operator: validation.operator,
        timestamp: new Date().toISOString()
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[44]++;
      this.logger.error('Failed to send SMS', error.message, {
        phone,
        errorType: error.name,
        errorCode: error.code
      });
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[45]++;
      return {
        success: false,
        error: error.message,
        code:
        /* istanbul ignore next */
        (cov_2ibzdjuob3().b[11][0]++, error.code) ||
        /* istanbul ignore next */
        (cov_2ibzdjuob3().b[11][1]++, 'SMS_SEND_FAILED')
      };
    }
  }

  // Check SMS delivery status
  async getDeliveryStatus(messageId) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[6]++;
    cov_2ibzdjuob3().s[46]++;
    try {
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[47]++;
      if (
      /* istanbul ignore next */
      (cov_2ibzdjuob3().b[13][0]++, !this.twilioClient) ||
      /* istanbul ignore next */
      (cov_2ibzdjuob3().b[13][1]++, !messageId)) {
        /* istanbul ignore next */
        cov_2ibzdjuob3().b[12][0]++;
        cov_2ibzdjuob3().s[48]++;
        return {
          success: false,
          error: 'SMS service not available or message ID missing'
        };
      } else
      /* istanbul ignore next */
      {
        cov_2ibzdjuob3().b[12][1]++;
      }
      const message =
      /* istanbul ignore next */
      (cov_2ibzdjuob3().s[49]++, await this.twilioClient.messages(messageId).fetch());
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[50]++;
      return {
        success: true,
        status: message.status,
        errorCode: message.errorCode,
        errorMessage: message.errorMessage,
        dateCreated: message.dateCreated,
        dateSent: message.dateSent,
        dateUpdated: message.dateUpdated
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[51]++;
      this.logger.error('Failed to get SMS delivery status', error.message, {
        messageId
      });
      /* istanbul ignore next */
      cov_2ibzdjuob3().s[52]++;
      return {
        success: false,
        error: error.message
      };
    }
  }

  // Get operator information from phone number
  getOperatorInfo(phone) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[7]++;
    cov_2ibzdjuob3().s[53]++;
    return phoneValidationService.getOperatorInfo(phone);
  }

  // Check if SMS service is available
  isAvailable() {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[8]++;
    cov_2ibzdjuob3().s[54]++;
    return this.twilioClient !== null;
  }

  // Format phone number for display
  formatPhoneNumber(phone, format =
  /* istanbul ignore next */
  (cov_2ibzdjuob3().b[14][0]++, 'display')) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[9]++;
    cov_2ibzdjuob3().s[55]++;
    return phoneValidationService.formatPhoneNumber(phone, format);
  }

  // Get supported operators
  getSupportedOperators() {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[10]++;
    cov_2ibzdjuob3().s[56]++;
    return phoneValidationService.getSupportedOperators();
  }

  // Validate phone number for specific use case
  validateForUseCase(phone, useCase) {
    /* istanbul ignore next */
    cov_2ibzdjuob3().f[11]++;
    cov_2ibzdjuob3().s[57]++;
    return phoneValidationService.validateForUseCase(phone, useCase);
  }
}

// Singleton instance
const smsService =
/* istanbul ignore next */
(cov_2ibzdjuob3().s[58]++, new SMSService());
/* istanbul ignore next */
cov_2ibzdjuob3().s[59]++;
module.exports = {
  SMSService,
  smsService
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmliemRqdW9iMyIsImFjdHVhbENvdmVyYWdlIiwidHdpbGlvIiwicyIsInJlcXVpcmUiLCJjb25maWdTZXJ2aWNlIiwibG9nZ2VyU2VydmljZSIsInBob25lVmFsaWRhdGlvblNlcnZpY2UiLCJTTVNTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJmIiwiY29uZmlnIiwibG9nZ2VyIiwidHdpbGlvQ2xpZW50IiwiaW5pdGlhbGl6ZVR3aWxpbyIsInNtc0NvbmZpZyIsImdldFNNU0NvbmZpZyIsImIiLCJ0d2lsaW9BY2NvdW50U2lkIiwidHdpbGlvQXV0aFRva2VuIiwidHdpbGlvUGhvbmVOdW1iZXIiLCJ3YXJuIiwiaW5mbyIsImVycm9yIiwibWVzc2FnZSIsInZhbGlkYXRlQmFuZ2xhZGVzaFBob25lTnVtYmVyIiwicGhvbmUiLCJ2YWxpZGF0ZUZvclVzZUNhc2UiLCJjcmVhdGVPVFBUZW1wbGF0ZSIsIm90cCIsInVzZXJOYW1lIiwidGV4dCIsInRleHRFbiIsInRleHRCbiIsInNlbmRPVFAiLCJ2YWxpZGF0aW9uIiwiaXNWYWxpZCIsInN1Y2Nlc3MiLCJlcnJvckJuIiwiY29kZSIsIm5vcm1hbGl6ZWRQaG9uZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm1lc3NhZ2VJZCIsIm5vdyIsIm9wZXJhdG9yIiwibW9jayIsInRlbXBsYXRlIiwibWVzc2FnZXMiLCJjcmVhdGUiLCJib2R5IiwiZnJvbSIsInRvIiwic2lkIiwiZXJyb3JUeXBlIiwibmFtZSIsImVycm9yQ29kZSIsInNlbmRTTVMiLCJvcHRpb25zIiwic3Vic3RyaW5nIiwidHdpbGlvTWVzc2FnZSIsImdldERlbGl2ZXJ5U3RhdHVzIiwiZmV0Y2giLCJzdGF0dXMiLCJlcnJvck1lc3NhZ2UiLCJkYXRlQ3JlYXRlZCIsImRhdGVTZW50IiwiZGF0ZVVwZGF0ZWQiLCJnZXRPcGVyYXRvckluZm8iLCJpc0F2YWlsYWJsZSIsImZvcm1hdFBob25lTnVtYmVyIiwiZm9ybWF0IiwiZ2V0U3VwcG9ydGVkT3BlcmF0b3JzIiwidXNlQ2FzZSIsInNtc1NlcnZpY2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsic21zU2VydmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB0d2lsaW8gPSByZXF1aXJlKCd0d2lsaW8nKTtcclxuY29uc3QgY29uZmlnU2VydmljZSA9IHJlcXVpcmUoJy4vY29uZmlnJyk7XHJcbmNvbnN0IGxvZ2dlclNlcnZpY2UgPSByZXF1aXJlKCcuL2xvZ2dlcicpO1xyXG5jb25zdCB7IHBob25lVmFsaWRhdGlvblNlcnZpY2UgfSA9IHJlcXVpcmUoJy4vcGhvbmVWYWxpZGF0aW9uU2VydmljZScpO1xyXG5cclxuY2xhc3MgU01TU2VydmljZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZ1NlcnZpY2U7XHJcbiAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlclNlcnZpY2U7XHJcbiAgICB0aGlzLnR3aWxpb0NsaWVudCA9IG51bGw7XHJcbiAgICB0aGlzLmluaXRpYWxpemVUd2lsaW8oKTtcclxuICB9XHJcblxyXG4gIGluaXRpYWxpemVUd2lsaW8oKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzbXNDb25maWcgPSB0aGlzLmNvbmZpZy5nZXRTTVNDb25maWcoKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghc21zQ29uZmlnLnR3aWxpb0FjY291bnRTaWQgfHwgIXNtc0NvbmZpZy50d2lsaW9BdXRoVG9rZW4gfHwgIXNtc0NvbmZpZy50d2lsaW9QaG9uZU51bWJlcikge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ1R3aWxpbyBTTVMgc2VydmljZSBub3QgY29uZmlndXJlZCAtIG1pc3NpbmcgY3JlZGVudGlhbHMnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMudHdpbGlvQ2xpZW50ID0gdHdpbGlvKHNtc0NvbmZpZy50d2lsaW9BY2NvdW50U2lkLCBzbXNDb25maWcudHdpbGlvQXV0aFRva2VuKTtcclxuICAgICAgdGhpcy5sb2dnZXIuaW5mbygnVHdpbGlvIFNNUyBzZXJ2aWNlIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIFR3aWxpbyBTTVMgc2VydmljZScsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB0aGlzLnR3aWxpb0NsaWVudCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGF0ZSBCYW5nbGFkZXNoIHBob25lIG51bWJlciBmb3JtYXQgKGVuaGFuY2VkIHdpdGggY2VudHJhbGl6ZWQgc2VydmljZSlcclxuICB2YWxpZGF0ZUJhbmdsYWRlc2hQaG9uZU51bWJlcihwaG9uZSkge1xyXG4gICAgcmV0dXJuIHBob25lVmFsaWRhdGlvblNlcnZpY2UudmFsaWRhdGVGb3JVc2VDYXNlKHBob25lLCAnc21zJyk7XHJcbiAgfVxyXG5cclxuICAvLyBDcmVhdGUgT1RQIFNNUyB0ZW1wbGF0ZSB3aXRoIEJhbmdsYWRlc2ggbG9jYWxpemF0aW9uXHJcbiAgY3JlYXRlT1RQVGVtcGxhdGUob3RwLCB1c2VyTmFtZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGV4dDogYFNtYXJ0IFRlY2hub2xvZ2llcyBCYW5nbGFkZXNoOiDgpobgpqrgpqjgpr7gprAgT1RQIOCmleCni+CmoeCmn+CmvyAke290cH3gpaQg4KaP4Kaf4Ka/IDUg4Kau4Ka/4Kao4Ka/4Kaf4KeH4KawIOCmruCmp+CnjeCmr+CnhyDgpqzgp43gpq/gpqzgprngpr7gprAg4KaV4Kaw4KeB4Kao4KWkIFlvdXIgT1RQIGlzICR7b3RwfS4gVXNlIHdpdGhpbiA1IG1pbnV0ZXMuYCxcclxuICAgICAgdGV4dEVuOiBgU21hcnQgVGVjaG5vbG9naWVzIEJhbmdsYWRlc2g6IFlvdXIgT1RQIGlzICR7b3RwfS4gVXNlIHdpdGhpbiA1IG1pbnV0ZXMuYCxcclxuICAgICAgdGV4dEJuOiBg4Ka44KeN4Kau4Ka+4Kaw4KeN4KafIOCmn+Cnh+CmleCmqOCni+CmsuCmnOCmv+CmuCDgpqzgpr7gpoLgprLgpr7gpqbgp4fgprY6IOCmhuCmquCmqOCmvuCmsCBPVFAg4KaV4KeL4Kah4Kaf4Ka/ICR7b3RwfeClpCDgpo/gpp/gpr8gNSDgpq7gpr/gpqjgpr/gpp/gp4fgprAg4Kau4Kan4KeN4Kav4KeHIOCmrOCnjeCmr+CmrOCmueCmvuCmsCDgppXgprDgp4HgpqjgpaRgXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gU2VuZCBPVFAgdmlhIFNNU1xyXG4gIGFzeW5jIHNlbmRPVFAocGhvbmUsIG90cCwgdXNlck5hbWUgPSAnJykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVCYW5nbGFkZXNoUGhvbmVOdW1iZXIocGhvbmUpO1xyXG4gICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiB2YWxpZGF0aW9uLmVycm9yLFxyXG4gICAgICAgICAgZXJyb3JCbjogdmFsaWRhdGlvbi5lcnJvckJuLFxyXG4gICAgICAgICAgY29kZTogdmFsaWRhdGlvbi5jb2RlIHx8ICdJTlZBTElEX1BIT05FJ1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghdGhpcy50d2lsaW9DbGllbnQpIHtcclxuICAgICAgICAvLyBGYWxsYmFjayB0byBtb2NrIFNNUyBmb3IgZGV2ZWxvcG1lbnRcclxuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdTTVMgc2VydmljZSBub3QgYXZhaWxhYmxlLCB1c2luZyBtb2NrIFNNUycsIHtcclxuICAgICAgICAgIHBob25lOiB2YWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZSxcclxuICAgICAgICAgIG90cCxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgbWVzc2FnZUlkOiBgbW9ja18ke0RhdGUubm93KCl9YCxcclxuICAgICAgICAgIHBob25lOiB2YWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZSxcclxuICAgICAgICAgIG9wZXJhdG9yOiB2YWxpZGF0aW9uLm9wZXJhdG9yLFxyXG4gICAgICAgICAgbW9jazogdHJ1ZSxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3Qgc21zQ29uZmlnID0gdGhpcy5jb25maWcuZ2V0U01TQ29uZmlnKCk7XHJcbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy5jcmVhdGVPVFBUZW1wbGF0ZShvdHAsIHVzZXJOYW1lKTtcclxuXHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBhd2FpdCB0aGlzLnR3aWxpb0NsaWVudC5tZXNzYWdlcy5jcmVhdGUoe1xyXG4gICAgICAgIGJvZHk6IHRlbXBsYXRlLnRleHQsXHJcbiAgICAgICAgZnJvbTogc21zQ29uZmlnLnR3aWxpb1Bob25lTnVtYmVyLFxyXG4gICAgICAgIHRvOiB2YWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMubG9nZ2VyLmluZm8oJ09UUCBTTVMgc2VudCBzdWNjZXNzZnVsbHknLCB7XHJcbiAgICAgICAgdG86IHZhbGlkYXRpb24ubm9ybWFsaXplZFBob25lLFxyXG4gICAgICAgIG1lc3NhZ2VJZDogbWVzc2FnZS5zaWQsXHJcbiAgICAgICAgb3BlcmF0b3I6IHZhbGlkYXRpb24ub3BlcmF0b3IsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZUlkOiBtZXNzYWdlLnNpZCxcclxuICAgICAgICBwaG9uZTogdmFsaWRhdGlvbi5ub3JtYWxpemVkUGhvbmUsXHJcbiAgICAgICAgb3BlcmF0b3I6IHZhbGlkYXRpb24ub3BlcmF0b3IsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHNlbmQgT1RQIFNNUycsIGVycm9yLm1lc3NhZ2UsIHtcclxuICAgICAgICBwaG9uZSxcclxuICAgICAgICBlcnJvclR5cGU6IGVycm9yLm5hbWUsXHJcbiAgICAgICAgZXJyb3JDb2RlOiBlcnJvci5jb2RlXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICBjb2RlOiBlcnJvci5jb2RlIHx8ICdTTVNfU0VORF9GQUlMRUQnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBTZW5kIGdlbmVyYWwgU01TXHJcbiAgYXN5bmMgc2VuZFNNUyhwaG9uZSwgbWVzc2FnZSwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUJhbmdsYWRlc2hQaG9uZU51bWJlcihwaG9uZSk7XHJcbiAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IsXHJcbiAgICAgICAgICBlcnJvckJuOiB2YWxpZGF0aW9uLmVycm9yQm4sXHJcbiAgICAgICAgICBjb2RlOiB2YWxpZGF0aW9uLmNvZGUgfHwgJ0lOVkFMSURfUEhPTkUnXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCF0aGlzLnR3aWxpb0NsaWVudCkge1xyXG4gICAgICAgIC8vIEZhbGxiYWNrIHRvIG1vY2sgU01TIGZvciBkZXZlbG9wbWVudFxyXG4gICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ1NNUyBzZXJ2aWNlIG5vdCBhdmFpbGFibGUsIHVzaW5nIG1vY2sgU01TJywge1xyXG4gICAgICAgICAgcGhvbmU6IHZhbGlkYXRpb24ubm9ybWFsaXplZFBob25lLFxyXG4gICAgICAgICAgbWVzc2FnZTogbWVzc2FnZS5zdWJzdHJpbmcoMCwgMTAwKSArICcuLi4nLFxyXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICBtZXNzYWdlSWQ6IGBtb2NrXyR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICAgICAgcGhvbmU6IHZhbGlkYXRpb24ubm9ybWFsaXplZFBob25lLFxyXG4gICAgICAgICAgb3BlcmF0b3I6IHZhbGlkYXRpb24ub3BlcmF0b3IsXHJcbiAgICAgICAgICBtb2NrOiB0cnVlLFxyXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBzbXNDb25maWcgPSB0aGlzLmNvbmZpZy5nZXRTTVNDb25maWcoKTtcclxuXHJcbiAgICAgIGNvbnN0IHR3aWxpb01lc3NhZ2UgPSBhd2FpdCB0aGlzLnR3aWxpb0NsaWVudC5tZXNzYWdlcy5jcmVhdGUoe1xyXG4gICAgICAgIGJvZHk6IG1lc3NhZ2UsXHJcbiAgICAgICAgZnJvbTogc21zQ29uZmlnLnR3aWxpb1Bob25lTnVtYmVyLFxyXG4gICAgICAgIHRvOiB2YWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZSxcclxuICAgICAgICAuLi5vcHRpb25zXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGhpcy5sb2dnZXIuaW5mbygnU01TIHNlbnQgc3VjY2Vzc2Z1bGx5Jywge1xyXG4gICAgICAgIHRvOiB2YWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZSxcclxuICAgICAgICBtZXNzYWdlSWQ6IHR3aWxpb01lc3NhZ2Uuc2lkLFxyXG4gICAgICAgIG9wZXJhdG9yOiB2YWxpZGF0aW9uLm9wZXJhdG9yLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIG1lc3NhZ2VJZDogdHdpbGlvTWVzc2FnZS5zaWQsXHJcbiAgICAgICAgcGhvbmU6IHZhbGlkYXRpb24ubm9ybWFsaXplZFBob25lLFxyXG4gICAgICAgIG9wZXJhdG9yOiB2YWxpZGF0aW9uLm9wZXJhdG9yLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH07XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBzZW5kIFNNUycsIGVycm9yLm1lc3NhZ2UsIHtcclxuICAgICAgICBwaG9uZSxcclxuICAgICAgICBlcnJvclR5cGU6IGVycm9yLm5hbWUsXHJcbiAgICAgICAgZXJyb3JDb2RlOiBlcnJvci5jb2RlXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICBjb2RlOiBlcnJvci5jb2RlIHx8ICdTTVNfU0VORF9GQUlMRUQnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBTTVMgZGVsaXZlcnkgc3RhdHVzXHJcbiAgYXN5bmMgZ2V0RGVsaXZlcnlTdGF0dXMobWVzc2FnZUlkKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIXRoaXMudHdpbGlvQ2xpZW50IHx8ICFtZXNzYWdlSWQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ1NNUyBzZXJ2aWNlIG5vdCBhdmFpbGFibGUgb3IgbWVzc2FnZSBJRCBtaXNzaW5nJ1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBhd2FpdCB0aGlzLnR3aWxpb0NsaWVudC5tZXNzYWdlcyhtZXNzYWdlSWQpLmZldGNoKCk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgc3RhdHVzOiBtZXNzYWdlLnN0YXR1cyxcclxuICAgICAgICBlcnJvckNvZGU6IG1lc3NhZ2UuZXJyb3JDb2RlLFxyXG4gICAgICAgIGVycm9yTWVzc2FnZTogbWVzc2FnZS5lcnJvck1lc3NhZ2UsXHJcbiAgICAgICAgZGF0ZUNyZWF0ZWQ6IG1lc3NhZ2UuZGF0ZUNyZWF0ZWQsXHJcbiAgICAgICAgZGF0ZVNlbnQ6IG1lc3NhZ2UuZGF0ZVNlbnQsXHJcbiAgICAgICAgZGF0ZVVwZGF0ZWQ6IG1lc3NhZ2UuZGF0ZVVwZGF0ZWRcclxuICAgICAgfTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBTTVMgZGVsaXZlcnkgc3RhdHVzJywgZXJyb3IubWVzc2FnZSwge1xyXG4gICAgICAgIG1lc3NhZ2VJZFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEdldCBvcGVyYXRvciBpbmZvcm1hdGlvbiBmcm9tIHBob25lIG51bWJlclxyXG4gIGdldE9wZXJhdG9ySW5mbyhwaG9uZSkge1xyXG4gICAgcmV0dXJuIHBob25lVmFsaWRhdGlvblNlcnZpY2UuZ2V0T3BlcmF0b3JJbmZvKHBob25lKTtcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIFNNUyBzZXJ2aWNlIGlzIGF2YWlsYWJsZVxyXG4gIGlzQXZhaWxhYmxlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMudHdpbGlvQ2xpZW50ICE9PSBudWxsO1xyXG4gIH1cclxuXHJcbiAgLy8gRm9ybWF0IHBob25lIG51bWJlciBmb3IgZGlzcGxheVxyXG4gIGZvcm1hdFBob25lTnVtYmVyKHBob25lLCBmb3JtYXQgPSAnZGlzcGxheScpIHtcclxuICAgIHJldHVybiBwaG9uZVZhbGlkYXRpb25TZXJ2aWNlLmZvcm1hdFBob25lTnVtYmVyKHBob25lLCBmb3JtYXQpO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHN1cHBvcnRlZCBvcGVyYXRvcnNcclxuICBnZXRTdXBwb3J0ZWRPcGVyYXRvcnMoKSB7XHJcbiAgICByZXR1cm4gcGhvbmVWYWxpZGF0aW9uU2VydmljZS5nZXRTdXBwb3J0ZWRPcGVyYXRvcnMoKTtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXRlIHBob25lIG51bWJlciBmb3Igc3BlY2lmaWMgdXNlIGNhc2VcclxuICB2YWxpZGF0ZUZvclVzZUNhc2UocGhvbmUsIHVzZUNhc2UpIHtcclxuICAgIHJldHVybiBwaG9uZVZhbGlkYXRpb25TZXJ2aWNlLnZhbGlkYXRlRm9yVXNlQ2FzZShwaG9uZSwgdXNlQ2FzZSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBTaW5nbGV0b24gaW5zdGFuY2VcclxuY29uc3Qgc21zU2VydmljZSA9IG5ldyBTTVNTZXJ2aWNlKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBTTVNTZXJ2aWNlLFxyXG4gIHNtc1NlcnZpY2VcclxufTsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBZVk7SUFBQUEsY0FBQSxZQUFBQSxDQUFBO01BQUEsT0FBQUMsY0FBQTtJQUFBO0VBQUE7RUFBQSxPQUFBQSxjQUFBO0FBQUE7QUFBQUQsY0FBQTtBQWZaLE1BQU1FLE1BQU07QUFBQTtBQUFBLENBQUFGLGNBQUEsR0FBQUcsQ0FBQSxPQUFHQyxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1DLGFBQWE7QUFBQTtBQUFBLENBQUFMLGNBQUEsR0FBQUcsQ0FBQSxPQUFHQyxPQUFPLENBQUMs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