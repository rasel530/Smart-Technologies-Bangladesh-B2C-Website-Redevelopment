{"version":3,"names":["cov_1ipr9qwvop","actualCoverage","speakeasy","s","require","crypto","PrismaClient","smsService","configService","loggerService","phoneValidationService","OTPService","constructor","f","config","logger","prisma","OTP_LENGTH","OTP_EXPIRY_MINUTES","MAX_ATTEMPTS_PER_HOUR","MAX_VERIFICATION_ATTEMPTS","generateOTP","totp","secret","randomBytes","toString","encoding","digits","time","Math","floor","Date","now","generatePhoneOTP","phone","userId","b","phoneValidation","validateForUseCase","isValid","success","error","errorBn","code","normalizedPhone","recentOTPs","phoneOTP","findMany","where","createdAt","gte","length","logSecurity","attemptCount","timeWindow","retryAfter","deleteMany","verifiedAt","expiresAt","gt","otp","create","data","smsResult","sendOTP","delete","id","details","info","phoneOTPId","operator","operatorDetails","messageId","message","messageBn","mock","verifyPhoneOTP","findFirst","orderBy","providedOTP","timestamp","toISOString","attempts","update","user","phoneVerified","status","resendPhoneOTP","recentOTP","timeSinceLastOTP","getTime","waitTime","ceil","cleanupExpiredOTPs","deletedCount","lt","count","getOTPStats","timeRange","timeFilter","stats","groupBy","by","_count","totalOTPs","reduce","sum","stat","verifiedOTPs","filter","unverifiedOTPs","isPhoneVerified","not","getPhoneValidationInfo","validateBangladeshPhoneNumber","formatPhoneNumber","format","otpService","module","exports"],"sources":["otpService.js"],"sourcesContent":["const speakeasy = require('speakeasy');\r\nconst crypto = require('crypto');\r\nconst { PrismaClient } = require('@prisma/client');\r\nconst { smsService } = require('./smsService');\r\nconst configService = require('./config');\r\nconst loggerService = require('./logger');\r\nconst { phoneValidationService } = require('./phoneValidationService');\r\n\r\nclass OTPService {\r\n  constructor() {\r\n    this.config = configService;\r\n    this.logger = loggerService;\r\n    this.prisma = new PrismaClient();\r\n    this.OTP_LENGTH = 6;\r\n    this.OTP_EXPIRY_MINUTES = 5;\r\n    this.MAX_ATTEMPTS_PER_HOUR = 3;\r\n    this.MAX_VERIFICATION_ATTEMPTS = 3;\r\n  }\r\n\r\n  // Generate secure 6-digit OTP\r\n  generateOTP() {\r\n    return speakeasy.totp({\r\n      secret: crypto.randomBytes(32).toString('hex'),\r\n      encoding: 'base32',\r\n      digits: this.OTP_LENGTH,\r\n      time: Math.floor(Date.now() / 1000)\r\n    });\r\n  }\r\n\r\n  // Generate OTP for phone number\r\n  async generatePhoneOTP(phone, userId = null) {\r\n    try {\r\n      // Validate phone number with enhanced service\r\n      const phoneValidation = phoneValidationService.validateForUseCase(phone, 'otp');\r\n      if (!phoneValidation.isValid) {\r\n        return {\r\n          success: false,\r\n          error: phoneValidation.error,\r\n          errorBn: phoneValidation.errorBn,\r\n          code: phoneValidation.code || 'INVALID_PHONE'\r\n        };\r\n      }\r\n\r\n      const normalizedPhone = phoneValidation.normalizedPhone;\r\n\r\n      // Check rate limiting - max 3 OTPs per hour per phone\r\n      const recentOTPs = await this.prisma.phoneOTP.findMany({\r\n        where: {\r\n          phone: normalizedPhone,\r\n          createdAt: {\r\n            gte: new Date(Date.now() - 60 * 60 * 1000) // Last hour\r\n          }\r\n        }\r\n      });\r\n\r\n      if (recentOTPs.length >= this.MAX_ATTEMPTS_PER_HOUR) {\r\n        this.logger.logSecurity('OTP Rate Limit Exceeded', userId || 'anonymous', {\r\n          phone: normalizedPhone,\r\n          attemptCount: recentOTPs.length,\r\n          timeWindow: '1 hour'\r\n        });\r\n\r\n        return {\r\n          success: false,\r\n          error: 'Too many OTP requests. Please try again later.',\r\n          errorBn: 'অত্যাধিক OTP অনুরোধ। অনুগ্রহ পরে চেষ্টা করুন।',\r\n          code: 'RATE_LIMIT_EXCEEDED',\r\n          retryAfter: 60 * 60 // seconds\r\n        };\r\n      }\r\n\r\n      // Delete any existing unverified OTPs for this phone\r\n      await this.prisma.phoneOTP.deleteMany({\r\n        where: {\r\n          phone: normalizedPhone,\r\n          verifiedAt: null,\r\n          expiresAt: {\r\n            gt: new Date()\r\n          }\r\n        }\r\n      });\r\n\r\n      // Generate new OTP\r\n      const otp = this.generateOTP();\r\n      const expiresAt = new Date(Date.now() + this.OTP_EXPIRY_MINUTES * 60 * 1000);\r\n\r\n      // Save OTP to database\r\n      const phoneOTP = await this.prisma.phoneOTP.create({\r\n        data: {\r\n          userId,\r\n          phone: normalizedPhone,\r\n          otp,\r\n          expiresAt\r\n        }\r\n      });\r\n\r\n      // Send OTP via SMS\r\n      const smsResult = await smsService.sendOTP(normalizedPhone, otp);\r\n\r\n      if (!smsResult.success) {\r\n        // Delete OTP if SMS failed\r\n        await this.prisma.phoneOTP.delete({\r\n          where: { id: phoneOTP.id }\r\n        });\r\n\r\n        return {\r\n          success: false,\r\n          error: 'Failed to send OTP via SMS',\r\n          errorBn: 'SMS এর মাধ্যমে OTP পাঠানো ব্যর্থ হয়েছে',\r\n          details: smsResult.error,\r\n          code: 'SMS_SEND_FAILED'\r\n        };\r\n      }\r\n\r\n      this.logger.info('OTP generated and sent successfully', {\r\n        phoneOTPId: phoneOTP.id,\r\n        phone: normalizedPhone,\r\n        operator: phoneValidation.operator,\r\n        operatorDetails: phoneValidation.operatorDetails,\r\n        messageId: smsResult.messageId,\r\n        expiresAt,\r\n        userId\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        phoneOTPId: phoneOTP.id,\r\n        phone: normalizedPhone,\r\n        operator: phoneValidation.operator,\r\n        operatorDetails: phoneValidation.operatorDetails,\r\n        expiresAt,\r\n        message: 'OTP sent successfully',\r\n        messageBn: 'OTP সফলভভাবে পাঠানো হয়েছে',\r\n        mock: smsResult.mock || false\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to generate phone OTP', error.message, {\r\n        phone,\r\n        userId\r\n      });\r\n\r\n      return {\r\n        success: false,\r\n        error: 'Failed to generate OTP',\r\n        errorBn: 'OTP জেনারেট করতে ব্যর্থ হয়েছে',\r\n        code: 'GENERATION_FAILED'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Verify OTP\r\n  async verifyPhoneOTP(phone, otp, userId = null) {\r\n    try {\r\n      // Validate phone number with enhanced service\r\n      const phoneValidation = phoneValidationService.validateForUseCase(phone, 'otp');\r\n      if (!phoneValidation.isValid) {\r\n        return {\r\n          success: false,\r\n          error: phoneValidation.error,\r\n          errorBn: phoneValidation.errorBn,\r\n          code: phoneValidation.code || 'INVALID_PHONE'\r\n        };\r\n      }\r\n\r\n      const normalizedPhone = phoneValidation.normalizedPhone;\r\n\r\n      // Find valid OTP\r\n      const phoneOTP = await this.prisma.phoneOTP.findFirst({\r\n        where: {\r\n          phone: normalizedPhone,\r\n          otp,\r\n          verifiedAt: null,\r\n          expiresAt: {\r\n            gt: new Date()\r\n          }\r\n        },\r\n        orderBy: {\r\n          createdAt: 'desc'\r\n        }\r\n      });\r\n\r\n      if (!phoneOTP) {\r\n        this.logger.logSecurity('Invalid OTP Verification Attempt', userId || 'anonymous', {\r\n          phone: normalizedPhone,\r\n          providedOTP: otp,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n\r\n        return {\r\n          success: false,\r\n          error: 'Invalid or expired OTP',\r\n          errorBn: 'অবৈধ বা মেয়ে উত্তীর্ণ OTP',\r\n          code: 'INVALID_OTP'\r\n        };\r\n      }\r\n\r\n      // Check verification attempts\r\n      if (phoneOTP.attempts && phoneOTP.attempts >= this.MAX_VERIFICATION_ATTEMPTS) {\r\n        this.logger.logSecurity('OTP Max Attempts Exceeded', userId || 'anonymous', {\r\n          phoneOTPId: phoneOTP.id,\r\n          phone: normalizedPhone,\r\n          attempts: phoneOTP.attempts\r\n        });\r\n\r\n        return {\r\n          success: false,\r\n          error: 'Maximum verification attempts exceeded. Please request a new OTP.',\r\n          errorBn: 'সর্বাধিক যাচাই প্রচেষ্টা অতিক্রম। অনুগ্রহ নতুন OTP অনুরোধ করুন।',\r\n          code: 'MAX_ATTEMPTS_EXCEEDED'\r\n        };\r\n      }\r\n\r\n      // Increment attempt counter\r\n      await this.prisma.phoneOTP.update({\r\n        where: { id: phoneOTP.id },\r\n        data: {\r\n          attempts: (phoneOTP.attempts || 0) + 1\r\n        }\r\n      });\r\n\r\n      // Mark OTP as verified\r\n      await this.prisma.phoneOTP.update({\r\n        where: { id: phoneOTP.id },\r\n        data: {\r\n          verifiedAt: new Date()\r\n        }\r\n      });\r\n\r\n      // Update user phone verification status if userId is provided\r\n      if (phoneOTP.userId) {\r\n        await this.prisma.user.update({\r\n          where: { id: phoneOTP.userId },\r\n          data: {\r\n            phoneVerified: new Date(),\r\n            status: 'ACTIVE'\r\n          }\r\n        });\r\n      }\r\n\r\n      this.logger.info('OTP verified successfully', {\r\n        phoneOTPId: phoneOTP.id,\r\n        phone: normalizedPhone,\r\n        userId: phoneOTP.userId,\r\n        verifiedAt: new Date().toISOString()\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        message: 'OTP verified successfully',\r\n        messageBn: 'OTP সফলভভাবে যাচাই হয়েছে',\r\n        phone: normalizedPhone,\r\n        userId: phoneOTP.userId,\r\n        verifiedAt: new Date()\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to verify phone OTP', error.message, {\r\n        phone,\r\n        otp,\r\n        userId\r\n      });\r\n\r\n      return {\r\n        success: false,\r\n        error: 'Failed to verify OTP',\r\n        errorBn: 'OTP যাচাই করতে ব্যর্থ হয়েছে',\r\n        code: 'VERIFICATION_FAILED'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Resend OTP\r\n  async resendPhoneOTP(phone, userId = null) {\r\n    try {\r\n      // Validate phone number with enhanced service\r\n      const phoneValidation = phoneValidationService.validateForUseCase(phone, 'otp');\r\n      if (!phoneValidation.isValid) {\r\n        return {\r\n          success: false,\r\n          error: phoneValidation.error,\r\n          errorBn: phoneValidation.errorBn,\r\n          code: phoneValidation.code || 'INVALID_PHONE'\r\n        };\r\n      }\r\n\r\n      const normalizedPhone = phoneValidation.normalizedPhone;\r\n\r\n      // Check for recent OTP (within 2 minutes)\r\n      const recentOTP = await this.prisma.phoneOTP.findFirst({\r\n        where: {\r\n          phone: normalizedPhone,\r\n          verifiedAt: null,\r\n          expiresAt: {\r\n            gt: new Date()\r\n          },\r\n          createdAt: {\r\n            gte: new Date(Date.now() - 2 * 60 * 1000) // Last 2 minutes\r\n          }\r\n        },\r\n        orderBy: {\r\n          createdAt: 'desc'\r\n        }\r\n      });\r\n\r\n      if (recentOTP) {\r\n        const timeSinceLastOTP = Date.now() - recentOTP.createdAt.getTime();\r\n        const waitTime = Math.ceil((2 * 60 * 1000 - timeSinceLastOTP) / 1000);\r\n\r\n        return {\r\n          success: false,\r\n          error: `Please wait ${waitTime} seconds before requesting another OTP`,\r\n          errorBn: `অন্য OTP অনুরোধ করার জন্য ${waitTime} সেকেন্ড অপেক্ষা করুন`,\r\n          code: 'RESEND_TOO_SOON',\r\n          waitTime\r\n        };\r\n      }\r\n\r\n      // Generate new OTP\r\n      return await this.generatePhoneOTP(normalizedPhone, userId);\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to resend phone OTP', error.message, {\r\n        phone,\r\n        userId\r\n      });\r\n\r\n      return {\r\n        success: false,\r\n        error: 'Failed to resend OTP',\r\n        errorBn: 'OTP পুনরায় পাঠানো ব্যর্থ হয়েছে',\r\n        code: 'RESEND_FAILED'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Clean up expired OTPs\r\n  async cleanupExpiredOTPs() {\r\n    try {\r\n      const deletedCount = await this.prisma.phoneOTP.deleteMany({\r\n        where: {\r\n          expiresAt: {\r\n            lt: new Date()\r\n          }\r\n        }\r\n      });\r\n\r\n      if (deletedCount.count > 0) {\r\n        this.logger.info('Cleaned up expired OTPs', {\r\n          deletedCount: deletedCount.count\r\n        });\r\n      }\r\n\r\n      return deletedCount.count;\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to cleanup expired OTPs', error.message);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  // Get OTP statistics\r\n  async getOTPStats(phone, timeRange = '24h') {\r\n    try {\r\n      const phoneValidation = phoneValidationService.validateForUseCase(phone, 'otp');\r\n      if (!phoneValidation.isValid) {\r\n        return null;\r\n      }\r\n\r\n      const normalizedPhone = phoneValidation.normalizedPhone;\r\n      let timeFilter;\r\n\r\n      switch (timeRange) {\r\n        case '1h':\r\n          timeFilter = new Date(Date.now() - 60 * 60 * 1000);\r\n          break;\r\n        case '24h':\r\n          timeFilter = new Date(Date.now() - 24 * 60 * 60 * 1000);\r\n          break;\r\n        case '7d':\r\n          timeFilter = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\r\n          break;\r\n        default:\r\n          timeFilter = new Date(Date.now() - 24 * 60 * 60 * 1000);\r\n      }\r\n\r\n      const stats = await this.prisma.phoneOTP.groupBy({\r\n        by: ['verifiedAt'],\r\n        where: {\r\n          phone: normalizedPhone,\r\n          createdAt: {\r\n            gte: timeFilter\r\n          }\r\n        },\r\n        _count: {\r\n          id: true\r\n        }\r\n      });\r\n\r\n      return {\r\n        phone: normalizedPhone,\r\n        timeRange,\r\n        totalOTPs: stats.reduce((sum, stat) => sum + stat._count.id, 0),\r\n        verifiedOTPs: stats.filter(stat => stat.verifiedAt !== null).length,\r\n        unverifiedOTPs: stats.filter(stat => stat.verifiedAt === null).length\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to get OTP stats', error.message, {\r\n        phone,\r\n        timeRange\r\n      });\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Check if phone is already verified\r\n  async isPhoneVerified(phone) {\r\n    try {\r\n      const phoneValidation = phoneValidationService.validateForUseCase(phone, 'verification');\r\n      if (!phoneValidation.isValid) {\r\n        return false;\r\n      }\r\n\r\n      const user = await this.prisma.user.findFirst({\r\n        where: {\r\n          phone: phoneValidation.normalizedPhone,\r\n          phoneVerified: {\r\n            not: null\r\n          }\r\n        }\r\n      });\r\n\r\n      return !!user;\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to check phone verification status', error.message, {\r\n        phone\r\n      });\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Get phone validation info\r\n  getPhoneValidationInfo(phone) {\r\n    return phoneValidationService.validateBangladeshPhoneNumber(phone);\r\n  }\r\n\r\n  // Format phone number for display\r\n  formatPhoneNumber(phone, format = 'display') {\r\n    return phoneValidationService.formatPhoneNumber(phone, format);\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst otpService = new OTPService();\r\n\r\nmodule.exports = {\r\n  OTPService,\r\n  otpService\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}