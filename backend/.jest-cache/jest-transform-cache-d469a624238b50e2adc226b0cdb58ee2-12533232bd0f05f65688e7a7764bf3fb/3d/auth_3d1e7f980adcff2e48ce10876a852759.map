{"version":3,"names":["cov_1ds5ui4vtd","actualCoverage","express","s","require","body","validationResult","bcrypt","jwt","PrismaClient","router","Router","prisma","handleValidationErrors","req","res","next","f","errors","isEmpty","b","status","json","error","details","array","post","isEmail","normalizeEmail","isLength","min","notEmpty","trim","optional","isMobilePhone","email","password","firstName","lastName","phone","existingUser","user","findFirst","where","OR","field","securityConfig","configService","getSecurityConfig","hashedPassword","hash","bcryptRounds","create","data","role","select","id","createdAt","jwtSecretRegister","process","env","JWT_SECRET","Error","token","sign","userId","expiresIn","message","console","NODE_ENV","findUnique","isValidPassword","compare","update","lastLoginAt","Date","jwtSecretLogin","jwtSecretRefresh","decoded","verify","jwtSecretNew","newToken","module","exports"],"sources":["auth.js"],"sourcesContent":["const express = require('express');\r\nconst { body, validationResult } = require('express-validator');\r\nconst bcrypt = require('bcryptjs');\r\nconst jwt = require('jsonwebtoken');\r\nconst { PrismaClient } = require('@prisma/client');\r\n\r\nconst router = express.Router();\r\nconst prisma = new PrismaClient();\r\n\r\n// Validation middleware\r\nconst handleValidationErrors = (req, res, next) => {\r\n  const errors = validationResult(req);\r\n  if (!errors.isEmpty()) {\r\n    return res.status(400).json({\r\n      error: 'Validation failed',\r\n      details: errors.array()\r\n    });\r\n  }\r\n  next();\r\n};\r\n\r\n// Register endpoint\r\nrouter.post('/register', [\r\n  body('email').isEmail().normalizeEmail(),\r\n  body('password').isLength({ min: 6 }),\r\n  body('firstName').notEmpty().trim(),\r\n  body('lastName').notEmpty().trim(),\r\n  body('phone').optional().isMobilePhone('any')\r\n], handleValidationErrors, async (req, res) => {\r\n  try {\r\n    const { email, password, firstName, lastName, phone } = req.body;\r\n\r\n    // Check if user already exists\r\n    const existingUser = await prisma.user.findFirst({\r\n      where: {\r\n        OR: [\r\n          { email },\r\n          ...(phone ? [{ phone }] : [])\r\n        ]\r\n      }\r\n    });\r\n\r\n    if (existingUser) {\r\n      return res.status(409).json({\r\n        error: 'User already exists',\r\n        field: existingUser.email === email ? 'email' : 'phone'\r\n      });\r\n    }\r\n\r\n    // Hash password\r\n    const securityConfig = require('../services/config').configService.getSecurityConfig();\r\n    const hashedPassword = await bcrypt.hash(password, securityConfig.bcryptRounds);\r\n\r\n    // Create user\r\n    const user = await prisma.user.create({\r\n      data: {\r\n        email,\r\n        password: hashedPassword,\r\n        firstName,\r\n        lastName,\r\n        phone,\r\n        role: 'CUSTOMER'\r\n      },\r\n      select: {\r\n        id: true,\r\n        email: true,\r\n        firstName: true,\r\n        lastName: true,\r\n        phone: true,\r\n        role: true,\r\n        status: true,\r\n        createdAt: true\r\n      }\r\n    });\r\n\r\n    // Generate JWT token\r\n    const jwtSecretRegister = process.env.JWT_SECRET;\r\n    if (!jwtSecretRegister) {\r\n      throw new Error('JWT_SECRET environment variable is required');\r\n    }\r\n    \r\n    const token = jwt.sign(\r\n      { userId: user.id, email: user.email, role: user.role },\r\n      jwtSecretRegister,\r\n      { expiresIn: '7d' }\r\n    );\r\n\r\n    res.status(201).json({\r\n      message: 'User registered successfully',\r\n      user,\r\n      token\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Registration error:', error);\r\n    res.status(500).json({\r\n      error: 'Registration failed',\r\n      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'\r\n    });\r\n  }\r\n});\r\n\r\n// Login endpoint\r\nrouter.post('/login', [\r\n  body('email').isEmail().normalizeEmail(),\r\n  body('password').notEmpty()\r\n], handleValidationErrors, async (req, res) => {\r\n  try {\r\n    const { email, password } = req.body;\r\n\r\n    // Find user\r\n    const user = await prisma.user.findUnique({\r\n      where: { email }\r\n    });\r\n\r\n    if (!user || !user.password) {\r\n      return res.status(401).json({\r\n        error: 'Invalid credentials'\r\n      });\r\n    }\r\n\r\n    // Verify password\r\n    const isValidPassword = await bcrypt.compare(password, user.password);\r\n    if (!isValidPassword) {\r\n      return res.status(401).json({\r\n        error: 'Invalid credentials'\r\n      });\r\n    }\r\n\r\n    // Update last login\r\n    await prisma.user.update({\r\n      where: { id: user.id },\r\n      data: { lastLoginAt: new Date() }\r\n    });\r\n\r\n    // Generate JWT token\r\n    const jwtSecretLogin = process.env.JWT_SECRET;\r\n    if (!jwtSecretLogin) {\r\n      throw new Error('JWT_SECRET environment variable is required');\r\n    }\r\n    \r\n    const token = jwt.sign(\r\n      { userId: user.id, email: user.email, role: user.role },\r\n      jwtSecretLogin,\r\n      { expiresIn: '7d' }\r\n    );\r\n\r\n    res.json({\r\n      message: 'Login successful',\r\n      user: {\r\n        id: user.id,\r\n        email: user.email,\r\n        firstName: user.firstName,\r\n        lastName: user.lastName,\r\n        role: user.role,\r\n        status: user.status\r\n      },\r\n      token\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    res.status(500).json({\r\n      error: 'Login failed',\r\n      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'\r\n    });\r\n  }\r\n});\r\n\r\n// Logout endpoint\r\nrouter.post('/logout', async (req, res) => {\r\n  try {\r\n    // In a real implementation, you would invalidate the token\r\n    // For now, we'll just return success\r\n    res.json({\r\n      message: 'Logout successful'\r\n    });\r\n  } catch (error) {\r\n    console.error('Logout error:', error);\r\n    res.status(500).json({\r\n      error: 'Logout failed',\r\n      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'\r\n    });\r\n  }\r\n});\r\n\r\n// Refresh token endpoint\r\nrouter.post('/refresh', async (req, res) => {\r\n  try {\r\n    const { token } = req.body;\r\n\r\n    if (!token) {\r\n      return res.status(401).json({\r\n        error: 'Token required'\r\n      });\r\n    }\r\n\r\n    // Verify token\r\n    const jwtSecretRefresh = process.env.JWT_SECRET;\r\n    if (!jwtSecretRefresh) {\r\n      throw new Error('JWT_SECRET environment variable is required');\r\n    }\r\n    \r\n    const decoded = jwt.verify(token, jwtSecretRefresh);\r\n    \r\n    // Get user info\r\n    const user = await prisma.user.findUnique({\r\n      where: { id: decoded.userId },\r\n      select: {\r\n        id: true,\r\n        email: true,\r\n        firstName: true,\r\n        lastName: true,\r\n        role: true,\r\n        status: true\r\n      }\r\n    });\r\n\r\n    if (!user) {\r\n      return res.status(401).json({\r\n        error: 'User not found'\r\n      });\r\n    }\r\n\r\n    // Generate new token\r\n    const jwtSecretNew = process.env.JWT_SECRET;\r\n    if (!jwtSecretNew) {\r\n      throw new Error('JWT_SECRET environment variable is required');\r\n    }\r\n    \r\n    const newToken = jwt.sign(\r\n      { userId: user.id, email: user.email, role: user.role },\r\n      jwtSecretNew,\r\n      { expiresIn: '7d' }\r\n    );\r\n\r\n    res.json({\r\n      message: 'Token refreshed successfully',\r\n      user,\r\n      token: newToken\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Token refresh error:', error);\r\n    res.status(401).json({\r\n      error: 'Invalid token',\r\n      message: process.env.NODE_ENV === 'development' ? error.message : 'Token expired or invalid'\r\n    });\r\n  }\r\n});\r\n\r\nmodule.exports = router;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}