8e6eb0161753aed8bbf11578671f01ad
// Basic remember me functionality test
const {
  sessionService
} = require('../services/sessionService');
describe('Remember Me Basic Functionality', () => {
  describe('Session Creation', () => {
    test('should create session with remember me enabled', async () => {
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')
      };
      const result = await sessionService.createSession('user-123', mockReq, {
        rememberMe: true,
        loginType: 'password'
      });
      expect(result).toHaveProperty('sessionId');
      expect(result).toHaveProperty('expiresAt');
      expect(result).toHaveProperty('maxAge');
      expect(result.rememberMe).toBe(true);
      expect(result.persistent).toBe(true);
      expect(result.maxAge).toBe(7 * 24 * 60 * 60 * 1000);
      console.log('‚úÖ Remember me session creation test passed');
    });
    test('should create session without remember me', async () => {
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')
      };
      const result = await sessionService.createSession('user-123', mockReq, {
        rememberMe: false,
        loginType: 'password'
      });
      expect(result.rememberMe).toBe(false);
      expect(result.persistent).toBe(false);
      expect(result.maxAge).toBe(24 * 60 * 60 * 1000);
      console.log('‚úÖ Standard session creation test passed');
    });
  });
  describe('Session ID Generation', () => {
    test('should generate secure session IDs', () => {
      const sessionId1 = sessionService.generateSessionId();
      const sessionId2 = sessionService.generateSessionId();
      expect(sessionId1).toMatch(/^[a-f0-9]{32}$/);
      expect(sessionId2).toMatch(/^[a-f0-9]{32}$/);
      expect(sessionId1).not.toBe(sessionId2);
      expect(sessionId1).toHaveLength(64);
      console.log('‚úÖ Session ID generation test passed');
    });
  });
  describe('Device Fingerprinting', () => {
    test('should generate consistent device fingerprints', () => {
      const mockReq1 = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Windows NT 10.0; Win64; x64)')
      };
      const mockReq2 = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Windows NT 10.0; Win64; x64)')
      };
      const fingerprint1 = sessionService.generateDeviceFingerprint(mockReq1);
      const fingerprint2 = sessionService.generateDeviceFingerprint(mockReq2);
      expect(fingerprint1).toMatch(/^[a-f0-9]{32}$/);
      expect(fingerprint2).toMatch(/^[a-f0-9]{32}$/);
      expect(fingerprint1).toBe(fingerprint2);
      expect(fingerprint1).toHaveLength(32);
      console.log('‚úÖ Device fingerprinting test passed');
    });
  });
  describe('Remember Me Token Management', () => {
    test('should create remember me token successfully', async () => {
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')
      };

      // Mock Redis for this test
      const originalRedis = sessionService.redis;
      sessionService.redis = {
        setEx: jest.fn(),
        get: jest.fn(),
        del: jest.fn(),
        zAdd: jest.fn(),
        expire: jest.fn()
      };
      const result = await sessionService.createRememberMeToken('user-123', mockReq);
      expect(result.success).toBe(true);
      expect(result).toHaveProperty('token');
      expect(result).toHaveProperty('expiresAt');

      // Restore original Redis
      sessionService.redis = originalRedis;
      console.log('‚úÖ Remember me token creation test passed');
    });
    test('should validate remember me token successfully', async () => {
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')
      };

      // Mock Redis for this test
      const originalRedis = sessionService.redis;
      sessionService.redis = {
        get: jest.fn().mockResolvedValue(JSON.stringify({
          userId: 'user-123',
          token: 'test-token',
          deviceFingerprint: 'test-fingerprint',
          createdAt: new Date().toISOString(),
          expiresAt: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
        })),
        del: jest.fn()
      };
      const result = await sessionService.validateRememberMeToken('test-token');
      expect(result.valid).toBe(true);
      expect(result.userId).toBe('user-123');
      expect(result.deviceFingerprint).toBe('test-fingerprint');

      // Restore original Redis
      sessionService.redis = originalRedis;
      console.log('‚úÖ Remember me token validation test passed');
    });
  });
  describe('Integration Test', () => {
    test('should demonstrate complete remember me flow', async () => {
      console.log('üß™ Starting remember me integration test...');

      // Step 1: Create session with remember me
      const mockReq = {
        ip: '127.0.0.1',
        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')
      };
      const sessionResult = await sessionService.createSession('user-123', mockReq, {
        rememberMe: true,
        loginType: 'password'
      });
      expect(sessionResult.success !== undefined).toBe(true);
      expect(sessionResult.rememberMe).toBe(true);
      expect(sessionResult.persistent).toBe(true);
      expect(sessionResult.maxAge).toBe(7 * 24 * 60 * 60 * 1000);
      console.log('‚úÖ Remember me integration test completed successfully');
      console.log(`üìä Session ID: ${sessionResult.sessionId}`);
      console.log(`‚è∞ Expires at: ${sessionResult.expiresAt.toISOString()}`);
      console.log(`üìÖ Max age: ${sessionResult.maxAge}ms (${Math.round(sessionResult.maxAge / (24 * 60 * 60 * 1000))} days)`);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZXNzaW9uU2VydmljZSIsInJlcXVpcmUiLCJkZXNjcmliZSIsInRlc3QiLCJtb2NrUmVxIiwiaXAiLCJnZXQiLCJqZXN0IiwiZm4iLCJtb2NrUmV0dXJuVmFsdWUiLCJyZXN1bHQiLCJjcmVhdGVTZXNzaW9uIiwicmVtZW1iZXJNZSIsImxvZ2luVHlwZSIsImV4cGVjdCIsInRvSGF2ZVByb3BlcnR5IiwidG9CZSIsInBlcnNpc3RlbnQiLCJtYXhBZ2UiLCJjb25zb2xlIiwibG9nIiwic2Vzc2lvbklkMSIsImdlbmVyYXRlU2Vzc2lvbklkIiwic2Vzc2lvbklkMiIsInRvTWF0Y2giLCJub3QiLCJ0b0hhdmVMZW5ndGgiLCJtb2NrUmVxMSIsIm1vY2tSZXEyIiwiZmluZ2VycHJpbnQxIiwiZ2VuZXJhdGVEZXZpY2VGaW5nZXJwcmludCIsImZpbmdlcnByaW50MiIsIm9yaWdpbmFsUmVkaXMiLCJyZWRpcyIsInNldEV4IiwiZGVsIiwiekFkZCIsImV4cGlyZSIsImNyZWF0ZVJlbWVtYmVyTWVUb2tlbiIsInN1Y2Nlc3MiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1c2VySWQiLCJ0b2tlbiIsImRldmljZUZpbmdlcnByaW50IiwiY3JlYXRlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZXhwaXJlc0F0Iiwibm93IiwidmFsaWRhdGVSZW1lbWJlck1lVG9rZW4iLCJ2YWxpZCIsInNlc3Npb25SZXN1bHQiLCJ1bmRlZmluZWQiLCJzZXNzaW9uSWQiLCJNYXRoIiwicm91bmQiXSwic291cmNlcyI6WyJyZW1lbWJlci1tZS1iYXNpYy50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEJhc2ljIHJlbWVtYmVyIG1lIGZ1bmN0aW9uYWxpdHkgdGVzdFxyXG5jb25zdCB7IHNlc3Npb25TZXJ2aWNlIH0gPSByZXF1aXJlKCcuLi9zZXJ2aWNlcy9zZXNzaW9uU2VydmljZScpO1xyXG5cclxuZGVzY3JpYmUoJ1JlbWVtYmVyIE1lIEJhc2ljIEZ1bmN0aW9uYWxpdHknLCAoKSA9PiB7XHJcbiAgZGVzY3JpYmUoJ1Nlc3Npb24gQ3JlYXRpb24nLCAoKSA9PiB7XHJcbiAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIHNlc3Npb24gd2l0aCByZW1lbWJlciBtZSBlbmFibGVkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrUmVxID0ge1xyXG4gICAgICAgIGlwOiAnMTI3LjAuMC4xJyxcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ01vemlsbGEvNS4wIChUZXN0IEJyb3dzZXIpJylcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlc3Npb25TZXJ2aWNlLmNyZWF0ZVNlc3Npb24oJ3VzZXItMTIzJywgbW9ja1JlcSwge1xyXG4gICAgICAgIHJlbWVtYmVyTWU6IHRydWUsXHJcbiAgICAgICAgbG9naW5UeXBlOiAncGFzc3dvcmQnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3Nlc3Npb25JZCcpO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZXhwaXJlc0F0Jyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdtYXhBZ2UnKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5yZW1lbWJlck1lKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnBlcnNpc3RlbnQpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQubWF4QWdlKS50b0JlKDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBSZW1lbWJlciBtZSBzZXNzaW9uIGNyZWF0aW9uIHRlc3QgcGFzc2VkJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIHNlc3Npb24gd2l0aG91dCByZW1lbWJlciBtZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja1JlcSA9IHtcclxuICAgICAgICBpcDogJzEyNy4wLjAuMScsXHJcbiAgICAgICAgZ2V0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdNb3ppbGxhLzUuMCAoVGVzdCBCcm93c2VyKScpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXNzaW9uU2VydmljZS5jcmVhdGVTZXNzaW9uKCd1c2VyLTEyMycsIG1vY2tSZXEsIHtcclxuICAgICAgICByZW1lbWJlck1lOiBmYWxzZSxcclxuICAgICAgICBsb2dpblR5cGU6ICdwYXNzd29yZCdcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3QocmVzdWx0LnJlbWVtYmVyTWUpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnBlcnNpc3RlbnQpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBleHBlY3QocmVzdWx0Lm1heEFnZSkudG9CZSgyNCAqIDYwICogNjAgKiAxMDAwKTtcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBTdGFuZGFyZCBzZXNzaW9uIGNyZWF0aW9uIHRlc3QgcGFzc2VkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1Nlc3Npb24gSUQgR2VuZXJhdGlvbicsICgpID0+IHtcclxuICAgIHRlc3QoJ3Nob3VsZCBnZW5lcmF0ZSBzZWN1cmUgc2Vzc2lvbiBJRHMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNlc3Npb25JZDEgPSBzZXNzaW9uU2VydmljZS5nZW5lcmF0ZVNlc3Npb25JZCgpO1xyXG4gICAgICBjb25zdCBzZXNzaW9uSWQyID0gc2Vzc2lvblNlcnZpY2UuZ2VuZXJhdGVTZXNzaW9uSWQoKTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChzZXNzaW9uSWQxKS50b01hdGNoKC9eW2EtZjAtOV17MzJ9JC8pO1xyXG4gICAgICBleHBlY3Qoc2Vzc2lvbklkMikudG9NYXRjaCgvXlthLWYwLTldezMyfSQvKTtcclxuICAgICAgZXhwZWN0KHNlc3Npb25JZDEpLm5vdC50b0JlKHNlc3Npb25JZDIpO1xyXG4gICAgICBleHBlY3Qoc2Vzc2lvbklkMSkudG9IYXZlTGVuZ3RoKDY0KTtcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBTZXNzaW9uIElEIGdlbmVyYXRpb24gdGVzdCBwYXNzZWQnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRGV2aWNlIEZpbmdlcnByaW50aW5nJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIGNvbnNpc3RlbnQgZGV2aWNlIGZpbmdlcnByaW50cycsICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja1JlcTEgPSB7XHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCknKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgbW9ja1JlcTIgPSB7XHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCknKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgZmluZ2VycHJpbnQxID0gc2Vzc2lvblNlcnZpY2UuZ2VuZXJhdGVEZXZpY2VGaW5nZXJwcmludChtb2NrUmVxMSk7XHJcbiAgICAgIGNvbnN0IGZpbmdlcnByaW50MiA9IHNlc3Npb25TZXJ2aWNlLmdlbmVyYXRlRGV2aWNlRmluZ2VycHJpbnQobW9ja1JlcTIpO1xyXG5cclxuICAgICAgZXhwZWN0KGZpbmdlcnByaW50MSkudG9NYXRjaCgvXlthLWYwLTldezMyfSQvKTtcclxuICAgICAgZXhwZWN0KGZpbmdlcnByaW50MikudG9NYXRjaCgvXlthLWYwLTldezMyfSQvKTtcclxuICAgICAgZXhwZWN0KGZpbmdlcnByaW50MSkudG9CZShmaW5nZXJwcmludDIpO1xyXG4gICAgICBleHBlY3QoZmluZ2VycHJpbnQxKS50b0hhdmVMZW5ndGgoMzIpO1xyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIERldmljZSBmaW5nZXJwcmludGluZyB0ZXN0IHBhc3NlZCcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdSZW1lbWJlciBNZSBUb2tlbiBNYW5hZ2VtZW50JywgKCkgPT4ge1xyXG4gICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSByZW1lbWJlciBtZSB0b2tlbiBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tSZXEgPSB7XHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTW96aWxsYS81LjAgKFRlc3QgQnJvd3NlciknKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gTW9jayBSZWRpcyBmb3IgdGhpcyB0ZXN0XHJcbiAgICAgIGNvbnN0IG9yaWdpbmFsUmVkaXMgPSBzZXNzaW9uU2VydmljZS5yZWRpcztcclxuICAgICAgc2Vzc2lvblNlcnZpY2UucmVkaXMgPSB7XHJcbiAgICAgICAgc2V0RXg6IGplc3QuZm4oKSxcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgICAgICBkZWw6IGplc3QuZm4oKSxcclxuICAgICAgICB6QWRkOiBqZXN0LmZuKCksXHJcbiAgICAgICAgZXhwaXJlOiBqZXN0LmZuKClcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlc3Npb25TZXJ2aWNlLmNyZWF0ZVJlbWVtYmVyTWVUb2tlbigndXNlci0xMjMnLCBtb2NrUmVxKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ3Rva2VuJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdleHBpcmVzQXQnKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgUmVkaXNcclxuICAgICAgc2Vzc2lvblNlcnZpY2UucmVkaXMgPSBvcmlnaW5hbFJlZGlzO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBSZW1lbWJlciBtZSB0b2tlbiBjcmVhdGlvbiB0ZXN0IHBhc3NlZCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIHJlbWVtYmVyIG1lIHRva2VuIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbW9ja1JlcSA9IHtcclxuICAgICAgICBpcDogJzEyNy4wLjAuMScsXHJcbiAgICAgICAgZ2V0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdNb3ppbGxhLzUuMCAoVGVzdCBCcm93c2VyKScpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBNb2NrIFJlZGlzIGZvciB0aGlzIHRlc3RcclxuICAgICAgY29uc3Qgb3JpZ2luYWxSZWRpcyA9IHNlc3Npb25TZXJ2aWNlLnJlZGlzO1xyXG4gICAgICBzZXNzaW9uU2VydmljZS5yZWRpcyA9IHtcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyLTEyMycsXHJcbiAgICAgICAgICB0b2tlbjogJ3Rlc3QtdG9rZW4nLFxyXG4gICAgICAgICAgZGV2aWNlRmluZ2VycHJpbnQ6ICd0ZXN0LWZpbmdlcnByaW50JyxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICAgIGRlbDogamVzdC5mbigpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXNzaW9uU2VydmljZS52YWxpZGF0ZVJlbWVtYmVyTWVUb2tlbigndGVzdC10b2tlbicpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdC52YWxpZCkudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC51c2VySWQpLnRvQmUoJ3VzZXItMTIzJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuZGV2aWNlRmluZ2VycHJpbnQpLnRvQmUoJ3Rlc3QtZmluZ2VycHJpbnQnKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgUmVkaXNcclxuICAgICAgc2Vzc2lvblNlcnZpY2UucmVkaXMgPSBvcmlnaW5hbFJlZGlzO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBSZW1lbWJlciBtZSB0b2tlbiB2YWxpZGF0aW9uIHRlc3QgcGFzc2VkJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIFRlc3QnLCAoKSA9PiB7XHJcbiAgICB0ZXN0KCdzaG91bGQgZGVtb25zdHJhdGUgY29tcGxldGUgcmVtZW1iZXIgbWUgZmxvdycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ/Cfp6ogU3RhcnRpbmcgcmVtZW1iZXIgbWUgaW50ZWdyYXRpb24gdGVzdC4uLicpO1xyXG4gICAgICBcclxuICAgICAgLy8gU3RlcCAxOiBDcmVhdGUgc2Vzc2lvbiB3aXRoIHJlbWVtYmVyIG1lXHJcbiAgICAgIGNvbnN0IG1vY2tSZXEgPSB7XHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIGdldDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnTW96aWxsYS81LjAgKFRlc3QgQnJvd3NlciknKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3Qgc2Vzc2lvblJlc3VsdCA9IGF3YWl0IHNlc3Npb25TZXJ2aWNlLmNyZWF0ZVNlc3Npb24oJ3VzZXItMTIzJywgbW9ja1JlcSwge1xyXG4gICAgICAgIHJlbWVtYmVyTWU6IHRydWUsXHJcbiAgICAgICAgbG9naW5UeXBlOiAncGFzc3dvcmQnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHNlc3Npb25SZXN1bHQuc3VjY2VzcyAhPT0gdW5kZWZpbmVkKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3Qoc2Vzc2lvblJlc3VsdC5yZW1lbWJlck1lKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3Qoc2Vzc2lvblJlc3VsdC5wZXJzaXN0ZW50KS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3Qoc2Vzc2lvblJlc3VsdC5tYXhBZ2UpLnRvQmUoNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coJ+KchSBSZW1lbWJlciBtZSBpbnRlZ3JhdGlvbiB0ZXN0IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogU2Vzc2lvbiBJRDogJHtzZXNzaW9uUmVzdWx0LnNlc3Npb25JZH1gKTtcclxuICAgICAgY29uc29sZS5sb2coYOKPsCBFeHBpcmVzIGF0OiAke3Nlc3Npb25SZXN1bHQuZXhwaXJlc0F0LnRvSVNPU3RyaW5nKCl9YCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OFIE1heCBhZ2U6ICR7c2Vzc2lvblJlc3VsdC5tYXhBZ2V9bXMgKCR7TWF0aC5yb3VuZChzZXNzaW9uUmVzdWx0Lm1heEFnZSAvICgyNCAqIDYwICogNjAgKiAxMDAwKSl9IGRheXMpYCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBLE1BQU07RUFBRUE7QUFBZSxDQUFDLEdBQUdDLE9BQU8sQ0FBQyw0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