{"version":3,"names":["cov_1obf5pk3pg","actualCoverage","crypto","s","require","PrismaClient","configService","loggerService","SessionService","constructor","f","prisma","redis","config","logger","initializeRedis","Redis","redisUrl","get","b","warn","createClient","url","retry_delay_on_failover","max_retries_per_request","connectTimeout","lazyConnect","socket","keepAlive","reconnectStrategy","retries","error","Math","min","pipeline","multi","exec","execMulti","on","err","message","info","connect","generateSessionId","randomBytes","toString","generateDeviceFingerprint","req","userAgent","acceptLanguage","acceptEncoding","fingerprint","createHash","update","digest","substring","createSession","userId","options","sessionId","deviceFingerprint","now","Date","defaultMaxAge","rememberMe","sessionConfig","ip","createdAt","lastActivity","expiresAt","getTime","maxAge","isActive","loginType","securityLevel","persistent","deviceTrusted","sessionKey","ttl","floor","setEx","JSON","stringify","userSessionsKey","zAdd","score","value","expire","userSession","create","data","token","logSecurity","Error","validateSession","valid","reason","sessionData","sessionString","parse","session","findUnique","where","include","user","path","originalUrl","destroySession","securityChecks","performSecurityChecks","passed","ipChanged","isIPChangeAllowed","currentFingerprint","oldIP","newIP","oldParts","split","newParts","length","refreshSession","validation","success","newExpiry","toISOString","zRem","del","delete","id","destroyAllUserSessions","exceptSessionId","destroyedSessions","sessionIds","zRange","push","sessions","findMany","not","destroyedCount","getUserSessions","dbSessions","gt","orderBy","map","cleanupExpiredSessions","cleanedCount","pattern","keys","key","validSessions","exists","result","deleteMany","lt","count","timestamp","getSessionStats","stats","totalSessions","activeSessions","expiredSessions","redisAvailable","total","active","Promise","all","validateRememberMeToken","tokenKey","tokenString","tokenData","rememberMeToken","createRememberMeToken","userTokensKey","refreshFromRememberMeToken","expectedFingerprint","actualFingerprint","sessionResult","newSessionId","cleanupExpiredRememberMeTokens","sessionService","module","exports"],"sources":["sessionService.js"],"sourcesContent":["const crypto = require('crypto');\r\nconst { PrismaClient } = require('@prisma/client');\r\nconst { configService } = require('./config');\r\nconst { loggerService } = require('./logger');\r\n\r\nclass SessionService {\r\n  constructor() {\r\n    this.prisma = new PrismaClient();\r\n    this.redis = null;\r\n    this.config = configService;\r\n    this.logger = loggerService;\r\n    this.initializeRedis();\r\n  }\r\n\r\n  async initializeRedis() {\r\n    try {\r\n      const Redis = require('redis');\r\n      const redisUrl = this.config.get('REDIS_URL');\r\n      \r\n      if (!redisUrl) {\r\n        this.logger.warn('REDIS_URL not configured, session management will use database only');\r\n        return;\r\n      }\r\n\r\n      this.redis = Redis.createClient({\r\n        url: redisUrl,\r\n        retry_delay_on_failover: 100,\r\n        max_retries_per_request: 3,\r\n        connectTimeout: 10000,\r\n        lazyConnect: false,\r\n        socket: {\r\n          keepAlive: true,\r\n          reconnectStrategy: (retries) => {\r\n            if (retries > 10) {\r\n              this.logger.error('Redis reconnection failed after 10 attempts');\r\n              return false;\r\n            }\r\n            return Math.min(retries * 100, 3000);\r\n          }\r\n        }\r\n      });\r\n\r\n      // Add pipeline method support\r\n      this.redis.pipeline = () => {\r\n        const pipeline = this.redis.multi();\r\n        pipeline.exec = () => this.redis.execMulti(pipeline);\r\n        return pipeline;\r\n      };\r\n\r\n      this.redis.on('error', (err) => {\r\n        this.logger.error('Redis connection error in session service', err.message);\r\n        // Don't set redis to null, allow reconnection\r\n      });\r\n\r\n      this.redis.on('connect', () => {\r\n        this.logger.info('Redis connected for session service');\r\n      });\r\n\r\n      this.redis.on('ready', () => {\r\n        this.logger.info('Redis ready for session service');\r\n      });\r\n\r\n      this.redis.on('reconnecting', () => {\r\n        this.logger.info('Redis reconnecting for session service');\r\n      });\r\n\r\n      await this.redis.connect();\r\n    } catch (error) {\r\n      this.logger.error('Failed to initialize Redis for session service', error.message);\r\n      this.redis = null;\r\n    }\r\n  }\r\n\r\n  // Generate secure session ID\r\n  generateSessionId() {\r\n    return crypto.randomBytes(32).toString('hex');\r\n  }\r\n\r\n  // Generate device fingerprint\r\n  generateDeviceFingerprint(req) {\r\n    const userAgent = req.get('User-Agent') || '';\r\n    const acceptLanguage = req.get('Accept-Language') || '';\r\n    const acceptEncoding = req.get('Accept-Encoding') || '';\r\n    \r\n    const fingerprint = crypto\r\n      .createHash('sha256')\r\n      .update(`${userAgent}|${acceptLanguage}|${acceptEncoding}`)\r\n      .digest('hex');\r\n    \r\n    return fingerprint.substring(0, 32); // Truncate for storage efficiency\r\n  }\r\n\r\n  // Create new session\r\n  async createSession(userId, req, options = {}) {\r\n    try {\r\n      const sessionId = this.generateSessionId();\r\n      const deviceFingerprint = this.generateDeviceFingerprint(req);\r\n      const now = new Date();\r\n      \r\n      // Enhanced session configuration for remember me functionality\r\n      const defaultMaxAge = options.rememberMe ?\r\n        7 * 24 * 60 * 60 * 1000 : // 7 days for remember me\r\n        24 * 60 * 60 * 1000;  // 24 hours default\r\n      \r\n      const sessionConfig = {\r\n        userId,\r\n        sessionId,\r\n        deviceFingerprint,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        createdAt: now,\r\n        lastActivity: now,\r\n        expiresAt: new Date(now.getTime() + (options.maxAge || defaultMaxAge)),\r\n        isActive: true,\r\n        loginType: options.loginType || 'password',\r\n        rememberMe: options.rememberMe || false,\r\n        securityLevel: options.securityLevel || 'standard',\r\n        // Enhanced remember me features\r\n        persistent: options.rememberMe || false,\r\n        deviceTrusted: options.rememberMe || false,\r\n        maxAge: options.maxAge || defaultMaxAge\r\n      };\r\n\r\n      // Store in Redis if available\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const ttl = Math.floor((sessionConfig.expiresAt.getTime() - now.getTime()) / 1000);\r\n        \r\n        await this.redis.setEx(sessionKey, ttl, JSON.stringify(sessionConfig));\r\n        \r\n        // Also store user session index for easy lookup\r\n        const userSessionsKey = `user_sessions:${userId}`;\r\n        await this.redis.zAdd(userSessionsKey, [{ \r\n          score: now.getTime(), \r\n          value: sessionId \r\n        }]);\r\n        await this.redis.expire(userSessionsKey, 7 * 24 * 60 * 60); // 7 days\r\n        \r\n        this.logger.info('Session created in Redis', { sessionId, userId });\r\n      } else {\r\n        // Fallback to database\r\n        await this.prisma.userSession.create({\r\n          data: {\r\n            userId,\r\n            token: sessionId,\r\n            expiresAt: sessionConfig.expiresAt\r\n          }\r\n        });\r\n        \r\n        this.logger.info('Session created in database', { sessionId, userId });\r\n      }\r\n\r\n      // Log session creation with enhanced remember me details\r\n      this.logger.logSecurity('Session Created', userId, {\r\n        sessionId,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent'),\r\n        loginType: options.loginType,\r\n        rememberMe: options.rememberMe,\r\n        persistent: sessionConfig.persistent,\r\n        maxAge: sessionConfig.maxAge,\r\n        expiresAt: sessionConfig.expiresAt\r\n      });\r\n\r\n      return {\r\n        sessionId,\r\n        expiresAt: sessionConfig.expiresAt,\r\n        maxAge: sessionConfig.maxAge,\r\n        rememberMe: sessionConfig.rememberMe,\r\n        persistent: sessionConfig.persistent\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to create session', error.message);\r\n      throw new Error('Session creation failed');\r\n    }\r\n  }\r\n\r\n  // Validate session\r\n  async validateSession(sessionId, req) {\r\n    try {\r\n      if (!sessionId) {\r\n        return { valid: false, reason: 'No session ID provided' };\r\n      }\r\n\r\n      let sessionData = null;\r\n\r\n      // Try Redis first\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const sessionString = await this.redis.get(sessionKey);\r\n        \r\n        if (sessionString) {\r\n          sessionData = JSON.parse(sessionString);\r\n        }\r\n      } else {\r\n        // Fallback to database\r\n        const session = await this.prisma.userSession.findUnique({\r\n          where: { token: sessionId },\r\n          include: { user: true }\r\n        });\r\n\r\n        if (session && session.expiresAt > new Date()) {\r\n          sessionData = {\r\n            userId: session.userId,\r\n            sessionId,\r\n            ip: req.ip,\r\n            userAgent: req.get('User-Agent'),\r\n            createdAt: session.createdAt,\r\n            lastActivity: session.createdAt,\r\n            expiresAt: session.expiresAt,\r\n            isActive: true\r\n          };\r\n        }\r\n      }\r\n\r\n      if (!sessionData) {\r\n        this.logger.logSecurity('Invalid Session Attempt', null, {\r\n          sessionId,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent'),\r\n          path: req.originalUrl\r\n        });\r\n        return { valid: false, reason: 'Session not found or expired' };\r\n      }\r\n\r\n      // Check expiration\r\n      const now = new Date();\r\n      if (sessionData.expiresAt && now > sessionData.expiresAt) {\r\n        await this.destroySession(sessionId);\r\n        return { valid: false, reason: 'Session expired' };\r\n      }\r\n\r\n      // Security checks\r\n      const securityChecks = this.performSecurityChecks(sessionData, req);\r\n      if (!securityChecks.passed) {\r\n        await this.destroySession(sessionId);\r\n        this.logger.logSecurity('Session Security Check Failed', sessionData.userId, {\r\n          sessionId,\r\n          reason: securityChecks.reason,\r\n          ip: req.ip,\r\n          userAgent: req.get('User-Agent')\r\n        });\r\n        return { valid: false, reason: securityChecks.reason };\r\n      }\r\n\r\n      // Update last activity\r\n      sessionData.lastActivity = now;\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const ttl = Math.floor((sessionData.expiresAt.getTime() - now.getTime()) / 1000);\r\n        await this.redis.setEx(sessionKey, ttl, JSON.stringify(sessionData));\r\n      }\r\n\r\n      return {\r\n        valid: true,\r\n        session: sessionData,\r\n        userId: sessionData.userId\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session validation error', error.message);\r\n      return { valid: false, reason: 'Session validation failed' };\r\n    }\r\n  }\r\n\r\n  // Perform security checks on session\r\n  performSecurityChecks(sessionData, req) {\r\n    // IP address validation (optional, can be disabled for mobile networks)\r\n    if (sessionData.ip && sessionData.ip !== req.ip) {\r\n      // Allow some flexibility for mobile networks\r\n      const ipChanged = !this.isIPChangeAllowed(sessionData.ip, req.ip);\r\n      if (ipChanged) {\r\n        return { passed: false, reason: 'IP address mismatch' };\r\n      }\r\n    }\r\n\r\n    // User Agent validation\r\n    if (sessionData.userAgent && sessionData.userAgent !== req.get('User-Agent')) {\r\n      return { passed: false, reason: 'User agent mismatch' };\r\n    }\r\n\r\n    // Device fingerprint validation\r\n    const currentFingerprint = this.generateDeviceFingerprint(req);\r\n    if (sessionData.deviceFingerprint && sessionData.deviceFingerprint !== currentFingerprint) {\r\n      return { passed: false, reason: 'Device fingerprint mismatch' };\r\n    }\r\n\r\n    return { passed: true };\r\n  }\r\n\r\n  // Check if IP change is allowed (for mobile networks)\r\n  isIPChangeAllowed(oldIP, newIP) {\r\n    // Allow changes within same subnet or geographic region\r\n    // This is a simplified implementation\r\n    const oldParts = oldIP.split('.');\r\n    const newParts = newIP.split('.');\r\n    \r\n    // Allow changes if first two octets are the same (same subnet)\r\n    return oldParts.length === 4 && newParts.length === 4 && \r\n           oldParts[0] === newParts[0] && oldParts[1] === newParts[1];\r\n  }\r\n\r\n  // Refresh/extend session\r\n  async refreshSession(sessionId, req, options = {}) {\r\n    try {\r\n      const validation = await this.validateSession(sessionId, req);\r\n      if (!validation.valid) {\r\n        return { success: false, reason: validation.reason };\r\n      }\r\n\r\n      const session = validation.session;\r\n      const now = new Date();\r\n      const newExpiry = new Date(now.getTime() + (options.maxAge || 24 * 60 * 60 * 1000));\r\n\r\n      session.lastActivity = now;\r\n      session.expiresAt = newExpiry;\r\n\r\n      // Update in Redis\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const ttl = Math.floor((newExpiry.getTime() - now.getTime()) / 1000);\r\n        await this.redis.setEx(sessionKey, ttl, JSON.stringify(session));\r\n      } else {\r\n        // Update in database\r\n        await this.prisma.userSession.update({\r\n          where: { token: sessionId },\r\n          data: { expiresAt: newExpiry }\r\n        });\r\n      }\r\n\r\n      this.logger.logSecurity('Session Refreshed', session.userId, {\r\n        sessionId,\r\n        ip: req.ip,\r\n        newExpiry: newExpiry.toISOString()\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        sessionId,\r\n        expiresAt: newExpiry,\r\n        maxAge: options.maxAge || 24 * 60 * 60 * 1000\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session refresh error', error.message);\r\n      return { success: false, reason: 'Session refresh failed' };\r\n    }\r\n  }\r\n\r\n  // Destroy session\r\n  async destroySession(sessionId, reason = 'logout') {\r\n    try {\r\n      // Remove from Redis\r\n      if (this.redis) {\r\n        const sessionKey = `session:${sessionId}`;\r\n        const sessionString = await this.redis.get(sessionKey);\r\n        \r\n        if (sessionString) {\r\n          const sessionData = JSON.parse(sessionString);\r\n          const userSessionsKey = `user_sessions:${sessionData.userId}`;\r\n          \r\n          // Remove from user sessions index\r\n          await this.redis.zRem(userSessionsKey, sessionId);\r\n          await this.redis.del(sessionKey);\r\n          \r\n          this.logger.logSecurity('Session Destroyed', sessionData.userId, {\r\n            sessionId,\r\n            reason,\r\n            ip: sessionData.ip\r\n          });\r\n        }\r\n      } else {\r\n        // Remove from database\r\n        const session = await this.prisma.userSession.findUnique({\r\n          where: { token: sessionId }\r\n        });\r\n\r\n        if (session) {\r\n          await this.prisma.userSession.delete({\r\n            where: { id: session.id }\r\n          });\r\n          \r\n          this.logger.logSecurity('Session Destroyed', session.userId, {\r\n            sessionId,\r\n            reason\r\n          });\r\n        }\r\n      }\r\n\r\n      return { success: true };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session destruction error', error.message);\r\n      return { success: false, reason: 'Session destruction failed' };\r\n    }\r\n  }\r\n\r\n  // Destroy all user sessions (except current)\r\n  async destroyAllUserSessions(userId, exceptSessionId = null) {\r\n    try {\r\n      let destroyedSessions = [];\r\n\r\n      if (this.redis) {\r\n        const userSessionsKey = `user_sessions:${userId}`;\r\n        const sessionIds = await this.redis.zRange(userSessionsKey, 0, -1);\r\n        \r\n        for (const sessionId of sessionIds) {\r\n          if (sessionId !== exceptSessionId) {\r\n            await this.destroySession(sessionId, 'mass_logout');\r\n            destroyedSessions.push(sessionId);\r\n          }\r\n        }\r\n      } else {\r\n        // Database fallback\r\n        const sessions = await this.prisma.userSession.findMany({\r\n          where: { \r\n            userId,\r\n            ...(exceptSessionId && { token: { not: exceptSessionId } })\r\n          }\r\n        });\r\n\r\n        for (const session of sessions) {\r\n          await this.destroySession(session.token, 'mass_logout');\r\n          destroyedSessions.push(session.token);\r\n        }\r\n      }\r\n\r\n      this.logger.logSecurity('All User Sessions Destroyed', userId, {\r\n        destroyedCount: destroyedSessions.length,\r\n        exceptSessionId\r\n      });\r\n\r\n      return { success: true, destroyedCount: destroyedSessions.length };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Mass session destruction error', error.message);\r\n      return { success: false, reason: 'Mass session destruction failed' };\r\n    }\r\n  }\r\n\r\n  // Get active sessions for user\r\n  async getUserSessions(userId) {\r\n    try {\r\n      let sessions = [];\r\n\r\n      if (this.redis) {\r\n        const userSessionsKey = `user_sessions:${userId}`;\r\n        const sessionIds = await this.redis.zRange(userSessionsKey, 0, -1);\r\n        \r\n        for (const sessionId of sessionIds) {\r\n          const sessionKey = `session:${sessionId}`;\r\n          const sessionString = await this.redis.get(sessionKey);\r\n          \r\n          if (sessionString) {\r\n            const sessionData = JSON.parse(sessionString);\r\n            if (sessionData.expiresAt > new Date()) {\r\n              sessions.push({\r\n                sessionId,\r\n                createdAt: sessionData.createdAt,\r\n                lastActivity: sessionData.lastActivity,\r\n                expiresAt: sessionData.expiresAt,\r\n                ip: sessionData.ip,\r\n                userAgent: sessionData.userAgent,\r\n                loginType: sessionData.loginType,\r\n                isActive: sessionData.isActive\r\n              });\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // Database fallback\r\n        const dbSessions = await this.prisma.userSession.findMany({\r\n          where: { \r\n            userId,\r\n            expiresAt: { gt: new Date() }\r\n          },\r\n          orderBy: { createdAt: 'desc' }\r\n        });\r\n\r\n        sessions = dbSessions.map(session => ({\r\n          sessionId: session.token,\r\n          createdAt: session.createdAt,\r\n          expiresAt: session.expiresAt,\r\n          isActive: true\r\n        }));\r\n      }\r\n\r\n      return { success: true, sessions };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Get user sessions error', error.message);\r\n      return { success: false, reason: 'Failed to retrieve user sessions' };\r\n    }\r\n  }\r\n\r\n  // Cleanup expired sessions\r\n  async cleanupExpiredSessions() {\r\n    try {\r\n      let cleanedCount = 0;\r\n\r\n      if (this.redis) {\r\n        // Redis handles expiration automatically, but we can clean up user session indexes\r\n        const pattern = 'user_sessions:*';\r\n        const keys = await this.redis.keys(pattern);\r\n        \r\n        for (const key of keys) {\r\n          const sessionIds = await this.redis.zRange(key, 0, -1);\r\n          const validSessions = [];\r\n          \r\n          for (const sessionId of sessionIds) {\r\n            const sessionKey = `session:${sessionId}`;\r\n            const exists = await this.redis.exists(sessionKey);\r\n            if (exists) {\r\n              validSessions.push(sessionId);\r\n            }\r\n          }\r\n          \r\n          // Update user sessions index with only valid sessions\r\n          await this.redis.del(key);\r\n          if (validSessions.length > 0) {\r\n            await this.redis.zAdd(key, validSessions.map(id => ({ score: Date.now(), value: id })));\r\n          }\r\n          \r\n          cleanedCount += sessionIds.length - validSessions.length;\r\n        }\r\n      } else {\r\n        // Database cleanup\r\n        const result = await this.prisma.userSession.deleteMany({\r\n          where: { expiresAt: { lt: new Date() } }\r\n        });\r\n        cleanedCount = result.count;\r\n      }\r\n\r\n      this.logger.info('Session cleanup completed', {\r\n        cleanedCount,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      return { success: true, cleanedCount };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session cleanup error', error.message);\r\n      return { success: false, reason: 'Session cleanup failed' };\r\n    }\r\n  }\r\n\r\n  // Get session statistics\r\n  async getSessionStats() {\r\n    try {\r\n      let stats = {\r\n        totalSessions: 0,\r\n        activeSessions: 0,\r\n        expiredSessions: 0,\r\n        redisAvailable: this.redis !== null\r\n      };\r\n\r\n      if (this.redis) {\r\n        const pattern = 'session:*';\r\n        const keys = await this.redis.keys(pattern);\r\n        stats.totalSessions = keys.length;\r\n        \r\n        const now = new Date();\r\n        for (const key of keys) {\r\n          const sessionString = await this.redis.get(key);\r\n          if (sessionString) {\r\n            const sessionData = JSON.parse(sessionString);\r\n            if (sessionData.expiresAt > now) {\r\n              stats.activeSessions++;\r\n            } else {\r\n              stats.expiredSessions++;\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // Database stats\r\n        const [total, active] = await Promise.all([\r\n          this.prisma.userSession.count(),\r\n          this.prisma.userSession.count({\r\n            where: { expiresAt: { gt: new Date() } }\r\n          })\r\n        ]);\r\n        \r\n        stats.totalSessions = total;\r\n        stats.activeSessions = active;\r\n        stats.expiredSessions = total - active;\r\n      }\r\n\r\n      return { success: true, stats };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Session stats error', error.message);\r\n      return { success: false, reason: 'Failed to get session statistics' };\r\n    }\r\n  }\r\n\r\n  // Validate remember me token\r\n  async validateRememberMeToken(token) {\r\n    try {\r\n      if (!token) {\r\n        return { valid: false, reason: 'No remember me token provided' };\r\n      }\r\n\r\n      // Try Redis first\r\n      if (this.redis) {\r\n        const tokenKey = `remember_me:${token}`;\r\n        const tokenString = await this.redis.get(tokenKey);\r\n        \r\n        if (tokenString) {\r\n          const tokenData = JSON.parse(tokenString);\r\n          \r\n          // Check if token has expired\r\n          if (tokenData.expiresAt && new Date() > tokenData.expiresAt) {\r\n            await this.redis.del(tokenKey);\r\n            return { valid: false, reason: 'Remember me token expired' };\r\n          }\r\n          \r\n          return {\r\n            valid: true,\r\n            userId: tokenData.userId,\r\n            deviceFingerprint: tokenData.deviceFingerprint,\r\n            createdAt: tokenData.createdAt\r\n          };\r\n        }\r\n      } else {\r\n        // Database fallback for remember me tokens\r\n        const rememberMeToken = await this.prisma.rememberMeToken.findUnique({\r\n          where: { token },\r\n          include: { user: true }\r\n        });\r\n\r\n        if (!rememberMeToken || rememberMeToken.expiresAt < new Date()) {\r\n          return { valid: false, reason: 'Remember me token not found or expired' };\r\n        }\r\n\r\n        return {\r\n          valid: true,\r\n          userId: rememberMeToken.userId,\r\n          deviceFingerprint: rememberMeToken.deviceFingerprint,\r\n          createdAt: rememberMeToken.createdAt\r\n        };\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logger.error('Remember me token validation error', error.message);\r\n      return { valid: false, reason: 'Token validation failed' };\r\n    }\r\n  }\r\n\r\n  // Create remember me token\r\n  async createRememberMeToken(userId, req) {\r\n    try {\r\n      const token = this.generateSessionId(); // Use same secure generation\r\n      const deviceFingerprint = this.generateDeviceFingerprint(req);\r\n      const now = new Date();\r\n      const expiresAt = new Date(now.getTime() + (30 * 24 * 60 * 60 * 1000)); // 30 days\r\n\r\n      const tokenData = {\r\n        userId,\r\n        token,\r\n        deviceFingerprint,\r\n        createdAt: now,\r\n        expiresAt,\r\n        isActive: true\r\n      };\r\n\r\n      // Store in Redis if available\r\n      if (this.redis) {\r\n        const tokenKey = `remember_me:${token}`;\r\n        const ttl = Math.floor((expiresAt.getTime() - now.getTime()) / 1000);\r\n        await this.redis.setEx(tokenKey, ttl, JSON.stringify(tokenData));\r\n        \r\n        // Also store user remember me tokens index\r\n        const userTokensKey = `user_remember_me:${userId}`;\r\n        await this.redis.zAdd(userTokensKey, [{\r\n          score: now.getTime(),\r\n          value: token\r\n        }]);\r\n        await this.redis.expire(userTokensKey, 30 * 24 * 60 * 60); // 30 days\r\n      } else {\r\n        // Database fallback - would need to create rememberMeToken table\r\n        this.logger.warn('Remember me tokens require Redis for full functionality');\r\n      }\r\n\r\n      this.logger.logSecurity('Remember Me Token Created', userId, {\r\n        token,\r\n        deviceFingerprint,\r\n        expiresAt: expiresAt.toISOString(),\r\n        ip: req.ip\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        token,\r\n        expiresAt\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to create remember me token', error.message);\r\n      return { success: false, reason: 'Token creation failed' };\r\n    }\r\n  }\r\n\r\n  // Refresh session using remember me token\r\n  async refreshFromRememberMeToken(token, req) {\r\n    try {\r\n      const validation = await this.validateRememberMeToken(token);\r\n      \r\n      if (!validation.valid) {\r\n        return { success: false, reason: validation.reason };\r\n      }\r\n\r\n      // Verify device fingerprint matches\r\n      const currentFingerprint = this.generateDeviceFingerprint(req);\r\n      if (validation.deviceFingerprint !== currentFingerprint) {\r\n        this.logger.logSecurity('Remember Me Device Mismatch', validation.userId, {\r\n          token,\r\n          expectedFingerprint: validation.deviceFingerprint,\r\n          actualFingerprint: currentFingerprint,\r\n          ip: req.ip\r\n        });\r\n        return { success: false, reason: 'Device fingerprint mismatch' };\r\n      }\r\n\r\n      // Create new session\r\n      const sessionResult = await this.createSession(validation.userId, req, {\r\n        loginType: 'remember_me',\r\n        rememberMe: true,\r\n        maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days for remembered sessions\r\n        securityLevel: 'standard'\r\n      });\r\n\r\n      if (!sessionResult.sessionId) {\r\n        return { success: false, reason: 'Failed to create session from remember me token' };\r\n      }\r\n\r\n      // Clean up old remember me token for security\r\n      if (this.redis) {\r\n        const tokenKey = `remember_me:${token}`;\r\n        await this.redis.del(tokenKey);\r\n      }\r\n\r\n      this.logger.logSecurity('Session Refreshed from Remember Me', validation.userId, {\r\n        newSessionId: sessionResult.sessionId,\r\n        ip: req.ip,\r\n        userAgent: req.get('User-Agent')\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        sessionId: sessionResult.sessionId,\r\n        expiresAt: sessionResult.expiresAt,\r\n        maxAge: sessionResult.maxAge,\r\n        userId: validation.userId\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Remember me session refresh error', error.message);\r\n      return { success: false, reason: 'Session refresh failed' };\r\n    }\r\n  }\r\n\r\n  // Clean up expired remember me tokens\r\n  async cleanupExpiredRememberMeTokens() {\r\n    try {\r\n      let cleanedCount = 0;\r\n\r\n      if (this.redis) {\r\n        const pattern = 'remember_me:*';\r\n        const keys = await this.redis.keys(pattern);\r\n        \r\n        for (const key of keys) {\r\n          const tokenString = await this.redis.get(key);\r\n          if (tokenString) {\r\n            const tokenData = JSON.parse(tokenString);\r\n            if (tokenData.expiresAt && new Date() > tokenData.expiresAt) {\r\n              await this.redis.del(key);\r\n              cleanedCount++;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      this.logger.info('Remember me token cleanup completed', {\r\n        cleanedCount,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      return { success: true, cleanedCount };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Remember me token cleanup error', error.message);\r\n      return { success: false, reason: 'Cleanup failed' };\r\n    }\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst sessionService = new SessionService();\r\n\r\nmodule.exports = {\r\n  SessionService,\r\n  sessionService\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}