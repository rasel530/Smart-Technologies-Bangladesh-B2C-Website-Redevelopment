cbac6b21bdbe8a13462837fbf60cafc0
const loggerService = require('./logger');
class PhoneValidationService {
  constructor() {
    this.logger = loggerService;

    // Bangladesh mobile operator prefixes
    this.mobileOperators = {
      '013': {
        name: 'Teletalk',
        network: '2G/3G',
        color: '#8B4513',
        logo: '/assets/operators/teletalk.png'
      },
      '014': {
        name: 'Banglalink',
        network: '2G/3G/4G',
        color: '#FF6B35',
        logo: '/assets/operators/banglalink.png'
      },
      '015': {
        name: 'Teletalk',
        network: '2G/3G',
        color: '#8B4513',
        logo: '/assets/operators/teletalk.png'
      },
      '016': {
        name: 'Airtel',
        network: '2G/3G/4G',
        color: '#ED1C24',
        logo: '/assets/operators/airtel.png'
      },
      '017': {
        name: 'Grameenphone',
        network: '2G/3G/4G/5G',
        color: '#00BCD4',
        logo: '/assets/operators/grameenphone.png'
      },
      '018': {
        name: 'Robi',
        network: '2G/3G/4G',
        color: '#E91E63',
        logo: '/assets/operators/robi.png'
      },
      '019': {
        name: 'Banglalink',
        network: '2G/3G/4G',
        color: '#FF6B35',
        logo: '/assets/operators/banglalink.png'
      }
    };

    // Bangladesh landline area codes
    this.landlineAreaCodes = {
      '02': {
        area: 'Dhaka',
        region: 'Central'
      },
      '031': {
        area: 'Chittagong',
        region: 'Southeast'
      },
      '041': {
        area: 'Khulna',
        region: 'Southwest'
      },
      '051': {
        area: 'Rajshahi',
        region: 'Northwest'
      },
      '061': {
        area: 'Sylhet',
        region: 'Northeast'
      },
      '071': {
        area: 'Barisal',
        region: 'South'
      },
      '081': {
        area: 'Rangpur',
        region: 'North'
      },
      '091': {
        area: 'Mymensingh',
        region: 'North-central'
      }
    };

    // Special number patterns
    this.specialNumbers = {
      emergency: {
        patterns: [/^999$/, /^100$/, /^101$/, /^102$/],
        description: 'Emergency Services',
        examples: ['999', '100', '101', '102']
      },
      tollFree: {
        patterns: [/^800\d{7}$/],
        description: 'Toll-Free Numbers',
        examples: ['8001234567']
      },
      premium: {
        patterns: [/^900\d{7}$/],
        description: 'Premium Rate Numbers',
        examples: ['9001234567']
      },
      corporate: {
        patterns: [/^1\d{8}$/],
        description: 'Corporate Numbers',
        examples: ['123456789']
      }
    };
  }

  /**
   * Comprehensive Bangladesh phone number validation
   * @param {string} phone - Phone number to validate
   * @param {Object} options - Validation options
   * @returns {Object} Validation result with detailed information
   */
  validateBangladeshPhoneNumber(phone, options = {}) {
    const {
      allowLandline = true,
      allowMobile = true,
      allowSpecial = false,
      requireNormalized = false
    } = options;
    if (!phone || typeof phone !== 'string') {
      return {
        isValid: false,
        error: 'Phone number is required and must be a string',
        errorBn: 'ফোন নম্বর প্রয়োজনীয় এবং এটি একটি স্ট্রিং হতে হবে',
        code: 'INVALID_INPUT'
      };
    }

    // Remove all non-digit characters except +
    const cleanPhone = phone.replace(/[^\d+]/g, '').trim();
    if (!cleanPhone) {
      return {
        isValid: false,
        error: 'Phone number cannot be empty',
        errorBn: 'ফোন নম্বর খালি হতে পারে না',
        code: 'EMPTY_PHONE'
      };
    }

    // Check special numbers first
    if (allowSpecial) {
      const specialValidation = this.validateSpecialNumbers(cleanPhone);
      if (specialValidation.isValid) {
        return {
          ...specialValidation,
          originalPhone: phone,
          normalizedPhone: cleanPhone
        };
      }
    }

    // Validate mobile numbers
    if (allowMobile) {
      const mobileValidation = this.validateMobileNumber(cleanPhone);
      if (mobileValidation.isValid) {
        return {
          ...mobileValidation,
          originalPhone: phone,
          normalizedPhone: mobileValidation.normalizedPhone
        };
      }
    }

    // Validate landline numbers
    if (allowLandline) {
      const landlineValidation = this.validateLandlineNumber(cleanPhone);
      if (landlineValidation.isValid) {
        return {
          ...landlineValidation,
          originalPhone: phone,
          normalizedPhone: landlineValidation.normalizedPhone
        };
      }
    }

    // If we reach here, the number is invalid
    return {
      isValid: false,
      error: 'Invalid Bangladesh phone number format',
      errorBn: 'অবৈধ বাংলাদেশ ফোন নম্বর ফরম্যাট',
      code: 'INVALID_FORMAT',
      suggestions: this.getFormatSuggestions(),
      examples: this.getValidExamples()
    };
  }

  /**
   * Validate mobile phone numbers
   * @param {string} phone - Clean phone number
   * @returns {Object} Mobile validation result
   */
  validateMobileNumber(phone) {
    // Mobile number patterns
    const mobilePatterns = [/^\+8801[3-9]\d{8}$/,
    // International format: +8801XXXXXXXXX
    /^8801[3-9]\d{8}$/,
    // Without +: 8801XXXXXXXXX
    /^01[3-9]\d{8}$/ // Local format: 01XXXXXXXXX
    ];
    if (!mobilePatterns.some(pattern => pattern.test(phone))) {
      return {
        isValid: false,
        error: 'Invalid mobile number format',
        errorBn: 'অবৈধ মোবাইল নম্বর ফরম্যাট',
        code: 'INVALID_MOBILE_FORMAT'
      };
    }

    // Normalize to international format
    let normalizedPhone = phone;
    if (phone.startsWith('01')) {
      normalizedPhone = `+880${phone}`;
    } else if (phone.startsWith('880')) {
      normalizedPhone = `+${phone}`;
    }

    // Extract operator prefix
    const prefix = normalizedPhone.substring(3, 6);
    const operator = this.mobileOperators[prefix];
    if (!operator) {
      return {
        isValid: false,
        error: 'Unsupported mobile operator',
        errorBn: 'অসমর্থিত মোবাইল অপারেটর',
        code: 'UNSUPPORTED_OPERATOR',
        supportedOperators: Object.keys(this.mobileOperators).map(p => this.mobileOperators[p].name)
      };
    }
    return {
      isValid: true,
      type: 'mobile',
      format: this.detectFormat(phone),
      normalizedPhone,
      operator: operator.name,
      operatorDetails: {
        prefix,
        ...operator
      },
      network: operator.network,
      isPorted: false,
      // TODO: Implement portability check if needed
      metadata: {
        length: normalizedPhone.length,
        countryCode: '+880',
        numberWithoutCountry: normalizedPhone.substring(3)
      }
    };
  }

  /**
   * Validate landline numbers
   * @param {string} phone - Clean phone number
   * @returns {Object} Landline validation result
   */
  validateLandlineNumber(phone) {
    // Landline patterns
    const landlinePatterns = [/^\+8802[1-9]\d{7}$/,
    // International: +8802XXXXXXXX
    /^8802[1-9]\d{7}$/,
    // Without +: 8802XXXXXXXX
    /^02[1-9]\d{7}$/ // Local: 02XXXXXXXX
    ];
    if (!landlinePatterns.some(pattern => pattern.test(phone))) {
      return {
        isValid: false,
        error: 'Invalid landline number format',
        errorBn: 'অবৈধ ল্যান্ডলাইন নম্বর ফরম্যাট',
        code: 'INVALID_LANDLINE_FORMAT'
      };
    }

    // Normalize to international format
    let normalizedPhone = phone;
    if (phone.startsWith('02')) {
      normalizedPhone = `+880${phone}`;
    } else if (phone.startsWith('8802')) {
      normalizedPhone = `+${phone}`;
    }

    // Extract area code
    let areaCode;
    if (normalizedPhone.startsWith('+8802')) {
      areaCode = normalizedPhone.substring(3, 5);
    }
    const areaInfo = this.landlineAreaCodes[areaCode];
    return {
      isValid: true,
      type: 'landline',
      format: this.detectFormat(phone),
      normalizedPhone,
      areaCode,
      areaInfo: areaInfo || {
        area: 'Unknown',
        region: 'Unknown'
      },
      metadata: {
        length: normalizedPhone.length,
        countryCode: '+880',
        numberWithoutCountry: normalizedPhone.substring(3)
      }
    };
  }

  /**
   * Validate special numbers (emergency, toll-free, etc.)
   * @param {string} phone - Clean phone number
   * @returns {Object} Special number validation result
   */
  validateSpecialNumbers(phone) {
    for (const [type, info] of Object.entries(this.specialNumbers)) {
      for (const pattern of info.patterns) {
        if (pattern.test(phone)) {
          return {
            isValid: true,
            type: 'special',
            specialType: type,
            description: info.description,
            normalizedPhone: phone,
            examples: info.examples,
            metadata: {
              length: phone.length,
              category: type
            }
          };
        }
      }
    }
    return {
      isValid: false,
      error: 'Not a recognized special number',
      errorBn: 'স্বীকৃত বিশেষ নম্বর নয়',
      code: 'INVALID_SPECIAL_FORMAT'
    };
  }

  /**
   * Detect phone number format
   * @param {string} phone - Phone number
   * @returns {string} Format type
   */
  detectFormat(phone) {
    if (phone.startsWith('+880')) return 'international';
    if (phone.startsWith('880')) return 'country_code';
    if (phone.startsWith('01')) return 'local';
    return 'unknown';
  }

  /**
   * Get format suggestions for invalid numbers
   * @returns {Array} Format suggestions
   */
  getFormatSuggestions() {
    return ['+8801XXXXXXXXX (International format)', '01XXXXXXXXX (Local format)', '+8802XXXXXXXX (Landline international)', '02XXXXXXXX (Landline local)'];
  }

  /**
   * Get valid examples
   * @returns {Array} Valid examples
   */
  getValidExamples() {
    return {
      mobile: ['+8801712345678', '01712345678', '+8801812345678', '01812345678'],
      landline: ['+880212345678', '0212345678', '+880311234567', '0311234567']
    };
  }

  /**
   * Normalize phone number to international format
   * @param {string} phone - Phone number to normalize
   * @returns {string|null} Normalized phone number or null if invalid
   */
  normalizePhoneNumber(phone) {
    const validation = this.validateBangladeshPhoneNumber(phone);
    if (!validation.isValid) {
      return null;
    }
    return validation.normalizedPhone;
  }

  /**
   * Format phone number for display
   * @param {string} phone - Phone number to format
   * @param {string} format - Desired format ('international', 'local', 'display')
   * @returns {string} Formatted phone number
   */
  formatPhoneNumber(phone, format = 'display') {
    const validation = this.validateBangladeshPhoneNumber(phone);
    if (!validation.isValid) {
      return phone;
    }
    const normalized = validation.normalizedPhone;
    switch (format) {
      case 'international':
        return normalized;
      case 'local':
        if (normalized.startsWith('+880')) {
          return normalized.substring(3);
        }
        return normalized;
      case 'display':
        if (validation.type === 'mobile') {
          if (normalized.startsWith('+880')) {
            const rest = normalized.substring(4);
            return `+880 ${rest.slice(0, 3)} ${rest.slice(3, 6)} ${rest.slice(6, 10)}`;
          }
        } else if (validation.type === 'landline') {
          if (normalized.startsWith('+880')) {
            const rest = normalized.substring(4);
            return `+880 ${rest.slice(0, 2)} ${rest.slice(2, 6)} ${rest.slice(6, 10)}`;
          }
        }
        return normalized;
      default:
        return normalized;
    }
  }

  /**
   * Get operator information
   * @param {string} phone - Phone number
   * @returns {Object|null} Operator information
   */
  getOperatorInfo(phone) {
    const validation = this.validateBangladeshPhoneNumber(phone);
    if (!validation.isValid || validation.type !== 'mobile') {
      return null;
    }
    return {
      operator: validation.operator,
      prefix: validation.operatorDetails.prefix,
      network: validation.network,
      color: validation.operatorDetails.color,
      logo: validation.operatorDetails.logo,
      isPorted: validation.isPorted
    };
  }

  /**
   * Check if phone number is from a specific operator
   * @param {string} phone - Phone number
   * @param {string} operator - Operator name
   * @returns {boolean} True if matches operator
   */
  isOperator(phone, operator) {
    const operatorInfo = this.getOperatorInfo(phone);
    if (!operatorInfo) return false;
    return operatorInfo.operator.toLowerCase() === operator.toLowerCase();
  }

  /**
   * Get all supported operators
   * @returns {Array} List of supported operators
   */
  getSupportedOperators() {
    return Object.entries(this.mobileOperators).map(([prefix, info]) => ({
      prefix,
      name: info.name,
      network: info.network,
      color: info.color,
      logo: info.logo
    }));
  }

  /**
   * Get all supported landline areas
   * @returns {Array} List of supported areas
   */
  getSupportedLandlineAreas() {
    return Object.entries(this.landlineAreaCodes).map(([code, info]) => ({
      code,
      area: info.area,
      region: info.region
    }));
  }

  /**
   * Validate phone number for specific use case
   * @param {string} phone - Phone number
   * @param {string} useCase - Use case ('registration', 'otp', 'sms', 'verification', 'login')
   * @returns {Object} Validation result with use-case specific rules
   */
  validateForUseCase(phone, useCase) {
    const baseValidation = this.validateBangladeshPhoneNumber(phone, {
      allowLandline: useCase !== 'otp' && useCase !== 'sms' && useCase !== 'login',
      allowMobile: true,
      allowSpecial: false
    });
    if (!baseValidation.isValid) {
      return baseValidation;
    }

    // Use-case specific validations
    switch (useCase) {
      case 'registration':
        return {
          ...baseValidation,
          canReceiveSMS: baseValidation.type === 'mobile',
          canReceiveOTP: baseValidation.type === 'mobile',
          requiresVerification: true
        };
      case 'otp':
      case 'sms':
        if (baseValidation.type !== 'mobile') {
          return {
            isValid: false,
            error: 'Only mobile numbers can receive SMS/OTP',
            errorBn: 'শুধুমাত্রমাত্র মোবাইল নম্বর SMS/OTP পেতে পারে',
            code: 'MOBILE_ONLY'
          };
        }
        return baseValidation;
      case 'login':
        if (baseValidation.type !== 'mobile') {
          return {
            isValid: false,
            error: 'Only mobile numbers can be used for login',
            errorBn: 'শুধুমাত্রমাত্র মোবাইল নম্বর দিয়ে লগিন করা যায়',
            code: 'MOBILE_ONLY'
          };
        }
        return {
          ...baseValidation,
          canLogin: true,
          requiresVerification: false // Phone should already be verified for login
        };
      case 'verification':
        return {
          ...baseValidation,
          isVerifiable: true
        };
      default:
        return baseValidation;
    }
  }

  /**
   * Generate validation statistics
   * @param {Array} phoneNumbers - Array of phone numbers to analyze
   * @returns {Object} Statistics about phone numbers
   */
  generateValidationStats(phoneNumbers) {
    const stats = {
      total: phoneNumbers.length,
      valid: 0,
      invalid: 0,
      mobile: 0,
      landline: 0,
      special: 0,
      operators: {},
      areas: {},
      formats: {
        international: 0,
        local: 0,
        country_code: 0
      }
    };
    phoneNumbers.forEach(phone => {
      const validation = this.validateBangladeshPhoneNumber(phone);
      if (validation.isValid) {
        stats.valid++;
        stats[validation.type]++;
        stats.formats[validation.format]++;
        if (validation.operator) {
          stats.operators[validation.operator] = (stats.operators[validation.operator] || 0) + 1;
        }
        if (validation.areaCode) {
          stats.areas[validation.areaCode] = (stats.areas[validation.areaCode] || 0) + 1;
        }
      } else {
        stats.invalid++;
      }
    });
    return stats;
  }
}

// Singleton instance
const phoneValidationService = new PhoneValidationService();
module.exports = {
  PhoneValidationService,
  phoneValidationService
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJsb2dnZXJTZXJ2aWNlIiwicmVxdWlyZSIsIlBob25lVmFsaWRhdGlvblNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImxvZ2dlciIsIm1vYmlsZU9wZXJhdG9ycyIsIm5hbWUiLCJuZXR3b3JrIiwiY29sb3IiLCJsb2dvIiwibGFuZGxpbmVBcmVhQ29kZXMiLCJhcmVhIiwicmVnaW9uIiwic3BlY2lhbE51bWJlcnMiLCJlbWVyZ2VuY3kiLCJwYXR0ZXJucyIsImRlc2NyaXB0aW9uIiwiZXhhbXBsZXMiLCJ0b2xsRnJlZSIsInByZW1pdW0iLCJjb3Jwb3JhdGUiLCJ2YWxpZGF0ZUJhbmdsYWRlc2hQaG9uZU51bWJlciIsInBob25lIiwib3B0aW9ucyIsImFsbG93TGFuZGxpbmUiLCJhbGxvd01vYmlsZSIsImFsbG93U3BlY2lhbCIsInJlcXVpcmVOb3JtYWxpemVkIiwiaXNWYWxpZCIsImVycm9yIiwiZXJyb3JCbiIsImNvZGUiLCJjbGVhblBob25lIiwicmVwbGFjZSIsInRyaW0iLCJzcGVjaWFsVmFsaWRhdGlvbiIsInZhbGlkYXRlU3BlY2lhbE51bWJlcnMiLCJvcmlnaW5hbFBob25lIiwibm9ybWFsaXplZFBob25lIiwibW9iaWxlVmFsaWRhdGlvbiIsInZhbGlkYXRlTW9iaWxlTnVtYmVyIiwibGFuZGxpbmVWYWxpZGF0aW9uIiwidmFsaWRhdGVMYW5kbGluZU51bWJlciIsInN1Z2dlc3Rpb25zIiwiZ2V0Rm9ybWF0U3VnZ2VzdGlvbnMiLCJnZXRWYWxpZEV4YW1wbGVzIiwibW9iaWxlUGF0dGVybnMiLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJzdGFydHNXaXRoIiwicHJlZml4Iiwic3Vic3RyaW5nIiwib3BlcmF0b3IiLCJzdXBwb3J0ZWRPcGVyYXRvcnMiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwicCIsInR5cGUiLCJmb3JtYXQiLCJkZXRlY3RGb3JtYXQiLCJvcGVyYXRvckRldGFpbHMiLCJpc1BvcnRlZCIsIm1ldGFkYXRhIiwibGVuZ3RoIiwiY291bnRyeUNvZGUiLCJudW1iZXJXaXRob3V0Q291bnRyeSIsImxhbmRsaW5lUGF0dGVybnMiLCJhcmVhQ29kZSIsImFyZWFJbmZvIiwiaW5mbyIsImVudHJpZXMiLCJzcGVjaWFsVHlwZSIsImNhdGVnb3J5IiwibW9iaWxlIiwibGFuZGxpbmUiLCJub3JtYWxpemVQaG9uZU51bWJlciIsInZhbGlkYXRpb24iLCJmb3JtYXRQaG9uZU51bWJlciIsIm5vcm1hbGl6ZWQiLCJyZXN0Iiwic2xpY2UiLCJnZXRPcGVyYXRvckluZm8iLCJpc09wZXJhdG9yIiwib3BlcmF0b3JJbmZvIiwidG9Mb3dlckNhc2UiLCJnZXRTdXBwb3J0ZWRPcGVyYXRvcnMiLCJnZXRTdXBwb3J0ZWRMYW5kbGluZUFyZWFzIiwidmFsaWRhdGVGb3JVc2VDYXNlIiwidXNlQ2FzZSIsImJhc2VWYWxpZGF0aW9uIiwiY2FuUmVjZWl2ZVNNUyIsImNhblJlY2VpdmVPVFAiLCJyZXF1aXJlc1ZlcmlmaWNhdGlvbiIsImNhbkxvZ2luIiwiaXNWZXJpZmlhYmxlIiwiZ2VuZXJhdGVWYWxpZGF0aW9uU3RhdHMiLCJwaG9uZU51bWJlcnMiLCJzdGF0cyIsInRvdGFsIiwidmFsaWQiLCJpbnZhbGlkIiwic3BlY2lhbCIsIm9wZXJhdG9ycyIsImFyZWFzIiwiZm9ybWF0cyIsImludGVybmF0aW9uYWwiLCJsb2NhbCIsImNvdW50cnlfY29kZSIsImZvckVhY2giLCJwaG9uZVZhbGlkYXRpb25TZXJ2aWNlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInBob25lVmFsaWRhdGlvblNlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbG9nZ2VyU2VydmljZSA9IHJlcXVpcmUoJy4vbG9nZ2VyJyk7XHJcblxyXG5jbGFzcyBQaG9uZVZhbGlkYXRpb25TZXJ2aWNlIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyU2VydmljZTtcclxuICAgIFxyXG4gICAgLy8gQmFuZ2xhZGVzaCBtb2JpbGUgb3BlcmF0b3IgcHJlZml4ZXNcclxuICAgIHRoaXMubW9iaWxlT3BlcmF0b3JzID0ge1xyXG4gICAgICAnMDEzJzoge1xyXG4gICAgICAgIG5hbWU6ICdUZWxldGFsaycsXHJcbiAgICAgICAgbmV0d29yazogJzJHLzNHJyxcclxuICAgICAgICBjb2xvcjogJyM4QjQ1MTMnLFxyXG4gICAgICAgIGxvZ286ICcvYXNzZXRzL29wZXJhdG9ycy90ZWxldGFsay5wbmcnXHJcbiAgICAgIH0sXHJcbiAgICAgICcwMTQnOiB7XHJcbiAgICAgICAgbmFtZTogJ0JhbmdsYWxpbmsnLFxyXG4gICAgICAgIG5ldHdvcms6ICcyRy8zRy80RycsXHJcbiAgICAgICAgY29sb3I6ICcjRkY2QjM1JyxcclxuICAgICAgICBsb2dvOiAnL2Fzc2V0cy9vcGVyYXRvcnMvYmFuZ2xhbGluay5wbmcnXHJcbiAgICAgIH0sXHJcbiAgICAgICcwMTUnOiB7XHJcbiAgICAgICAgbmFtZTogJ1RlbGV0YWxrJyxcclxuICAgICAgICBuZXR3b3JrOiAnMkcvM0cnLFxyXG4gICAgICAgIGNvbG9yOiAnIzhCNDUxMycsXHJcbiAgICAgICAgbG9nbzogJy9hc3NldHMvb3BlcmF0b3JzL3RlbGV0YWxrLnBuZydcclxuICAgICAgfSxcclxuICAgICAgJzAxNic6IHtcclxuICAgICAgICBuYW1lOiAnQWlydGVsJyxcclxuICAgICAgICBuZXR3b3JrOiAnMkcvM0cvNEcnLFxyXG4gICAgICAgIGNvbG9yOiAnI0VEMUMyNCcsXHJcbiAgICAgICAgbG9nbzogJy9hc3NldHMvb3BlcmF0b3JzL2FpcnRlbC5wbmcnXHJcbiAgICAgIH0sXHJcbiAgICAgICcwMTcnOiB7XHJcbiAgICAgICAgbmFtZTogJ0dyYW1lZW5waG9uZScsXHJcbiAgICAgICAgbmV0d29yazogJzJHLzNHLzRHLzVHJyxcclxuICAgICAgICBjb2xvcjogJyMwMEJDRDQnLFxyXG4gICAgICAgIGxvZ286ICcvYXNzZXRzL29wZXJhdG9ycy9ncmFtZWVucGhvbmUucG5nJ1xyXG4gICAgICB9LFxyXG4gICAgICAnMDE4Jzoge1xyXG4gICAgICAgIG5hbWU6ICdSb2JpJyxcclxuICAgICAgICBuZXR3b3JrOiAnMkcvM0cvNEcnLFxyXG4gICAgICAgIGNvbG9yOiAnI0U5MUU2MycsXHJcbiAgICAgICAgbG9nbzogJy9hc3NldHMvb3BlcmF0b3JzL3JvYmkucG5nJ1xyXG4gICAgICB9LFxyXG4gICAgICAnMDE5Jzoge1xyXG4gICAgICAgIG5hbWU6ICdCYW5nbGFsaW5rJyxcclxuICAgICAgICBuZXR3b3JrOiAnMkcvM0cvNEcnLFxyXG4gICAgICAgIGNvbG9yOiAnI0ZGNkIzNScsXHJcbiAgICAgICAgbG9nbzogJy9hc3NldHMvb3BlcmF0b3JzL2JhbmdsYWxpbmsucG5nJ1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIEJhbmdsYWRlc2ggbGFuZGxpbmUgYXJlYSBjb2Rlc1xyXG4gICAgdGhpcy5sYW5kbGluZUFyZWFDb2RlcyA9IHtcclxuICAgICAgJzAyJzogeyBhcmVhOiAnRGhha2EnLCByZWdpb246ICdDZW50cmFsJyB9LFxyXG4gICAgICAnMDMxJzogeyBhcmVhOiAnQ2hpdHRhZ29uZycsIHJlZ2lvbjogJ1NvdXRoZWFzdCcgfSxcclxuICAgICAgJzA0MSc6IHsgYXJlYTogJ0todWxuYScsIHJlZ2lvbjogJ1NvdXRod2VzdCcgfSxcclxuICAgICAgJzA1MSc6IHsgYXJlYTogJ1JhanNoYWhpJywgcmVnaW9uOiAnTm9ydGh3ZXN0JyB9LFxyXG4gICAgICAnMDYxJzogeyBhcmVhOiAnU3lsaGV0JywgcmVnaW9uOiAnTm9ydGhlYXN0JyB9LFxyXG4gICAgICAnMDcxJzogeyBhcmVhOiAnQmFyaXNhbCcsIHJlZ2lvbjogJ1NvdXRoJyB9LFxyXG4gICAgICAnMDgxJzogeyBhcmVhOiAnUmFuZ3B1cicsIHJlZ2lvbjogJ05vcnRoJyB9LFxyXG4gICAgICAnMDkxJzogeyBhcmVhOiAnTXltZW5zaW5naCcsIHJlZ2lvbjogJ05vcnRoLWNlbnRyYWwnIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gU3BlY2lhbCBudW1iZXIgcGF0dGVybnNcclxuICAgIHRoaXMuc3BlY2lhbE51bWJlcnMgPSB7XHJcbiAgICAgIGVtZXJnZW5jeToge1xyXG4gICAgICAgIHBhdHRlcm5zOiBbL145OTkkLywgL14xMDAkLywgL14xMDEkLywgL14xMDIkL10sXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdFbWVyZ2VuY3kgU2VydmljZXMnLFxyXG4gICAgICAgIGV4YW1wbGVzOiBbJzk5OScsICcxMDAnLCAnMTAxJywgJzEwMiddXHJcbiAgICAgIH0sXHJcbiAgICAgIHRvbGxGcmVlOiB7XHJcbiAgICAgICAgcGF0dGVybnM6IFsvXjgwMFxcZHs3fSQvXSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1RvbGwtRnJlZSBOdW1iZXJzJyxcclxuICAgICAgICBleGFtcGxlczogWyc4MDAxMjM0NTY3J11cclxuICAgICAgfSxcclxuICAgICAgcHJlbWl1bToge1xyXG4gICAgICAgIHBhdHRlcm5zOiBbL145MDBcXGR7N30kL10sXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdQcmVtaXVtIFJhdGUgTnVtYmVycycsXHJcbiAgICAgICAgZXhhbXBsZXM6IFsnOTAwMTIzNDU2NyddXHJcbiAgICAgIH0sXHJcbiAgICAgIGNvcnBvcmF0ZToge1xyXG4gICAgICAgIHBhdHRlcm5zOiBbL14xXFxkezh9JC9dLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29ycG9yYXRlIE51bWJlcnMnLFxyXG4gICAgICAgIGV4YW1wbGVzOiBbJzEyMzQ1Njc4OSddXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb21wcmVoZW5zaXZlIEJhbmdsYWRlc2ggcGhvbmUgbnVtYmVyIHZhbGlkYXRpb25cclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGhvbmUgLSBQaG9uZSBudW1iZXIgdG8gdmFsaWRhdGVcclxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIFZhbGlkYXRpb24gb3B0aW9uc1xyXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFZhbGlkYXRpb24gcmVzdWx0IHdpdGggZGV0YWlsZWQgaW5mb3JtYXRpb25cclxuICAgKi9cclxuICB2YWxpZGF0ZUJhbmdsYWRlc2hQaG9uZU51bWJlcihwaG9uZSwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgIGFsbG93TGFuZGxpbmUgPSB0cnVlLFxyXG4gICAgICBhbGxvd01vYmlsZSA9IHRydWUsXHJcbiAgICAgIGFsbG93U3BlY2lhbCA9IGZhbHNlLFxyXG4gICAgICByZXF1aXJlTm9ybWFsaXplZCA9IGZhbHNlXHJcbiAgICB9ID0gb3B0aW9ucztcclxuXHJcbiAgICBpZiAoIXBob25lIHx8IHR5cGVvZiBwaG9uZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ1Bob25lIG51bWJlciBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIHN0cmluZycsXHJcbiAgICAgICAgZXJyb3JCbjogJ+Cmq+Cni+CmqCDgpqjgpq7gp43gpqzgprAg4Kaq4KeN4Kaw4Kav4Ka84KeL4Kac4Kao4KeA4Kav4Ka8IOCmj+CmrOCmgiDgpo/gpp/gpr8g4KaP4KaV4Kaf4Ka/IOCmuOCnjeCmn+CnjeCmsOCmv+CmgiDgprngpqTgp4cg4Ka54Kas4KeHJyxcclxuICAgICAgICBjb2RlOiAnSU5WQUxJRF9JTlBVVCdcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZW1vdmUgYWxsIG5vbi1kaWdpdCBjaGFyYWN0ZXJzIGV4Y2VwdCArXHJcbiAgICBjb25zdCBjbGVhblBob25lID0gcGhvbmUucmVwbGFjZSgvW15cXGQrXS9nLCAnJykudHJpbSgpO1xyXG5cclxuICAgIGlmICghY2xlYW5QaG9uZSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnUGhvbmUgbnVtYmVyIGNhbm5vdCBiZSBlbXB0eScsXHJcbiAgICAgICAgZXJyb3JCbjogJ+Cmq+Cni+CmqCDgpqjgpq7gp43gpqzgprAg4KaW4Ka+4Kay4Ka/IOCmueCmpOCnhyDgpqrgpr7gprDgp4cg4Kao4Ka+JyxcclxuICAgICAgICBjb2RlOiAnRU1QVFlfUEhPTkUnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgc3BlY2lhbCBudW1iZXJzIGZpcnN0XHJcbiAgICBpZiAoYWxsb3dTcGVjaWFsKSB7XHJcbiAgICAgIGNvbnN0IHNwZWNpYWxWYWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZVNwZWNpYWxOdW1iZXJzKGNsZWFuUGhvbmUpO1xyXG4gICAgICBpZiAoc3BlY2lhbFZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5zcGVjaWFsVmFsaWRhdGlvbixcclxuICAgICAgICAgIG9yaWdpbmFsUGhvbmU6IHBob25lLFxyXG4gICAgICAgICAgbm9ybWFsaXplZFBob25lOiBjbGVhblBob25lXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIG1vYmlsZSBudW1iZXJzXHJcbiAgICBpZiAoYWxsb3dNb2JpbGUpIHtcclxuICAgICAgY29uc3QgbW9iaWxlVmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVNb2JpbGVOdW1iZXIoY2xlYW5QaG9uZSk7XHJcbiAgICAgIGlmIChtb2JpbGVWYWxpZGF0aW9uLmlzVmFsaWQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgLi4ubW9iaWxlVmFsaWRhdGlvbixcclxuICAgICAgICAgIG9yaWdpbmFsUGhvbmU6IHBob25lLFxyXG4gICAgICAgICAgbm9ybWFsaXplZFBob25lOiBtb2JpbGVWYWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBsYW5kbGluZSBudW1iZXJzXHJcbiAgICBpZiAoYWxsb3dMYW5kbGluZSkge1xyXG4gICAgICBjb25zdCBsYW5kbGluZVZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlTGFuZGxpbmVOdW1iZXIoY2xlYW5QaG9uZSk7XHJcbiAgICAgIGlmIChsYW5kbGluZVZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5sYW5kbGluZVZhbGlkYXRpb24sXHJcbiAgICAgICAgICBvcmlnaW5hbFBob25lOiBwaG9uZSxcclxuICAgICAgICAgIG5vcm1hbGl6ZWRQaG9uZTogbGFuZGxpbmVWYWxpZGF0aW9uLm5vcm1hbGl6ZWRQaG9uZVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiB3ZSByZWFjaCBoZXJlLCB0aGUgbnVtYmVyIGlzIGludmFsaWRcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludmFsaWQgQmFuZ2xhZGVzaCBwaG9uZSBudW1iZXIgZm9ybWF0JyxcclxuICAgICAgZXJyb3JCbjogJ+CmheCmrOCniOCmpyDgpqzgpr7gpoLgprLgpr7gpqbgp4fgprYg4Kar4KeL4KaoIOCmqOCmruCnjeCmrOCmsCDgpqvgprDgpq7gp43gpq/gpr7gpp8nLFxyXG4gICAgICBjb2RlOiAnSU5WQUxJRF9GT1JNQVQnLFxyXG4gICAgICBzdWdnZXN0aW9uczogdGhpcy5nZXRGb3JtYXRTdWdnZXN0aW9ucygpLFxyXG4gICAgICBleGFtcGxlczogdGhpcy5nZXRWYWxpZEV4YW1wbGVzKClcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBtb2JpbGUgcGhvbmUgbnVtYmVyc1xyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwaG9uZSAtIENsZWFuIHBob25lIG51bWJlclxyXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IE1vYmlsZSB2YWxpZGF0aW9uIHJlc3VsdFxyXG4gICAqL1xyXG4gIHZhbGlkYXRlTW9iaWxlTnVtYmVyKHBob25lKSB7XHJcbiAgICAvLyBNb2JpbGUgbnVtYmVyIHBhdHRlcm5zXHJcbiAgICBjb25zdCBtb2JpbGVQYXR0ZXJucyA9IFtcclxuICAgICAgL15cXCs4ODAxWzMtOV1cXGR7OH0kLywgLy8gSW50ZXJuYXRpb25hbCBmb3JtYXQ6ICs4ODAxWFhYWFhYWFhYXHJcbiAgICAgIC9eODgwMVszLTldXFxkezh9JC8sIC8vIFdpdGhvdXQgKzogODgwMVhYWFhYWFhYWFxyXG4gICAgICAvXjAxWzMtOV1cXGR7OH0kLywgLy8gTG9jYWwgZm9ybWF0OiAwMVhYWFhYWFhYWFxyXG4gICAgXTtcclxuXHJcbiAgICBpZiAoIW1vYmlsZVBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QocGhvbmUpKSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCBtb2JpbGUgbnVtYmVyIGZvcm1hdCcsXHJcbiAgICAgICAgZXJyb3JCbjogJ+CmheCmrOCniOCmpyDgpq7gp4vgpqzgpr7gpofgprIg4Kao4Kau4KeN4Kas4KawIOCmq+CmsOCmruCnjeCmr+CmvuCmnycsXHJcbiAgICAgICAgY29kZTogJ0lOVkFMSURfTU9CSUxFX0ZPUk1BVCdcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3JtYWxpemUgdG8gaW50ZXJuYXRpb25hbCBmb3JtYXRcclxuICAgIGxldCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZTtcclxuICAgIGlmIChwaG9uZS5zdGFydHNXaXRoKCcwMScpKSB7XHJcbiAgICAgIG5vcm1hbGl6ZWRQaG9uZSA9IGArODgwJHtwaG9uZX1gO1xyXG4gICAgfSBlbHNlIGlmIChwaG9uZS5zdGFydHNXaXRoKCc4ODAnKSkge1xyXG4gICAgICBub3JtYWxpemVkUGhvbmUgPSBgKyR7cGhvbmV9YDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHRyYWN0IG9wZXJhdG9yIHByZWZpeFxyXG4gICAgY29uc3QgcHJlZml4ID0gbm9ybWFsaXplZFBob25lLnN1YnN0cmluZygzLCA2KTtcclxuICAgIGNvbnN0IG9wZXJhdG9yID0gdGhpcy5tb2JpbGVPcGVyYXRvcnNbcHJlZml4XTtcclxuXHJcbiAgICBpZiAoIW9wZXJhdG9yKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdVbnN1cHBvcnRlZCBtb2JpbGUgb3BlcmF0b3InLFxyXG4gICAgICAgIGVycm9yQm46ICfgpoXgprjgpq7gprDgp43gpqXgpr/gpqQg4Kau4KeL4Kas4Ka+4KaH4KayIOCmheCmquCmvuCmsOCnh+Cmn+CmsCcsXHJcbiAgICAgICAgY29kZTogJ1VOU1VQUE9SVEVEX09QRVJBVE9SJyxcclxuICAgICAgICBzdXBwb3J0ZWRPcGVyYXRvcnM6IE9iamVjdC5rZXlzKHRoaXMubW9iaWxlT3BlcmF0b3JzKS5tYXAocCA9PiB0aGlzLm1vYmlsZU9wZXJhdG9yc1twXS5uYW1lKVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzVmFsaWQ6IHRydWUsXHJcbiAgICAgIHR5cGU6ICdtb2JpbGUnLFxyXG4gICAgICBmb3JtYXQ6IHRoaXMuZGV0ZWN0Rm9ybWF0KHBob25lKSxcclxuICAgICAgbm9ybWFsaXplZFBob25lLFxyXG4gICAgICBvcGVyYXRvcjogb3BlcmF0b3IubmFtZSxcclxuICAgICAgb3BlcmF0b3JEZXRhaWxzOiB7XHJcbiAgICAgICAgcHJlZml4LFxyXG4gICAgICAgIC4uLm9wZXJhdG9yXHJcbiAgICAgIH0sXHJcbiAgICAgIG5ldHdvcms6IG9wZXJhdG9yLm5ldHdvcmssXHJcbiAgICAgIGlzUG9ydGVkOiBmYWxzZSwgLy8gVE9ETzogSW1wbGVtZW50IHBvcnRhYmlsaXR5IGNoZWNrIGlmIG5lZWRlZFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIGxlbmd0aDogbm9ybWFsaXplZFBob25lLmxlbmd0aCxcclxuICAgICAgICBjb3VudHJ5Q29kZTogJys4ODAnLFxyXG4gICAgICAgIG51bWJlcldpdGhvdXRDb3VudHJ5OiBub3JtYWxpemVkUGhvbmUuc3Vic3RyaW5nKDMpXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBsYW5kbGluZSBudW1iZXJzXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBob25lIC0gQ2xlYW4gcGhvbmUgbnVtYmVyXHJcbiAgICogQHJldHVybnMge09iamVjdH0gTGFuZGxpbmUgdmFsaWRhdGlvbiByZXN1bHRcclxuICAgKi9cclxuICB2YWxpZGF0ZUxhbmRsaW5lTnVtYmVyKHBob25lKSB7XHJcbiAgICAvLyBMYW5kbGluZSBwYXR0ZXJuc1xyXG4gICAgY29uc3QgbGFuZGxpbmVQYXR0ZXJucyA9IFtcclxuICAgICAgL15cXCs4ODAyWzEtOV1cXGR7N30kLywgLy8gSW50ZXJuYXRpb25hbDogKzg4MDJYWFhYWFhYWFxyXG4gICAgICAvXjg4MDJbMS05XVxcZHs3fSQvLCAvLyBXaXRob3V0ICs6IDg4MDJYWFhYWFhYWFxyXG4gICAgICAvXjAyWzEtOV1cXGR7N30kLywgLy8gTG9jYWw6IDAyWFhYWFhYWFhcclxuICAgIF07XHJcblxyXG4gICAgaWYgKCFsYW5kbGluZVBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QocGhvbmUpKSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnSW52YWxpZCBsYW5kbGluZSBudW1iZXIgZm9ybWF0JyxcclxuICAgICAgICBlcnJvckJuOiAn4KaF4Kas4KeI4KanIOCmsuCnjeCmr+CmvuCmqOCnjeCmoeCmsuCmvuCmh+CmqCDgpqjgpq7gp43gpqzgprAg4Kar4Kaw4Kau4KeN4Kav4Ka+4KafJyxcclxuICAgICAgICBjb2RlOiAnSU5WQUxJRF9MQU5ETElORV9GT1JNQVQnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTm9ybWFsaXplIHRvIGludGVybmF0aW9uYWwgZm9ybWF0XHJcbiAgICBsZXQgbm9ybWFsaXplZFBob25lID0gcGhvbmU7XHJcbiAgICBpZiAocGhvbmUuc3RhcnRzV2l0aCgnMDInKSkge1xyXG4gICAgICBub3JtYWxpemVkUGhvbmUgPSBgKzg4MCR7cGhvbmV9YDtcclxuICAgIH0gZWxzZSBpZiAocGhvbmUuc3RhcnRzV2l0aCgnODgwMicpKSB7XHJcbiAgICAgIG5vcm1hbGl6ZWRQaG9uZSA9IGArJHtwaG9uZX1gO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4dHJhY3QgYXJlYSBjb2RlXHJcbiAgICBsZXQgYXJlYUNvZGU7XHJcbiAgICBpZiAobm9ybWFsaXplZFBob25lLnN0YXJ0c1dpdGgoJys4ODAyJykpIHtcclxuICAgICAgYXJlYUNvZGUgPSBub3JtYWxpemVkUGhvbmUuc3Vic3RyaW5nKDMsIDUpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGFyZWFJbmZvID0gdGhpcy5sYW5kbGluZUFyZWFDb2Rlc1thcmVhQ29kZV07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogdHJ1ZSxcclxuICAgICAgdHlwZTogJ2xhbmRsaW5lJyxcclxuICAgICAgZm9ybWF0OiB0aGlzLmRldGVjdEZvcm1hdChwaG9uZSksXHJcbiAgICAgIG5vcm1hbGl6ZWRQaG9uZSxcclxuICAgICAgYXJlYUNvZGUsXHJcbiAgICAgIGFyZWFJbmZvOiBhcmVhSW5mbyB8fCB7XHJcbiAgICAgICAgYXJlYTogJ1Vua25vd24nLFxyXG4gICAgICAgIHJlZ2lvbjogJ1Vua25vd24nXHJcbiAgICAgIH0sXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgbGVuZ3RoOiBub3JtYWxpemVkUGhvbmUubGVuZ3RoLFxyXG4gICAgICAgIGNvdW50cnlDb2RlOiAnKzg4MCcsXHJcbiAgICAgICAgbnVtYmVyV2l0aG91dENvdW50cnk6IG5vcm1hbGl6ZWRQaG9uZS5zdWJzdHJpbmcoMylcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIHNwZWNpYWwgbnVtYmVycyAoZW1lcmdlbmN5LCB0b2xsLWZyZWUsIGV0Yy4pXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBob25lIC0gQ2xlYW4gcGhvbmUgbnVtYmVyXHJcbiAgICogQHJldHVybnMge09iamVjdH0gU3BlY2lhbCBudW1iZXIgdmFsaWRhdGlvbiByZXN1bHRcclxuICAgKi9cclxuICB2YWxpZGF0ZVNwZWNpYWxOdW1iZXJzKHBob25lKSB7XHJcbiAgICBmb3IgKGNvbnN0IFt0eXBlLCBpbmZvXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnNwZWNpYWxOdW1iZXJzKSkge1xyXG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgaW5mby5wYXR0ZXJucykge1xyXG4gICAgICAgIGlmIChwYXR0ZXJuLnRlc3QocGhvbmUpKSB7XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpc1ZhbGlkOiB0cnVlLFxyXG4gICAgICAgICAgICB0eXBlOiAnc3BlY2lhbCcsXHJcbiAgICAgICAgICAgIHNwZWNpYWxUeXBlOiB0eXBlLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogaW5mby5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgbm9ybWFsaXplZFBob25lOiBwaG9uZSxcclxuICAgICAgICAgICAgZXhhbXBsZXM6IGluZm8uZXhhbXBsZXMsXHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgICAgbGVuZ3RoOiBwaG9uZS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgY2F0ZWdvcnk6IHR5cGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdOb3QgYSByZWNvZ25pemVkIHNwZWNpYWwgbnVtYmVyJyxcclxuICAgICAgICBlcnJvckJuOiAn4Ka44KeN4Kas4KeA4KaV4KeD4KakIOCmrOCmv+CmtuCnh+CmtyDgpqjgpq7gp43gpqzgprAg4Kao4Kav4Ka8JyxcclxuICAgICAgY29kZTogJ0lOVkFMSURfU1BFQ0lBTF9GT1JNQVQnXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGV0ZWN0IHBob25lIG51bWJlciBmb3JtYXRcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGhvbmUgLSBQaG9uZSBudW1iZXJcclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBGb3JtYXQgdHlwZVxyXG4gICAqL1xyXG4gIGRldGVjdEZvcm1hdChwaG9uZSkge1xyXG4gICAgaWYgKHBob25lLnN0YXJ0c1dpdGgoJys4ODAnKSkgcmV0dXJuICdpbnRlcm5hdGlvbmFsJztcclxuICAgIGlmIChwaG9uZS5zdGFydHNXaXRoKCc4ODAnKSkgcmV0dXJuICdjb3VudHJ5X2NvZGUnO1xyXG4gICAgaWYgKHBob25lLnN0YXJ0c1dpdGgoJzAxJykpIHJldHVybiAnbG9jYWwnO1xyXG4gICAgcmV0dXJuICd1bmtub3duJztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBmb3JtYXQgc3VnZ2VzdGlvbnMgZm9yIGludmFsaWQgbnVtYmVyc1xyXG4gICAqIEByZXR1cm5zIHtBcnJheX0gRm9ybWF0IHN1Z2dlc3Rpb25zXHJcbiAgICovXHJcbiAgZ2V0Rm9ybWF0U3VnZ2VzdGlvbnMoKSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICAnKzg4MDFYWFhYWFhYWFggKEludGVybmF0aW9uYWwgZm9ybWF0KScsXHJcbiAgICAgICcwMVhYWFhYWFhYWCAoTG9jYWwgZm9ybWF0KScsXHJcbiAgICAgICcrODgwMlhYWFhYWFhYIChMYW5kbGluZSBpbnRlcm5hdGlvbmFsKScsXHJcbiAgICAgICcwMlhYWFhYWFhYIChMYW5kbGluZSBsb2NhbCknXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHZhbGlkIGV4YW1wbGVzXHJcbiAgICogQHJldHVybnMge0FycmF5fSBWYWxpZCBleGFtcGxlc1xyXG4gICAqL1xyXG4gIGdldFZhbGlkRXhhbXBsZXMoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBtb2JpbGU6IFtcclxuICAgICAgICAnKzg4MDE3MTIzNDU2NzgnLFxyXG4gICAgICAgICcwMTcxMjM0NTY3OCcsXHJcbiAgICAgICAgJys4ODAxODEyMzQ1Njc4JyxcclxuICAgICAgICAnMDE4MTIzNDU2NzgnXHJcbiAgICAgIF0sXHJcbiAgICAgIGxhbmRsaW5lOiBbXHJcbiAgICAgICAgJys4ODAyMTIzNDU2NzgnLFxyXG4gICAgICAgICcwMjEyMzQ1Njc4JyxcclxuICAgICAgICAnKzg4MDMxMTIzNDU2NycsXHJcbiAgICAgICAgJzAzMTEyMzQ1NjcnXHJcbiAgICAgIF1cclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBOb3JtYWxpemUgcGhvbmUgbnVtYmVyIHRvIGludGVybmF0aW9uYWwgZm9ybWF0XHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHBob25lIC0gUGhvbmUgbnVtYmVyIHRvIG5vcm1hbGl6ZVxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd8bnVsbH0gTm9ybWFsaXplZCBwaG9uZSBudW1iZXIgb3IgbnVsbCBpZiBpbnZhbGlkXHJcbiAgICovXHJcbiAgbm9ybWFsaXplUGhvbmVOdW1iZXIocGhvbmUpIHtcclxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQmFuZ2xhZGVzaFBob25lTnVtYmVyKHBob25lKTtcclxuICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbGlkYXRpb24ubm9ybWFsaXplZFBob25lO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRm9ybWF0IHBob25lIG51bWJlciBmb3IgZGlzcGxheVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwaG9uZSAtIFBob25lIG51bWJlciB0byBmb3JtYXRcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gZm9ybWF0IC0gRGVzaXJlZCBmb3JtYXQgKCdpbnRlcm5hdGlvbmFsJywgJ2xvY2FsJywgJ2Rpc3BsYXknKVxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IEZvcm1hdHRlZCBwaG9uZSBudW1iZXJcclxuICAgKi9cclxuICBmb3JtYXRQaG9uZU51bWJlcihwaG9uZSwgZm9ybWF0ID0gJ2Rpc3BsYXknKSB7XHJcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUJhbmdsYWRlc2hQaG9uZU51bWJlcihwaG9uZSk7XHJcbiAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICByZXR1cm4gcGhvbmU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHZhbGlkYXRpb24ubm9ybWFsaXplZFBob25lO1xyXG4gICAgXHJcbiAgICBzd2l0Y2ggKGZvcm1hdCkge1xyXG4gICAgICBjYXNlICdpbnRlcm5hdGlvbmFsJzpcclxuICAgICAgICByZXR1cm4gbm9ybWFsaXplZDtcclxuICAgICAgXHJcbiAgICAgIGNhc2UgJ2xvY2FsJzpcclxuICAgICAgICBpZiAobm9ybWFsaXplZC5zdGFydHNXaXRoKCcrODgwJykpIHtcclxuICAgICAgICAgIHJldHVybiBub3JtYWxpemVkLnN1YnN0cmluZygzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQ7XHJcbiAgICAgIFxyXG4gICAgICBjYXNlICdkaXNwbGF5JzpcclxuICAgICAgICBpZiAodmFsaWRhdGlvbi50eXBlID09PSAnbW9iaWxlJykge1xyXG4gICAgICAgICAgaWYgKG5vcm1hbGl6ZWQuc3RhcnRzV2l0aCgnKzg4MCcpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3QgPSBub3JtYWxpemVkLnN1YnN0cmluZyg0KTtcclxuICAgICAgICAgICAgcmV0dXJuIGArODgwICR7cmVzdC5zbGljZSgwLCAzKX0gJHtyZXN0LnNsaWNlKDMsIDYpfSAke3Jlc3Quc2xpY2UoNiwgMTApfWA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWxpZGF0aW9uLnR5cGUgPT09ICdsYW5kbGluZScpIHtcclxuICAgICAgICAgIGlmIChub3JtYWxpemVkLnN0YXJ0c1dpdGgoJys4ODAnKSkge1xyXG4gICAgICAgICAgICBjb25zdCByZXN0ID0gbm9ybWFsaXplZC5zdWJzdHJpbmcoNCk7XHJcbiAgICAgICAgICAgIHJldHVybiBgKzg4MCAke3Jlc3Quc2xpY2UoMCwgMil9ICR7cmVzdC5zbGljZSgyLCA2KX0gJHtyZXN0LnNsaWNlKDYsIDEwKX1gO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbm9ybWFsaXplZDtcclxuICAgICAgXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgb3BlcmF0b3IgaW5mb3JtYXRpb25cclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGhvbmUgLSBQaG9uZSBudW1iZXJcclxuICAgKiBAcmV0dXJucyB7T2JqZWN0fG51bGx9IE9wZXJhdG9yIGluZm9ybWF0aW9uXHJcbiAgICovXHJcbiAgZ2V0T3BlcmF0b3JJbmZvKHBob25lKSB7XHJcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZUJhbmdsYWRlc2hQaG9uZU51bWJlcihwaG9uZSk7XHJcbiAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCB8fCB2YWxpZGF0aW9uLnR5cGUgIT09ICdtb2JpbGUnKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG9wZXJhdG9yOiB2YWxpZGF0aW9uLm9wZXJhdG9yLFxyXG4gICAgICBwcmVmaXg6IHZhbGlkYXRpb24ub3BlcmF0b3JEZXRhaWxzLnByZWZpeCxcclxuICAgICAgbmV0d29yazogdmFsaWRhdGlvbi5uZXR3b3JrLFxyXG4gICAgICBjb2xvcjogdmFsaWRhdGlvbi5vcGVyYXRvckRldGFpbHMuY29sb3IsXHJcbiAgICAgIGxvZ286IHZhbGlkYXRpb24ub3BlcmF0b3JEZXRhaWxzLmxvZ28sXHJcbiAgICAgIGlzUG9ydGVkOiB2YWxpZGF0aW9uLmlzUG9ydGVkXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgcGhvbmUgbnVtYmVyIGlzIGZyb20gYSBzcGVjaWZpYyBvcGVyYXRvclxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwaG9uZSAtIFBob25lIG51bWJlclxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBvcGVyYXRvciAtIE9wZXJhdG9yIG5hbWVcclxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBtYXRjaGVzIG9wZXJhdG9yXHJcbiAgICovXHJcbiAgaXNPcGVyYXRvcihwaG9uZSwgb3BlcmF0b3IpIHtcclxuICAgIGNvbnN0IG9wZXJhdG9ySW5mbyA9IHRoaXMuZ2V0T3BlcmF0b3JJbmZvKHBob25lKTtcclxuICAgIGlmICghb3BlcmF0b3JJbmZvKSByZXR1cm4gZmFsc2U7XHJcbiAgICBcclxuICAgIHJldHVybiBvcGVyYXRvckluZm8ub3BlcmF0b3IudG9Mb3dlckNhc2UoKSA9PT0gb3BlcmF0b3IudG9Mb3dlckNhc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgc3VwcG9ydGVkIG9wZXJhdG9yc1xyXG4gICAqIEByZXR1cm5zIHtBcnJheX0gTGlzdCBvZiBzdXBwb3J0ZWQgb3BlcmF0b3JzXHJcbiAgICovXHJcbiAgZ2V0U3VwcG9ydGVkT3BlcmF0b3JzKCkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHRoaXMubW9iaWxlT3BlcmF0b3JzKS5tYXAoKFtwcmVmaXgsIGluZm9dKSA9PiAoe1xyXG4gICAgICBwcmVmaXgsXHJcbiAgICAgIG5hbWU6IGluZm8ubmFtZSxcclxuICAgICAgbmV0d29yazogaW5mby5uZXR3b3JrLFxyXG4gICAgICBjb2xvcjogaW5mby5jb2xvcixcclxuICAgICAgbG9nbzogaW5mby5sb2dvXHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYWxsIHN1cHBvcnRlZCBsYW5kbGluZSBhcmVhc1xyXG4gICAqIEByZXR1cm5zIHtBcnJheX0gTGlzdCBvZiBzdXBwb3J0ZWQgYXJlYXNcclxuICAgKi9cclxuICBnZXRTdXBwb3J0ZWRMYW5kbGluZUFyZWFzKCkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHRoaXMubGFuZGxpbmVBcmVhQ29kZXMpLm1hcCgoW2NvZGUsIGluZm9dKSA9PiAoe1xyXG4gICAgICBjb2RlLFxyXG4gICAgICBhcmVhOiBpbmZvLmFyZWEsXHJcbiAgICAgIHJlZ2lvbjogaW5mby5yZWdpb25cclxuICAgIH0pKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZhbGlkYXRlIHBob25lIG51bWJlciBmb3Igc3BlY2lmaWMgdXNlIGNhc2VcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGhvbmUgLSBQaG9uZSBudW1iZXJcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gdXNlQ2FzZSAtIFVzZSBjYXNlICgncmVnaXN0cmF0aW9uJywgJ290cCcsICdzbXMnLCAndmVyaWZpY2F0aW9uJywgJ2xvZ2luJylcclxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBWYWxpZGF0aW9uIHJlc3VsdCB3aXRoIHVzZS1jYXNlIHNwZWNpZmljIHJ1bGVzXHJcbiAgICovXHJcbiAgdmFsaWRhdGVGb3JVc2VDYXNlKHBob25lLCB1c2VDYXNlKSB7XHJcbiAgICBjb25zdCBiYXNlVmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVCYW5nbGFkZXNoUGhvbmVOdW1iZXIocGhvbmUsIHtcclxuICAgICAgYWxsb3dMYW5kbGluZTogdXNlQ2FzZSAhPT0gJ290cCcgJiYgdXNlQ2FzZSAhPT0gJ3NtcycgJiYgdXNlQ2FzZSAhPT0gJ2xvZ2luJyxcclxuICAgICAgYWxsb3dNb2JpbGU6IHRydWUsXHJcbiAgICAgIGFsbG93U3BlY2lhbDogZmFsc2VcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghYmFzZVZhbGlkYXRpb24uaXNWYWxpZCkge1xyXG4gICAgICByZXR1cm4gYmFzZVZhbGlkYXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXNlLWNhc2Ugc3BlY2lmaWMgdmFsaWRhdGlvbnNcclxuICAgIHN3aXRjaCAodXNlQ2FzZSkge1xyXG4gICAgICBjYXNlICdyZWdpc3RyYXRpb24nOlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5iYXNlVmFsaWRhdGlvbixcclxuICAgICAgICAgIGNhblJlY2VpdmVTTVM6IGJhc2VWYWxpZGF0aW9uLnR5cGUgPT09ICdtb2JpbGUnLFxyXG4gICAgICAgICAgY2FuUmVjZWl2ZU9UUDogYmFzZVZhbGlkYXRpb24udHlwZSA9PT0gJ21vYmlsZScsXHJcbiAgICAgICAgICByZXF1aXJlc1ZlcmlmaWNhdGlvbjogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBjYXNlICdvdHAnOlxyXG4gICAgICBjYXNlICdzbXMnOlxyXG4gICAgICAgIGlmIChiYXNlVmFsaWRhdGlvbi50eXBlICE9PSAnbW9iaWxlJykge1xyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaXNWYWxpZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGVycm9yOiAnT25seSBtb2JpbGUgbnVtYmVycyBjYW4gcmVjZWl2ZSBTTVMvT1RQJyxcclxuICAgICAgICAgICAgZXJyb3JCbjogJ+CmtuCngeCmp+CngeCmruCmvuCmpOCnjeCmsOCmruCmvuCmpOCnjeCmsCDgpq7gp4vgpqzgpr7gpofgprIg4Kao4Kau4KeN4Kas4KawIFNNUy9PVFAg4Kaq4KeH4Kak4KeHIOCmquCmvuCmsOCnhycsXHJcbiAgICAgICAgICAgIGNvZGU6ICdNT0JJTEVfT05MWSdcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiYXNlVmFsaWRhdGlvbjtcclxuICAgICAgXHJcbiAgICAgIGNhc2UgJ2xvZ2luJzpcclxuICAgICAgICBpZiAoYmFzZVZhbGlkYXRpb24udHlwZSAhPT0gJ21vYmlsZScpIHtcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlcnJvcjogJ09ubHkgbW9iaWxlIG51bWJlcnMgY2FuIGJlIHVzZWQgZm9yIGxvZ2luJyxcclxuICAgICAgICAgICAgZXJyb3JCbjogJ+CmtuCngeCmp+CngeCmruCmvuCmpOCnjeCmsOCmruCmvuCmpOCnjeCmsCDgpq7gp4vgpqzgpr7gpofgprIg4Kao4Kau4KeN4Kas4KawIOCmpuCmv+Cmr+CmvOCnhyDgprLgppfgpr/gpqgg4KaV4Kaw4Ka+IOCmr+CmvuCmr+CmvCcsXHJcbiAgICAgICAgICAgIGNvZGU6ICdNT0JJTEVfT05MWSdcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5iYXNlVmFsaWRhdGlvbixcclxuICAgICAgICAgIGNhbkxvZ2luOiB0cnVlLFxyXG4gICAgICAgICAgcmVxdWlyZXNWZXJpZmljYXRpb246IGZhbHNlIC8vIFBob25lIHNob3VsZCBhbHJlYWR5IGJlIHZlcmlmaWVkIGZvciBsb2dpblxyXG4gICAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBjYXNlICd2ZXJpZmljYXRpb24nOlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5iYXNlVmFsaWRhdGlvbixcclxuICAgICAgICAgIGlzVmVyaWZpYWJsZTogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBiYXNlVmFsaWRhdGlvbjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlIHZhbGlkYXRpb24gc3RhdGlzdGljc1xyXG4gICAqIEBwYXJhbSB7QXJyYXl9IHBob25lTnVtYmVycyAtIEFycmF5IG9mIHBob25lIG51bWJlcnMgdG8gYW5hbHl6ZVxyXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFN0YXRpc3RpY3MgYWJvdXQgcGhvbmUgbnVtYmVyc1xyXG4gICAqL1xyXG4gIGdlbmVyYXRlVmFsaWRhdGlvblN0YXRzKHBob25lTnVtYmVycykge1xyXG4gICAgY29uc3Qgc3RhdHMgPSB7XHJcbiAgICAgIHRvdGFsOiBwaG9uZU51bWJlcnMubGVuZ3RoLFxyXG4gICAgICB2YWxpZDogMCxcclxuICAgICAgaW52YWxpZDogMCxcclxuICAgICAgbW9iaWxlOiAwLFxyXG4gICAgICBsYW5kbGluZTogMCxcclxuICAgICAgc3BlY2lhbDogMCxcclxuICAgICAgb3BlcmF0b3JzOiB7fSxcclxuICAgICAgYXJlYXM6IHt9LFxyXG4gICAgICBmb3JtYXRzOiB7XHJcbiAgICAgICAgaW50ZXJuYXRpb25hbDogMCxcclxuICAgICAgICBsb2NhbDogMCxcclxuICAgICAgICBjb3VudHJ5X2NvZGU6IDBcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBwaG9uZU51bWJlcnMuZm9yRWFjaChwaG9uZSA9PiB7XHJcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQmFuZ2xhZGVzaFBob25lTnVtYmVyKHBob25lKTtcclxuICAgICAgXHJcbiAgICAgIGlmICh2YWxpZGF0aW9uLmlzVmFsaWQpIHtcclxuICAgICAgICBzdGF0cy52YWxpZCsrO1xyXG4gICAgICAgIHN0YXRzW3ZhbGlkYXRpb24udHlwZV0rKztcclxuICAgICAgICBzdGF0cy5mb3JtYXRzW3ZhbGlkYXRpb24uZm9ybWF0XSsrO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh2YWxpZGF0aW9uLm9wZXJhdG9yKSB7XHJcbiAgICAgICAgICBzdGF0cy5vcGVyYXRvcnNbdmFsaWRhdGlvbi5vcGVyYXRvcl0gPSAoc3RhdHMub3BlcmF0b3JzW3ZhbGlkYXRpb24ub3BlcmF0b3JdIHx8IDApICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlYUNvZGUpIHtcclxuICAgICAgICAgIHN0YXRzLmFyZWFzW3ZhbGlkYXRpb24uYXJlYUNvZGVdID0gKHN0YXRzLmFyZWFzW3ZhbGlkYXRpb24uYXJlYUNvZGVdIHx8IDApICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc3RhdHMuaW52YWxpZCsrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gc3RhdHM7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBTaW5nbGV0b24gaW5zdGFuY2VcclxuY29uc3QgcGhvbmVWYWxpZGF0aW9uU2VydmljZSA9IG5ldyBQaG9uZVZhbGlkYXRpb25TZXJ2aWNlKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBQaG9uZVZhbGlkYXRpb25TZXJ2aWNlLFxyXG4gIHBob25lVmFsaWRhdGlvblNlcnZpY2VcclxufTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLGFBQWEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUV6QyxNQUFNQyxzQkFBc0IsQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQSxFQUFHO0lBQ1osSUFBSSxDQUFDQyxNQUFNLEdBQUdKLGFBQWE7O0lBRTNCO0lBQ0EsSUFBSSxDQUFDSyxlQUFlLEdBQUc7TUFDckIsS0FBSyxFQUFFO1FBQ0xDLElBQUksRUFBRSxVQUFVO1FBQ2hCQyxPQUFPLEVBQUUsT0FBTztRQUNoQkMsS0FBSyxFQUFFLFNBQVM7UUFDaEJDLElBQUksRUFBRTtNQUNSLENB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RUFBRSxDQUFDO01BQ1JDLE9BQU8sRUFBRSxDQUFDO01BQ1YzQixNQUFNLEVBQUUsQ0FBQztNQUNUQyxRQUFRLEVBQUUsQ0FBQztNQUNYMkIsT0FBTyxFQUFFLENBQUM7TUFDVkMsU0FBUyxFQUFFLENBQUMsQ0FBQztNQUNiQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO01BQ1RDLE9BQU8sRUFBRTtRQUNQQyxhQUFhLEVBQUUsQ0FBQztRQUNoQkMsS0FBSyxFQUFFLENBQUM7UUFDUkMsWUFBWSxFQUFFO01BQ2hCO0lBQ0YsQ0FBQztJQUVEWCxZQUFZLENBQUNZLE9BQU8sQ0FBQ3hGLEtBQUssSUFBSTtNQUM1QixNQUFNd0QsVUFBVSxHQUFHLElBQUksQ0FBQ3pELDZCQUE2QixDQUFDQyxLQUFLLENBQUM7TUFFNUQsSUFBSXdELFVBQVUsQ0FBQ2xELE9BQU8sRUFBRTtRQUN0QnVFLEtBQUssQ0FBQ0UsS0FBSyxFQUFFO1FBQ2JGLEtBQUssQ0FBQ3JCLFVBQVUsQ0FBQ25CLElBQUksQ0FBQyxFQUFFO1FBQ3hCd0MsS0FBSyxDQUFDTyxPQUFPLENBQUM1QixVQUFVLENBQUNsQixNQUFNLENBQUMsRUFBRTtRQUVsQyxJQUFJa0IsVUFBVSxDQUFDekIsUUFBUSxFQUFFO1VBQ3ZCOEMsS0FBSyxDQUFDSyxTQUFTLENBQUMxQixVQUFVLENBQUN6QixRQUFRLENBQUMsR0FBRyxDQUFDOEMsS0FBSyxDQUFDSyxTQUFTLENBQUMxQixVQUFVLENBQUN6QixRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztRQUN4RjtRQUVBLElBQUl5QixVQUFVLENBQUNULFFBQVEsRUFBRTtVQUN2QjhCLEtBQUssQ0FBQ00sS0FBSyxDQUFDM0IsVUFBVSxDQUFDVCxRQUFRLENBQUMsR0FBRyxDQUFDOEIsS0FBSyxDQUFDTSxLQUFLLENBQUMzQixVQUFVLENBQUNULFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQ2hGO01BQ0YsQ0FBQyxNQUFNO1FBQ0w4QixLQUFLLENBQUNHLE9BQU8sRUFBRTtNQUNqQjtJQUNGLENBQUMsQ0FBQztJQUVGLE9BQU9ILEtBQUs7RUFDZDtBQUNGOztBQUVBO0FBQ0EsTUFBTVksc0JBQXNCLEdBQUcsSUFBSTdHLHNCQUFzQixDQUFDLENBQUM7QUFFM0Q4RyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUNmL0csc0JBQXNCO0VBQ3RCNkc7QUFDRixDQUFDIiwiaWdub3JlTGlzdCI6W119