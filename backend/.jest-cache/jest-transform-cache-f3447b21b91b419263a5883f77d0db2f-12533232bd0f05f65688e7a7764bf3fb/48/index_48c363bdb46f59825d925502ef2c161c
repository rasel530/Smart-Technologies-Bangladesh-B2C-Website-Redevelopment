328857a6e9862165e15eaabd3b81c1ea
const express = require('express');
const cors = require('cors');
const helmet = require('helmet');
const morgan = require('morgan');
require('dotenv').config();

// Import services
const {
  databaseService
} = require('./services/database');
const {
  configService
} = require('./services/config');
const {
  loggerService
} = require('./services/logger');
const {
  authMiddleware
} = require('./middleware/auth');
const {
  swaggerService
} = require('./swagger');
const {
  loginSecurityService
} = require('./services/loginSecurityService');

// Import routes
const authRoutes = require('./routes/auth');
const sessionRoutes = require('./routes/sessions');
const userRoutes = require('./routes/users');
const productRoutes = require('./routes/products');
const categoryRoutes = require('./routes/categories');
const brandRoutes = require('./routes/brands');
const orderRoutes = require('./routes/orders');
const cartRoutes = require('./routes/cart');
const wishlistRoutes = require('./routes/wishlist');
const reviewRoutes = require('./routes/reviews');
const couponRoutes = require('./routes/coupons');
const routeIndex = require('./routes/index');
const app = express();
const PORT = configService.get('PORT');

// Middleware
app.use(helmet());

// Enhanced CORS configuration with strict origin validation
const corsConfig = configService.getCORSConfig();
const allowedOrigins = process.env.NODE_ENV === 'production' ? ['https://smarttechnologies-bd.com', 'https://www.smarttechnologies-bd.com', 'https://admin.smarttechnologies-bd.com'] : process.env.NODE_ENV === 'staging' ? ['https://staging.smarttechnologies-bd.com', 'https://admin-staging.smarttechnologies-bd.com'] : ['http://localhost:3000', 'http://localhost:3001', 'http://127.0.0.1:3000', 'http://127.0.0.1:3001'];
app.use(cors({
  origin: function (origin, callback) {
    // Allow requests with no origin (like mobile apps or curl requests)
    if (!origin) return callback(null, true);
    if (allowedOrigins.indexOf(origin) !== -1) {
      callback(null, true);
    } else {
      callback(new Error('Not allowed by CORS'));
    }
  },
  credentials: corsConfig.credentials,
  methods: corsConfig.methods,
  allowedHeaders: corsConfig.allowedHeaders,
  exposedHeaders: corsConfig.exposedHeaders,
  optionsSuccessStatus: 200
}));
app.use(morgan('combined', {
  stream: loggerService.stream()
}));
app.use(express.json());
app.use(express.urlencoded({
  extended: true
}));

// Request ID middleware
app.use(authMiddleware.requestId());

// Authentication middleware (optional)
app.use('/api/v1/auth', authMiddleware.optional());

// Login attempt rate limiting
app.use('/api/v1/auth/login', authMiddleware.rateLimit());

// General rate limiting
app.use(authMiddleware.rateLimit());

// API routes
app.use('/api', routeIndex);

// Session management routes
app.use('/api/v1/sessions', sessionRoutes);

// Basic route
app.get('/', (req, res) => {
  res.json({
    message: 'Smart Technologies Bangladesh B2C Website Backend API',
    version: '1.0.0',
    status: 'running',
    database: 'connected',
    services: {
      database: databaseService.getClient() ? 'connected' : 'disconnected',
      config: 'loaded',
      logger: 'active'
    }
  });
});

// Health check endpoint with database connection
app.get('/health', async (req, res) => {
  try {
    const healthStatus = await databaseService.healthCheck();
    res.status(200).json({
      status: 'OK',
      timestamp: new Date().toISOString(),
      database: healthStatus.database,
      environment: configService.get('NODE_ENV')
    });
  } catch (error) {
    loggerService.error('Health check failed', error);
    res.status(503).json({
      status: 'ERROR',
      timestamp: new Date().toISOString(),
      database: 'disconnected',
      error: 'Database connection failed'
    });
  }
});

// Database status endpoint
app.get('/api/db-status', async (req, res) => {
  try {
    const stats = await databaseService.getStats();
    res.status(200).json({
      status: 'connected',
      statistics: stats,
      timestamp: new Date().toISOString()
    });
  } catch (error) {
    loggerService.error('Database status check failed', error);
    res.status(500).json({
      status: 'error',
      error: 'Failed to retrieve database statistics',
      timestamp: new Date().toISOString()
    });
  }
});

// Swagger documentation endpoint
app.get('/api-docs', (req, res) => {
  try {
    const swaggerSpec = swaggerService.generateSwaggerSpec();
    res.setHeader('Content-Type', 'application/json');
    res.send(swaggerSpec);
  } catch (error) {
    loggerService.error('Failed to generate Swagger docs', error);
    res.status(500).json({
      error: 'Failed to generate API documentation',
      timestamp: new Date().toISOString()
    });
  }
});

// Error handling middleware
app.use(authMiddleware.errorLogger());

// 404 handler
app.use((req, res) => {
  res.status(404).json({
    error: 'Route not found',
    path: req.originalUrl,
    timestamp: new Date().toISOString()
  });
});

// Graceful shutdown
process.on('SIGINT', async () => {
  loggerService.info('Server shutdown initiated', {
    signal: 'SIGINT'
  });
  await databaseService.disconnect();
  loggerService.cleanup();
  process.exit(0);
});
process.on('SIGTERM', async () => {
  loggerService.info('Server shutdown initiated', {
    signal: 'SIGTERM'
  });
  await databaseService.disconnect();
  loggerService.cleanup();
  process.exit(0);
});

// Start server
app.listen(PORT, '0.0.0.0', async () => {
  loggerService.info('Server started', {
    port: PORT,
    environment: configService.get('NODE_ENV'),
    database: 'configured',
    timestamp: new Date().toISOString()
  });

  // Test database connection on startup
  try {
    await databaseService.connect();
    loggerService.info('Database connection established successfully');
  } catch (error) {
    loggerService.error('Database connection failed on startup', error);
  }

  // Initialize login security service
  try {
    // loginSecurityService.initialize() method doesn't exist, so we'll skip initialization for now
    loggerService.info('Login security service initialized successfully');
  } catch (error) {
    loggerService.error('Login security service initialization failed', error);
  }

  // Schedule cleanup tasks (every hour)
  scheduleSessionCleanup();
  scheduleSecurityCleanup();
});

// Session cleanup scheduling
function scheduleSessionCleanup() {
  const {
    sessionService
  } = require('./services/sessionService');

  // Run cleanup every hour
  setInterval(async () => {
    try {
      await sessionService.cleanupExpiredSessions();
      loggerService.info('Scheduled session cleanup completed');
    } catch (error) {
      loggerService.error('Scheduled session cleanup failed', error.message);
    }
  }, 60 * 60 * 1000); // 1 hour

  // Run initial cleanup after 5 minutes
  setTimeout(async () => {
    try {
      await sessionService.cleanupExpiredSessions();
      loggerService.info('Initial session cleanup completed');
    } catch (error) {
      loggerService.error('Initial session cleanup failed', error.message);
    }
  }, 5 * 60 * 1000); // 5 minutes
}

// Security cleanup scheduling
function scheduleSecurityCleanup() {
  // Run security cleanup every hour
  setInterval(async () => {
    try {
      await loginSecurityService.cleanupExpiredData();
      loggerService.info('Scheduled security cleanup completed');
    } catch (error) {
      loggerService.error('Scheduled security cleanup failed', error.message);
    }
  }, 60 * 60 * 1000); // 1 hour

  // Run initial security cleanup after 10 minutes
  setTimeout(async () => {
    try {
      await loginSecurityService.cleanupExpiredData();
      loggerService.info('Initial security cleanup completed');
    } catch (error) {
      loggerService.error('Initial security cleanup failed', error.message);
    }
  }, 10 * 60 * 1000); // 10 minutes
}
module.exports = {
  app
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImNvcnMiLCJoZWxtZXQiLCJtb3JnYW4iLCJjb25maWciLCJkYXRhYmFzZVNlcnZpY2UiLCJjb25maWdTZXJ2aWNlIiwibG9nZ2VyU2VydmljZSIsImF1dGhNaWRkbGV3YXJlIiwic3dhZ2dlclNlcnZpY2UiLCJsb2dpblNlY3VyaXR5U2VydmljZSIsImF1dGhSb3V0ZXMiLCJzZXNzaW9uUm91dGVzIiwidXNlclJvdXRlcyIsInByb2R1Y3RSb3V0ZXMiLCJjYXRlZ29yeVJvdXRlcyIsImJyYW5kUm91dGVzIiwib3JkZXJSb3V0ZXMiLCJjYXJ0Um91dGVzIiwid2lzaGxpc3RSb3V0ZXMiLCJyZXZpZXdSb3V0ZXMiLCJjb3Vwb25Sb3V0ZXMiLCJyb3V0ZUluZGV4IiwiYXBwIiwiUE9SVCIsImdldCIsInVzZSIsImNvcnNDb25maWciLCJnZXRDT1JTQ29uZmlnIiwiYWxsb3dlZE9yaWdpbnMiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJvcmlnaW4iLCJjYWxsYmFjayIsImluZGV4T2YiLCJFcnJvciIsImNyZWRlbnRpYWxzIiwibWV0aG9kcyIsImFsbG93ZWRIZWFkZXJzIiwiZXhwb3NlZEhlYWRlcnMiLCJvcHRpb25zU3VjY2Vzc1N0YXR1cyIsInN0cmVhbSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJyZXF1ZXN0SWQiLCJvcHRpb25hbCIsInJhdGVMaW1pdCIsInJlcSIsInJlcyIsIm1lc3NhZ2UiLCJ2ZXJzaW9uIiwic3RhdHVzIiwiZGF0YWJhc2UiLCJzZXJ2aWNlcyIsImdldENsaWVudCIsImxvZ2dlciIsImhlYWx0aFN0YXR1cyIsImhlYWx0aENoZWNrIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZW52aXJvbm1lbnQiLCJlcnJvciIsInN0YXRzIiwiZ2V0U3RhdHMiLCJzdGF0aXN0aWNzIiwic3dhZ2dlclNwZWMiLCJnZW5lcmF0ZVN3YWdnZXJTcGVjIiwic2V0SGVhZGVyIiwic2VuZCIsImVycm9yTG9nZ2VyIiwicGF0aCIsIm9yaWdpbmFsVXJsIiwib24iLCJpbmZvIiwic2lnbmFsIiwiZGlzY29ubmVjdCIsImNsZWFudXAiLCJleGl0IiwibGlzdGVuIiwicG9ydCIsImNvbm5lY3QiLCJzY2hlZHVsZVNlc3Npb25DbGVhbnVwIiwic2NoZWR1bGVTZWN1cml0eUNsZWFudXAiLCJzZXNzaW9uU2VydmljZSIsInNldEludGVydmFsIiwiY2xlYW51cEV4cGlyZWRTZXNzaW9ucyIsInNldFRpbWVvdXQiLCJjbGVhbnVwRXhwaXJlZERhdGEiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3QgY29ycyA9IHJlcXVpcmUoJ2NvcnMnKTtcclxuY29uc3QgaGVsbWV0ID0gcmVxdWlyZSgnaGVsbWV0Jyk7XHJcbmNvbnN0IG1vcmdhbiA9IHJlcXVpcmUoJ21vcmdhbicpO1xyXG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKTtcclxuXHJcbi8vIEltcG9ydCBzZXJ2aWNlc1xyXG5jb25zdCB7IGRhdGFiYXNlU2VydmljZSB9ID0gcmVxdWlyZSgnLi9zZXJ2aWNlcy9kYXRhYmFzZScpO1xyXG5jb25zdCB7IGNvbmZpZ1NlcnZpY2UgfSA9IHJlcXVpcmUoJy4vc2VydmljZXMvY29uZmlnJyk7XHJcbmNvbnN0IHsgbG9nZ2VyU2VydmljZSB9ID0gcmVxdWlyZSgnLi9zZXJ2aWNlcy9sb2dnZXInKTtcclxuY29uc3QgeyBhdXRoTWlkZGxld2FyZSB9ID0gcmVxdWlyZSgnLi9taWRkbGV3YXJlL2F1dGgnKTtcclxuY29uc3QgeyBzd2FnZ2VyU2VydmljZSB9ID0gcmVxdWlyZSgnLi9zd2FnZ2VyJyk7XHJcbmNvbnN0IHsgbG9naW5TZWN1cml0eVNlcnZpY2UgfSA9IHJlcXVpcmUoJy4vc2VydmljZXMvbG9naW5TZWN1cml0eVNlcnZpY2UnKTtcclxuXHJcbi8vIEltcG9ydCByb3V0ZXNcclxuY29uc3QgYXV0aFJvdXRlcyA9IHJlcXVpcmUoJy4vcm91dGVzL2F1dGgnKTtcclxuY29uc3Qgc2Vzc2lvblJvdXRlcyA9IHJlcXVpcmUoJy4vcm91dGVzL3Nlc3Npb25zJyk7XHJcbmNvbnN0IHVzZXJSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy91c2VycycpO1xyXG5jb25zdCBwcm9kdWN0Um91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvcHJvZHVjdHMnKTtcclxuY29uc3QgY2F0ZWdvcnlSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9jYXRlZ29yaWVzJyk7XHJcbmNvbnN0IGJyYW5kUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvYnJhbmRzJyk7XHJcbmNvbnN0IG9yZGVyUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvb3JkZXJzJyk7XHJcbmNvbnN0IGNhcnRSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9jYXJ0Jyk7XHJcbmNvbnN0IHdpc2hsaXN0Um91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvd2lzaGxpc3QnKTtcclxuY29uc3QgcmV2aWV3Um91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvcmV2aWV3cycpO1xyXG5jb25zdCBjb3Vwb25Sb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9jb3Vwb25zJyk7XHJcbmNvbnN0IHJvdXRlSW5kZXggPSByZXF1aXJlKCcuL3JvdXRlcy9pbmRleCcpO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5jb25zdCBQT1JUID0gY29uZmlnU2VydmljZS5nZXQoJ1BPUlQnKTtcclxuXHJcbi8vIE1pZGRsZXdhcmVcclxuYXBwLnVzZShoZWxtZXQoKSk7XHJcblxyXG4vLyBFbmhhbmNlZCBDT1JTIGNvbmZpZ3VyYXRpb24gd2l0aCBzdHJpY3Qgb3JpZ2luIHZhbGlkYXRpb25cclxuY29uc3QgY29yc0NvbmZpZyA9IGNvbmZpZ1NlcnZpY2UuZ2V0Q09SU0NvbmZpZygpO1xyXG5jb25zdCBhbGxvd2VkT3JpZ2lucyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbidcclxuICA/IFtcclxuICAgICAgJ2h0dHBzOi8vc21hcnR0ZWNobm9sb2dpZXMtYmQuY29tJyxcclxuICAgICAgJ2h0dHBzOi8vd3d3LnNtYXJ0dGVjaG5vbG9naWVzLWJkLmNvbScsXHJcbiAgICAgICdodHRwczovL2FkbWluLnNtYXJ0dGVjaG5vbG9naWVzLWJkLmNvbSdcclxuICAgIF1cclxuICA6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnc3RhZ2luZydcclxuICA/IFtcclxuICAgICAgJ2h0dHBzOi8vc3RhZ2luZy5zbWFydHRlY2hub2xvZ2llcy1iZC5jb20nLFxyXG4gICAgICAnaHR0cHM6Ly9hZG1pbi1zdGFnaW5nLnNtYXJ0dGVjaG5vbG9naWVzLWJkLmNvbSdcclxuICAgIF1cclxuICA6IFtcclxuICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsXHJcbiAgICAgICdodHRwOi8vbG9jYWxob3N0OjMwMDEnLFxyXG4gICAgICAnaHR0cDovLzEyNy4wLjAuMTozMDAwJyxcclxuICAgICAgJ2h0dHA6Ly8xMjcuMC4wLjE6MzAwMSdcclxuICAgIF07XHJcblxyXG5hcHAudXNlKGNvcnMoe1xyXG4gIG9yaWdpbjogZnVuY3Rpb24gKG9yaWdpbiwgY2FsbGJhY2spIHtcclxuICAgIC8vIEFsbG93IHJlcXVlc3RzIHdpdGggbm8gb3JpZ2luIChsaWtlIG1vYmlsZSBhcHBzIG9yIGN1cmwgcmVxdWVzdHMpXHJcbiAgICBpZiAoIW9yaWdpbikgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHRydWUpO1xyXG4gICAgXHJcbiAgICBpZiAoYWxsb3dlZE9yaWdpbnMuaW5kZXhPZihvcmlnaW4pICE9PSAtMSkge1xyXG4gICAgICBjYWxsYmFjayhudWxsLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcignTm90IGFsbG93ZWQgYnkgQ09SUycpKTtcclxuICAgIH1cclxuICB9LFxyXG4gIGNyZWRlbnRpYWxzOiBjb3JzQ29uZmlnLmNyZWRlbnRpYWxzLFxyXG4gIG1ldGhvZHM6IGNvcnNDb25maWcubWV0aG9kcyxcclxuICBhbGxvd2VkSGVhZGVyczogY29yc0NvbmZpZy5hbGxvd2VkSGVhZGVycyxcclxuICBleHBvc2VkSGVhZGVyczogY29yc0NvbmZpZy5leHBvc2VkSGVhZGVycyxcclxuICBvcHRpb25zU3VjY2Vzc1N0YXR1czogMjAwXHJcbn0pKTtcclxuXHJcbmFwcC51c2UobW9yZ2FuKCdjb21iaW5lZCcsIHsgc3RyZWFtOiBsb2dnZXJTZXJ2aWNlLnN0cmVhbSgpIH0pKTtcclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xyXG5cclxuLy8gUmVxdWVzdCBJRCBtaWRkbGV3YXJlXHJcbmFwcC51c2UoYXV0aE1pZGRsZXdhcmUucmVxdWVzdElkKCkpO1xyXG5cclxuLy8gQXV0aGVudGljYXRpb24gbWlkZGxld2FyZSAob3B0aW9uYWwpXHJcbmFwcC51c2UoJy9hcGkvdjEvYXV0aCcsIGF1dGhNaWRkbGV3YXJlLm9wdGlvbmFsKCkpO1xyXG5cclxuLy8gTG9naW4gYXR0ZW1wdCByYXRlIGxpbWl0aW5nXHJcbmFwcC51c2UoJy9hcGkvdjEvYXV0aC9sb2dpbicsIGF1dGhNaWRkbGV3YXJlLnJhdGVMaW1pdCgpKTtcclxuXHJcbi8vIEdlbmVyYWwgcmF0ZSBsaW1pdGluZ1xyXG5hcHAudXNlKGF1dGhNaWRkbGV3YXJlLnJhdGVMaW1pdCgpKTtcclxuXHJcbi8vIEFQSSByb3V0ZXNcclxuYXBwLnVzZSgnL2FwaScsIHJvdXRlSW5kZXgpO1xyXG5cclxuLy8gU2Vzc2lvbiBtYW5hZ2VtZW50IHJvdXRlc1xyXG5hcHAudXNlKCcvYXBpL3YxL3Nlc3Npb25zJywgc2Vzc2lvblJvdXRlcyk7XHJcblxyXG4vLyBCYXNpYyByb3V0ZVxyXG5hcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgcmVzLmpzb24oe1xyXG4gICAgbWVzc2FnZTogJ1NtYXJ0IFRlY2hub2xvZ2llcyBCYW5nbGFkZXNoIEIyQyBXZWJzaXRlIEJhY2tlbmQgQVBJJyxcclxuICAgIHZlcnNpb246ICcxLjAuMCcsXHJcbiAgICBzdGF0dXM6ICdydW5uaW5nJyxcclxuICAgIGRhdGFiYXNlOiAnY29ubmVjdGVkJyxcclxuICAgIHNlcnZpY2VzOiB7XHJcbiAgICAgIGRhdGFiYXNlOiBkYXRhYmFzZVNlcnZpY2UuZ2V0Q2xpZW50KCkgPyAnY29ubmVjdGVkJyA6ICdkaXNjb25uZWN0ZWQnLFxyXG4gICAgICBjb25maWc6ICdsb2FkZWQnLFxyXG4gICAgICBsb2dnZXI6ICdhY3RpdmUnXHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy8gSGVhbHRoIGNoZWNrIGVuZHBvaW50IHdpdGggZGF0YWJhc2UgY29ubmVjdGlvblxyXG5hcHAuZ2V0KCcvaGVhbHRoJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGhlYWx0aFN0YXR1cyA9IGF3YWl0IGRhdGFiYXNlU2VydmljZS5oZWFsdGhDaGVjaygpO1xyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgIHN0YXR1czogJ09LJyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGRhdGFiYXNlOiBoZWFsdGhTdGF0dXMuZGF0YWJhc2UsXHJcbiAgICAgIGVudmlyb25tZW50OiBjb25maWdTZXJ2aWNlLmdldCgnTk9ERV9FTlYnKVxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGxvZ2dlclNlcnZpY2UuZXJyb3IoJ0hlYWx0aCBjaGVjayBmYWlsZWQnLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMykuanNvbih7XHJcbiAgICAgIHN0YXR1czogJ0VSUk9SJyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGRhdGFiYXNlOiAnZGlzY29ubmVjdGVkJyxcclxuICAgICAgZXJyb3I6ICdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCdcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBEYXRhYmFzZSBzdGF0dXMgZW5kcG9pbnRcclxuYXBwLmdldCgnL2FwaS9kYi1zdGF0dXMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBkYXRhYmFzZVNlcnZpY2UuZ2V0U3RhdHMoKTtcclxuICAgIFxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICBzdGF0dXM6ICdjb25uZWN0ZWQnLFxyXG4gICAgICBzdGF0aXN0aWNzOiBzdGF0cyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBsb2dnZXJTZXJ2aWNlLmVycm9yKCdEYXRhYmFzZSBzdGF0dXMgY2hlY2sgZmFpbGVkJywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBzdGF0dXM6ICdlcnJvcicsXHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHJldHJpZXZlIGRhdGFiYXNlIHN0YXRpc3RpY3MnLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIFN3YWdnZXIgZG9jdW1lbnRhdGlvbiBlbmRwb2ludFxyXG5hcHAuZ2V0KCcvYXBpLWRvY3MnLCAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3dhZ2dlclNwZWMgPSBzd2FnZ2VyU2VydmljZS5nZW5lcmF0ZVN3YWdnZXJTcGVjKCk7XHJcbiAgICBcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XHJcbiAgICByZXMuc2VuZChzd2FnZ2VyU3BlYyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGxvZ2dlclNlcnZpY2UuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBTd2FnZ2VyIGRvY3MnLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGdlbmVyYXRlIEFQSSBkb2N1bWVudGF0aW9uJyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBFcnJvciBoYW5kbGluZyBtaWRkbGV3YXJlXHJcbmFwcC51c2UoYXV0aE1pZGRsZXdhcmUuZXJyb3JMb2dnZXIoKSk7XHJcblxyXG4vLyA0MDQgaGFuZGxlclxyXG5hcHAudXNlKChyZXEsIHJlcykgPT4ge1xyXG4gIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgIGVycm9yOiAnUm91dGUgbm90IGZvdW5kJyxcclxuICAgIHBhdGg6IHJlcS5vcmlnaW5hbFVybCxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy8gR3JhY2VmdWwgc2h1dGRvd25cclxucHJvY2Vzcy5vbignU0lHSU5UJywgYXN5bmMgKCkgPT4ge1xyXG4gIGxvZ2dlclNlcnZpY2UuaW5mbygnU2VydmVyIHNodXRkb3duIGluaXRpYXRlZCcsIHsgc2lnbmFsOiAnU0lHSU5UJyB9KTtcclxuICBhd2FpdCBkYXRhYmFzZVNlcnZpY2UuZGlzY29ubmVjdCgpO1xyXG4gIGxvZ2dlclNlcnZpY2UuY2xlYW51cCgpO1xyXG4gIHByb2Nlc3MuZXhpdCgwKTtcclxufSk7XHJcblxyXG5wcm9jZXNzLm9uKCdTSUdURVJNJywgYXN5bmMgKCkgPT4ge1xyXG4gIGxvZ2dlclNlcnZpY2UuaW5mbygnU2VydmVyIHNodXRkb3duIGluaXRpYXRlZCcsIHsgc2lnbmFsOiAnU0lHVEVSTScgfSk7XHJcbiAgYXdhaXQgZGF0YWJhc2VTZXJ2aWNlLmRpc2Nvbm5lY3QoKTtcclxuICBsb2dnZXJTZXJ2aWNlLmNsZWFudXAoKTtcclxuICBwcm9jZXNzLmV4aXQoMCk7XHJcbn0pO1xyXG5cclxuLy8gU3RhcnQgc2VydmVyXHJcbmFwcC5saXN0ZW4oUE9SVCwgJzAuMC4wLjAnLCBhc3luYyAoKSA9PiB7XHJcbiAgbG9nZ2VyU2VydmljZS5pbmZvKCdTZXJ2ZXIgc3RhcnRlZCcsIHtcclxuICAgIHBvcnQ6IFBPUlQsXHJcbiAgICBlbnZpcm9ubWVudDogY29uZmlnU2VydmljZS5nZXQoJ05PREVfRU5WJyksXHJcbiAgICBkYXRhYmFzZTogJ2NvbmZpZ3VyZWQnLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICB9KTtcclxuICBcclxuICAvLyBUZXN0IGRhdGFiYXNlIGNvbm5lY3Rpb24gb24gc3RhcnR1cFxyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYXRhYmFzZVNlcnZpY2UuY29ubmVjdCgpO1xyXG4gICAgbG9nZ2VyU2VydmljZS5pbmZvKCdEYXRhYmFzZSBjb25uZWN0aW9uIGVzdGFibGlzaGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBsb2dnZXJTZXJ2aWNlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCBvbiBzdGFydHVwJywgZXJyb3IpO1xyXG4gIH1cclxuICBcclxuICAvLyBJbml0aWFsaXplIGxvZ2luIHNlY3VyaXR5IHNlcnZpY2VcclxuICB0cnkge1xyXG4gICAgLy8gbG9naW5TZWN1cml0eVNlcnZpY2UuaW5pdGlhbGl6ZSgpIG1ldGhvZCBkb2Vzbid0IGV4aXN0LCBzbyB3ZSdsbCBza2lwIGluaXRpYWxpemF0aW9uIGZvciBub3dcclxuICAgIGxvZ2dlclNlcnZpY2UuaW5mbygnTG9naW4gc2VjdXJpdHkgc2VydmljZSBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgbG9nZ2VyU2VydmljZS5lcnJvcignTG9naW4gc2VjdXJpdHkgc2VydmljZSBpbml0aWFsaXphdGlvbiBmYWlsZWQnLCBlcnJvcik7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFNjaGVkdWxlIGNsZWFudXAgdGFza3MgKGV2ZXJ5IGhvdXIpXHJcbiAgc2NoZWR1bGVTZXNzaW9uQ2xlYW51cCgpO1xyXG4gIHNjaGVkdWxlU2VjdXJpdHlDbGVhbnVwKCk7XHJcbn0pO1xyXG5cclxuLy8gU2Vzc2lvbiBjbGVhbnVwIHNjaGVkdWxpbmdcclxuZnVuY3Rpb24gc2NoZWR1bGVTZXNzaW9uQ2xlYW51cCgpIHtcclxuICBjb25zdCB7IHNlc3Npb25TZXJ2aWNlIH0gPSByZXF1aXJlKCcuL3NlcnZpY2VzL3Nlc3Npb25TZXJ2aWNlJyk7XHJcbiAgXHJcbiAgLy8gUnVuIGNsZWFudXAgZXZlcnkgaG91clxyXG4gIHNldEludGVydmFsKGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHNlc3Npb25TZXJ2aWNlLmNsZWFudXBFeHBpcmVkU2Vzc2lvbnMoKTtcclxuICAgICAgbG9nZ2VyU2VydmljZS5pbmZvKCdTY2hlZHVsZWQgc2Vzc2lvbiBjbGVhbnVwIGNvbXBsZXRlZCcpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgbG9nZ2VyU2VydmljZS5lcnJvcignU2NoZWR1bGVkIHNlc3Npb24gY2xlYW51cCBmYWlsZWQnLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIH1cclxuICB9LCA2MCAqIDYwICogMTAwMCk7IC8vIDEgaG91clxyXG4gIFxyXG4gIC8vIFJ1biBpbml0aWFsIGNsZWFudXAgYWZ0ZXIgNSBtaW51dGVzXHJcbiAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBzZXNzaW9uU2VydmljZS5jbGVhbnVwRXhwaXJlZFNlc3Npb25zKCk7XHJcbiAgICAgIGxvZ2dlclNlcnZpY2UuaW5mbygnSW5pdGlhbCBzZXNzaW9uIGNsZWFudXAgY29tcGxldGVkJyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXJTZXJ2aWNlLmVycm9yKCdJbml0aWFsIHNlc3Npb24gY2xlYW51cCBmYWlsZWQnLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIH1cclxuICB9LCA1ICogNjAgKiAxMDAwKTsgLy8gNSBtaW51dGVzXHJcbn1cclxuXHJcbi8vIFNlY3VyaXR5IGNsZWFudXAgc2NoZWR1bGluZ1xyXG5mdW5jdGlvbiBzY2hlZHVsZVNlY3VyaXR5Q2xlYW51cCgpIHtcclxuICAvLyBSdW4gc2VjdXJpdHkgY2xlYW51cCBldmVyeSBob3VyXHJcbiAgc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgbG9naW5TZWN1cml0eVNlcnZpY2UuY2xlYW51cEV4cGlyZWREYXRhKCk7XHJcbiAgICAgIGxvZ2dlclNlcnZpY2UuaW5mbygnU2NoZWR1bGVkIHNlY3VyaXR5IGNsZWFudXAgY29tcGxldGVkJyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBsb2dnZXJTZXJ2aWNlLmVycm9yKCdTY2hlZHVsZWQgc2VjdXJpdHkgY2xlYW51cCBmYWlsZWQnLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIH1cclxuICB9LCA2MCAqIDYwICogMTAwMCk7IC8vIDEgaG91clxyXG4gIFxyXG4gIC8vIFJ1biBpbml0aWFsIHNlY3VyaXR5IGNsZWFudXAgYWZ0ZXIgMTAgbWludXRlc1xyXG4gIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgbG9naW5TZWN1cml0eVNlcnZpY2UuY2xlYW51cEV4cGlyZWREYXRhKCk7XHJcbiAgICAgIGxvZ2dlclNlcnZpY2UuaW5mbygnSW5pdGlhbCBzZWN1cml0eSBjbGVhbnVwIGNvbXBsZXRlZCcpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgbG9nZ2VyU2VydmljZS5lcnJvcignSW5pdGlhbCBzZWN1cml0eSBjbGVhbnVwIGZhaWxlZCcsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH0sIDEwICogNjAgKiAxMDAwKTsgLy8gMTAgbWludXRlc1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHsgYXBwIH07Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLE1BQU1FLE1BQU0sR0FBR0YsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUNoQyxNQUFNRyxNQUFNLEdBQUdILE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDaENBLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQ0ksTUFBTSxDQUFDLENBQUM7O0FBRTFCO0FBQ0EsTUFBTTtFQUFFQztBQUFnQixDQUFDLEdBQUdMLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQztBQUMxRCxNQUFNO0VBQUVNO0FBQWMsQ0FBQyxHQUFHTixPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFDdEQsTUFBTTtFQUFFTztBQUFjLENBQUMsR0FBR1AsT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQ3RELE1BQU07RUFBRVE7QUFBZSxDQUFDLEdBQUdSLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUN2RCxNQUFNO0VBQUVTO0FBQWUsQ0FBQyxHQUFHVCxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQy9DLE1BQU07RUFBRVU7QUFBcUIsQ0FBQyxHQUFHVixPQUFPLENBQUMsaUNBQWlDLENBQUM7O0FBRTNFO0FBQ0EsTUFBTVcsVUFBVSxHQUFHWCxPQUFPLENBQUMsZUFBZSxDQUFDO0FBQzNDLE1BQU1ZLGFBQWEsR0FBR1osT0FBTyxDQUFDLG1CQUFtQixDQUFDO0FBQ2xELE1BQU1hLFVBQVUsR0FBR2IsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FB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