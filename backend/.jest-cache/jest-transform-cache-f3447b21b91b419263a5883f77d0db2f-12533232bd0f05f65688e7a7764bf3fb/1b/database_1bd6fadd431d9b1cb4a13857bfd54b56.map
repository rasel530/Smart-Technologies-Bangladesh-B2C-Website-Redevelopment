{"version":3,"names":["cov_2a79bg5wc3","actualCoverage","PrismaClient","s","require","DatabaseService","constructor","f","connectionPool","activeConnections","idleConnections","totalConnections","maxConnections","connectionTimeout","idleTimeout","acquireTimeoutMillis","createTimeoutMillis","destroyTimeoutMillis","reapIntervalMillis","createRetryIntervalMillis","connectionStartTime","queryCount","errorCount","prisma","log","emit","level","datasources","db","url","process","env","POSTGRES_DATABASE_URL","__internal","engine","connectionLimit","poolTimeout","setupEventListeners","connect","startTime","Date","now","maxRetries","retryDelay","attempt","$connect","connectionTime","console","poolStats","getConnectionPoolStats","error","message","code","timestamp","toISOString","b","Promise","resolve","setTimeout","totalAttempts","totalDuration","databaseUrl","config","DATABASE_URL","environment","NODE_ENV","disconnect","$disconnect","healthCheck","result","$queryRaw","responseTime","status","database","getStats","userCount","productCount","categoryCount","brandCount","orderCount","reviewCount","couponCount","all","user","count","product","category","brand","order","review","coupon","users","products","categories","brands","orders","reviews","coupons","transaction","callback","$transaction","getClient","query","sql","params","getDivisions","divisions","map","row","division","getPaymentMethods","paymentMethods","paymentMethod","utilizationRate","toFixed","timeouts","connection","idle","acquire","$on","event","duration","target","warn","on","cleanupConnections","databaseService","module","exports"],"sources":["database.js"],"sourcesContent":["const { PrismaClient } = require('@prisma/client');\r\n\r\nclass DatabaseService {\r\n  constructor() {\r\n    this.connectionPool = {\r\n      activeConnections: 0,\r\n      idleConnections: 0,\r\n      totalConnections: 0,\r\n      maxConnections: 10,\r\n      connectionTimeout: 30000,\r\n      idleTimeout: 10000,\r\n      acquireTimeoutMillis: 30000,\r\n      createTimeoutMillis: 30000,\r\n      destroyTimeoutMillis: 5000,\r\n      reapIntervalMillis: 1000,\r\n      createRetryIntervalMillis: 200,\r\n      connectionStartTime: null,\r\n      queryCount: 0,\r\n      errorCount: 0\r\n    };\r\n    \r\n    this.prisma = new PrismaClient({\r\n      log: [\r\n        {\r\n          emit: 'event',\r\n          level: 'query',\r\n        },\r\n        {\r\n          emit: 'event',\r\n          level: 'error',\r\n        },\r\n        {\r\n          emit: 'event',\r\n          level: 'info',\r\n        },\r\n        {\r\n          emit: 'event',\r\n          level: 'warn',\r\n        }\r\n      ],\r\n      // Enhanced connection configuration\r\n      datasources: {\r\n        db: {\r\n          url: process.env.POSTGRES_DATABASE_URL,\r\n        }\r\n      },\r\n      // Connection pool settings\r\n      __internal: {\r\n        engine: {\r\n          connectionLimit: this.connectionPool.maxConnections,\r\n          poolTimeout: this.connectionPool.acquireTimeoutMillis,\r\n          idleTimeout: this.connectionPool.idleTimeout,\r\n          connectionTimeout: this.connectionPool.connectionTimeout\r\n        }\r\n      }\r\n    });\r\n    \r\n    // Set up event listeners for connection monitoring\r\n    this.setupEventListeners();\r\n  }\r\n\r\n  async connect() {\r\n    const startTime = Date.now();\r\n    const maxRetries = 3;\r\n    const retryDelay = 1000; // 1 second\r\n    \r\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n      try {\r\n        await this.prisma.$connect();\r\n        const connectionTime = Date.now() - startTime;\r\n        console.log(`‚úÖ Database connected successfully (attempt ${attempt}, ${connectionTime}ms)`);\r\n        \r\n        // Log connection pool status\r\n        const poolStats = this.getConnectionPoolStats();\r\n        console.log('üîç Database connection pool stats:', poolStats);\r\n        \r\n        return true;\r\n      } catch (error) {\r\n        console.error(`‚ùå Database connection attempt ${attempt} failed:`, {\r\n          error: error.message,\r\n          code: error.code,\r\n          attempt,\r\n          maxRetries,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n        \r\n        if (attempt < maxRetries) {\r\n          console.log(`üîÑ Retrying database connection in ${retryDelay}ms...`);\r\n          await new Promise(resolve => setTimeout(resolve, retryDelay));\r\n        } else {\r\n          // Log final failure with diagnostic info\r\n          console.error('üí• All database connection attempts failed:', {\r\n            totalAttempts: maxRetries,\r\n            totalDuration: Date.now() - startTime,\r\n            databaseUrl: this.config?.DATABASE_URL ? 'CONFIGURED' : 'MISSING',\r\n            environment: process.env.NODE_ENV || 'unknown'\r\n          });\r\n          throw error;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  async disconnect() {\r\n    try {\r\n      await this.prisma.$disconnect();\r\n      console.log('‚úÖ Database disconnected successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Database disconnection failed:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async healthCheck() {\r\n    const startTime = Date.now();\r\n    try {\r\n      // Enhanced query with NOW() for better timing measurement\r\n      const result = await this.prisma.$queryRaw`SELECT 1 as status, NOW() as server_time`;\r\n      const responseTime = Date.now() - startTime;\r\n      const poolStats = this.getConnectionPoolStats();\r\n      \r\n      return {\r\n        status: 'healthy',\r\n        database: 'connected',\r\n        responseTime: `${responseTime}ms`,\r\n        connectionPool: poolStats,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    } catch (error) {\r\n      const responseTime = Date.now() - startTime;\r\n      return {\r\n        status: 'unhealthy',\r\n        database: 'disconnected',\r\n        responseTime: `${responseTime}ms`,\r\n        error: error.message,\r\n        connectionPool: this.getConnectionPoolStats(),\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    }\r\n  }\r\n\r\n  async getStats() {\r\n    try {\r\n      const [\r\n        userCount,\r\n        productCount,\r\n        categoryCount,\r\n        brandCount,\r\n        orderCount,\r\n        reviewCount,\r\n        couponCount\r\n      ] = await Promise.all([\r\n        this.prisma.user.count(),\r\n        this.prisma.product.count(),\r\n        this.prisma.category.count(),\r\n        this.prisma.brand.count(),\r\n        this.prisma.order.count(),\r\n        this.prisma.review.count(),\r\n        this.prisma.coupon.count()\r\n      ]);\r\n\r\n      return {\r\n        users: userCount,\r\n        products: productCount,\r\n        categories: categoryCount,\r\n        brands: brandCount,\r\n        orders: orderCount,\r\n        reviews: reviewCount,\r\n        coupons: couponCount,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting database stats:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Transaction helper\r\n  async transaction(callback) {\r\n    return await this.prisma.$transaction(callback);\r\n  }\r\n\r\n  // Get client instance\r\n  getClient() {\r\n    return this.prisma;\r\n  }\r\n\r\n  // Raw query helper\r\n  async query(sql, params = []) {\r\n    try {\r\n      return await this.prisma.$queryRaw`${sql}`;\r\n    } catch (error) {\r\n      console.error('Raw query error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Bangladesh-specific helpers\r\n  async getDivisions() {\r\n    try {\r\n      const divisions = await this.prisma.$queryRaw`\r\n        SELECT DISTINCT division FROM addresses \r\n        WHERE division IS NOT NULL \r\n        ORDER BY division\r\n      `;\r\n      return divisions.map(row => row.division);\r\n    } catch (error) {\r\n      console.error('Error getting divisions:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getPaymentMethods() {\r\n    try {\r\n      const paymentMethods = await this.prisma.$queryRaw`\r\n        SELECT DISTINCT paymentMethod FROM orders \r\n        WHERE paymentMethod IS NOT NULL \r\n        ORDER BY paymentMethod\r\n      `;\r\n      return paymentMethods.map(row => row.paymentMethod);\r\n    } catch (error) {\r\n      console.error('Error getting payment methods:', error);\r\n      throw error;\r\n    }\r\n  }\r\n  // Get connection pool statistics for diagnostics\r\n  getConnectionPoolStats() {\r\n    try {\r\n      const utilizationRate = this.connectionPool.maxConnections > 0\r\n        ? (this.connectionPool.activeConnections / this.connectionPool.maxConnections * 100).toFixed(2)\r\n        : 0;\r\n      \r\n      return {\r\n        activeConnections: this.connectionPool.activeConnections,\r\n        idleConnections: this.connectionPool.idleConnections,\r\n        totalConnections: this.connectionPool.totalConnections,\r\n        maxConnections: this.connectionPool.maxConnections,\r\n        utilizationRate: `${utilizationRate}%`,\r\n        timeouts: {\r\n          connection: this.connectionPool.connectionTimeout,\r\n          idle: this.connectionPool.idleTimeout,\r\n          acquire: this.connectionPool.acquireTimeoutMillis\r\n        },\r\n        queryCount: this.connectionPool.queryCount,\r\n        errorCount: this.connectionPool.errorCount,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to get connection pool stats:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Setup event listeners for Prisma events\r\n  setupEventListeners() {\r\n    try {\r\n      // Monitor query events\r\n      this.prisma.$on('query', (event) => {\r\n        this.connectionPool.queryCount++;\r\n        console.log('üîç Query:', {\r\n          query: event.query,\r\n          params: event.params,\r\n          duration: `${event.duration}ms`,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Monitor error events\r\n      this.prisma.$on('error', (event) => {\r\n        this.connectionPool.errorCount++;\r\n        console.error('‚ùå Database Error:', {\r\n          target: event.target,\r\n          message: event.message,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Monitor info events\r\n      this.prisma.$on('info', (event) => {\r\n        console.log('‚ÑπÔ∏è Database Info:', {\r\n          target: event.target,\r\n          message: event.message,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Monitor warning events\r\n      this.prisma.$on('warn', (event) => {\r\n        console.warn('‚ö†Ô∏è Database Warning:', {\r\n          target: event.target,\r\n          message: event.message,\r\n          timestamp: event.timestamp\r\n        });\r\n      });\r\n\r\n      // Handle process exit for graceful cleanup\r\n      process.on('beforeExit', async () => {\r\n        console.log('üîÑ Process exiting, cleaning up database connections...');\r\n        await this.cleanupConnections();\r\n      });\r\n\r\n      console.log('‚úÖ Database event listeners setup completed');\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to setup event listeners:', error);\r\n    }\r\n  }\r\n\r\n  // Cleanup connections gracefully\r\n  async cleanupConnections() {\r\n    try {\r\n      console.log('üßπ Starting connection cleanup...');\r\n      \r\n      // Reset connection tracking\r\n      this.connectionPool.activeConnections = 0;\r\n      this.connectionPool.idleConnections = 0;\r\n      this.connectionPool.totalConnections = 0;\r\n      \r\n      // Disconnect from database\r\n      await this.prisma.$disconnect();\r\n      \r\n      console.log('‚úÖ Database connections cleaned up successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to cleanup connections:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst databaseService = new DatabaseService();\r\n\r\nmodule.exports = {\r\n  DatabaseService,\r\n  databaseService\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}