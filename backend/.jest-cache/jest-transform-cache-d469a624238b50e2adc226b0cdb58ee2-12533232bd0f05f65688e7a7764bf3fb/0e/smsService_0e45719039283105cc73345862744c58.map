{"version":3,"names":["cov_2ibzdjuob3","actualCoverage","twilio","s","require","configService","loggerService","phoneValidationService","SMSService","constructor","f","config","logger","twilioClient","initializeTwilio","smsConfig","getSMSConfig","b","twilioAccountSid","twilioAuthToken","twilioPhoneNumber","warn","info","error","message","validateBangladeshPhoneNumber","phone","validateForUseCase","createOTPTemplate","otp","userName","text","textEn","textBn","sendOTP","validation","isValid","success","errorBn","code","normalizedPhone","timestamp","Date","toISOString","messageId","now","operator","mock","template","messages","create","body","from","to","sid","errorType","name","errorCode","sendSMS","options","substring","twilioMessage","getDeliveryStatus","fetch","status","errorMessage","dateCreated","dateSent","dateUpdated","getOperatorInfo","isAvailable","formatPhoneNumber","format","getSupportedOperators","useCase","smsService","module","exports"],"sources":["smsService.js"],"sourcesContent":["const twilio = require('twilio');\r\nconst configService = require('./config');\r\nconst loggerService = require('./logger');\r\nconst { phoneValidationService } = require('./phoneValidationService');\r\n\r\nclass SMSService {\r\n  constructor() {\r\n    this.config = configService;\r\n    this.logger = loggerService;\r\n    this.twilioClient = null;\r\n    this.initializeTwilio();\r\n  }\r\n\r\n  initializeTwilio() {\r\n    try {\r\n      const smsConfig = this.config.getSMSConfig();\r\n      \r\n      if (!smsConfig.twilioAccountSid || !smsConfig.twilioAuthToken || !smsConfig.twilioPhoneNumber) {\r\n        this.logger.warn('Twilio SMS service not configured - missing credentials');\r\n        return;\r\n      }\r\n\r\n      this.twilioClient = twilio(smsConfig.twilioAccountSid, smsConfig.twilioAuthToken);\r\n      this.logger.info('Twilio SMS service initialized successfully');\r\n    } catch (error) {\r\n      this.logger.error('Failed to initialize Twilio SMS service', error.message);\r\n      this.twilioClient = null;\r\n    }\r\n  }\r\n\r\n  // Validate Bangladesh phone number format (enhanced with centralized service)\r\n  validateBangladeshPhoneNumber(phone) {\r\n    return phoneValidationService.validateForUseCase(phone, 'sms');\r\n  }\r\n\r\n  // Create OTP SMS template with Bangladesh localization\r\n  createOTPTemplate(otp, userName) {\r\n    return {\r\n      text: `Smart Technologies Bangladesh: আপনার OTP কোডটি ${otp}। এটি 5 মিনিটের মধ্যে ব্যবহার করুন। Your OTP is ${otp}. Use within 5 minutes.`,\r\n      textEn: `Smart Technologies Bangladesh: Your OTP is ${otp}. Use within 5 minutes.`,\r\n      textBn: `স্মার্ট টেকনোলজিস বাংলাদেশ: আপনার OTP কোডটি ${otp}। এটি 5 মিনিটের মধ্যে ব্যবহার করুন।`\r\n    };\r\n  }\r\n\r\n  // Send OTP via SMS\r\n  async sendOTP(phone, otp, userName = '') {\r\n    try {\r\n      const validation = this.validateBangladeshPhoneNumber(phone);\r\n      if (!validation.isValid) {\r\n        return {\r\n          success: false,\r\n          error: validation.error,\r\n          errorBn: validation.errorBn,\r\n          code: validation.code || 'INVALID_PHONE'\r\n        };\r\n      }\r\n\r\n      if (!this.twilioClient) {\r\n        // Fallback to mock SMS for development\r\n        this.logger.warn('SMS service not available, using mock SMS', {\r\n          phone: validation.normalizedPhone,\r\n          otp,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n\r\n        return {\r\n          success: true,\r\n          messageId: `mock_${Date.now()}`,\r\n          phone: validation.normalizedPhone,\r\n          operator: validation.operator,\r\n          mock: true,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n      }\r\n\r\n      const smsConfig = this.config.getSMSConfig();\r\n      const template = this.createOTPTemplate(otp, userName);\r\n\r\n      const message = await this.twilioClient.messages.create({\r\n        body: template.text,\r\n        from: smsConfig.twilioPhoneNumber,\r\n        to: validation.normalizedPhone\r\n      });\r\n\r\n      this.logger.info('OTP SMS sent successfully', {\r\n        to: validation.normalizedPhone,\r\n        messageId: message.sid,\r\n        operator: validation.operator,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        messageId: message.sid,\r\n        phone: validation.normalizedPhone,\r\n        operator: validation.operator,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to send OTP SMS', error.message, {\r\n        phone,\r\n        errorType: error.name,\r\n        errorCode: error.code\r\n      });\r\n\r\n      return {\r\n        success: false,\r\n        error: error.message,\r\n        code: error.code || 'SMS_SEND_FAILED'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Send general SMS\r\n  async sendSMS(phone, message, options = {}) {\r\n    try {\r\n      const validation = this.validateBangladeshPhoneNumber(phone);\r\n      if (!validation.isValid) {\r\n        return {\r\n          success: false,\r\n          error: validation.error,\r\n          errorBn: validation.errorBn,\r\n          code: validation.code || 'INVALID_PHONE'\r\n        };\r\n      }\r\n\r\n      if (!this.twilioClient) {\r\n        // Fallback to mock SMS for development\r\n        this.logger.warn('SMS service not available, using mock SMS', {\r\n          phone: validation.normalizedPhone,\r\n          message: message.substring(0, 100) + '...',\r\n          timestamp: new Date().toISOString()\r\n        });\r\n\r\n        return {\r\n          success: true,\r\n          messageId: `mock_${Date.now()}`,\r\n          phone: validation.normalizedPhone,\r\n          operator: validation.operator,\r\n          mock: true,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n      }\r\n\r\n      const smsConfig = this.config.getSMSConfig();\r\n\r\n      const twilioMessage = await this.twilioClient.messages.create({\r\n        body: message,\r\n        from: smsConfig.twilioPhoneNumber,\r\n        to: validation.normalizedPhone,\r\n        ...options\r\n      });\r\n\r\n      this.logger.info('SMS sent successfully', {\r\n        to: validation.normalizedPhone,\r\n        messageId: twilioMessage.sid,\r\n        operator: validation.operator,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      return {\r\n        success: true,\r\n        messageId: twilioMessage.sid,\r\n        phone: validation.normalizedPhone,\r\n        operator: validation.operator,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to send SMS', error.message, {\r\n        phone,\r\n        errorType: error.name,\r\n        errorCode: error.code\r\n      });\r\n\r\n      return {\r\n        success: false,\r\n        error: error.message,\r\n        code: error.code || 'SMS_SEND_FAILED'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Check SMS delivery status\r\n  async getDeliveryStatus(messageId) {\r\n    try {\r\n      if (!this.twilioClient || !messageId) {\r\n        return {\r\n          success: false,\r\n          error: 'SMS service not available or message ID missing'\r\n        };\r\n      }\r\n\r\n      const message = await this.twilioClient.messages(messageId).fetch();\r\n\r\n      return {\r\n        success: true,\r\n        status: message.status,\r\n        errorCode: message.errorCode,\r\n        errorMessage: message.errorMessage,\r\n        dateCreated: message.dateCreated,\r\n        dateSent: message.dateSent,\r\n        dateUpdated: message.dateUpdated\r\n      };\r\n\r\n    } catch (error) {\r\n      this.logger.error('Failed to get SMS delivery status', error.message, {\r\n        messageId\r\n      });\r\n\r\n      return {\r\n        success: false,\r\n        error: error.message\r\n      };\r\n    }\r\n  }\r\n\r\n  // Get operator information from phone number\r\n  getOperatorInfo(phone) {\r\n    return phoneValidationService.getOperatorInfo(phone);\r\n  }\r\n\r\n  // Check if SMS service is available\r\n  isAvailable() {\r\n    return this.twilioClient !== null;\r\n  }\r\n\r\n  // Format phone number for display\r\n  formatPhoneNumber(phone, format = 'display') {\r\n    return phoneValidationService.formatPhoneNumber(phone, format);\r\n  }\r\n\r\n  // Get supported operators\r\n  getSupportedOperators() {\r\n    return phoneValidationService.getSupportedOperators();\r\n  }\r\n\r\n  // Validate phone number for specific use case\r\n  validateForUseCase(phone, useCase) {\r\n    return phoneValidationService.validateForUseCase(phone, useCase);\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nconst smsService = new SMSService();\r\n\r\nmodule.exports = {\r\n  SMSService,\r\n  smsService\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ,MAAME,MAAM;AAAA;AAAA,CAAAF,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMC,aAAa;AAAA;AAAA,CAAAL,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,UAAU,CAAC;AACzC,MAAME,aAAa;AAAA;AAAA,CAAAN,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,UAAU,CAAC;AACzC,MAAM;EAAEG;AAAuB,CAAC;AAAA;AAAA,CAAAP,cAAA,GAAAG,CAAA,OAAGC,OAAO,CAAC,0BAA0B,CAAC;AAEtE,MAAMI,UAAU,CAAC;EACfC,WAAWA,CAAA,EAAG;IAAA;IAAAT,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACZ,IAAI,CAACQ,MAAM,GAAGN,aAAa;IAAC;IAAAL,cAAA,GAAAG,CAAA;IAC5B,IAAI,CAACS,MAAM,GAAGN,aAAa;IAAC;IAAAN,cAAA,GAAAG,CAAA;IAC5B,IAAI,CAACU,YAAY,GAAG,IAAI;IAAC;IAAAb,cAAA,GAAAG,CAAA;IACzB,IAAI,CAACW,gBAAgB,CAAC,CAAC;EACzB;EAEAA,gBAAgBA,CAAA,EAAG;IAAA;IAAAd,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACjB,IAAI;MACF,MAAMY,SAAS;MAAA;MAAA,CAAAf,cAAA,GAAAG,CAAA,OAAG,IAAI,CAACQ,MAAM,CAACK,YAAY,CAAC,CAAC;MAAC;MAAAhB,cAAA,GAAAG,CAAA;MAE7C;MAAI;MAAA,CAAAH,cAAA,GAAAiB,CAAA,WAACF,SAAS,CAACG,gBAAgB;MAAA;MAAA,CAAAlB,cAAA,GAAAiB,CAAA,UAAI,CAACF,SAAS,CAACI,eAAe;MAAA;MAAA,CAAAnB,cAAA,GAAAiB,CAAA,UAAI,CAACF,SAAS,CAACK,iBAAiB,GAAE;QAAA;QAAApB,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAG,CAAA;QAC7F,IAAI,CAACS,MAAM,CAACS,IAAI,CAAC,yDAAyD,CAAC;QAAC;QAAArB,cAAA,GAAAG,CAAA;QAC5E;MACF,CAAC;MAAA;MAAA;QAAAH,cAAA,GAAAiB,CAAA;MAAA;MAAAjB,cAAA,GAAAG,CAAA;MAED,IAAI,CAACU,YAAY,GAAGX,MAAM,CAACa,SAAS,CAACG,gBAAgB,EAAEH,SAAS,CAACI,eAAe,CAAC;MAAC;MAAAnB,cAAA,GAAAG,CAAA;MAClF,IAAI,CAACS,MAAM,CAACU,IAAI,CAAC,6CAA6C,CAAC;IACjE,CAAC,CAAC,OAAOC,KAAK,EAAE;MAAA;MAAAvB,cAAA,GAAAG,CAAA;MACd,IAAI,CAACS,MAAM,CAACW,KAAK,CAAC,yCAAyC,EAAEA,KAAK,CAACC,OAAO,CAAC;MAAC;MAAAxB,cAAA,GAAAG,CAAA;MAC5E,IAAI,CAACU,YAAY,GAAG,IAAI;IAC1B;EACF;;EAEA;EACAY,6BAA6BA,CAACC,KAAK,EAAE;IAAA;IAAA1B,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACnC,OAAOI,sBAAsB,CAACoB,kBAAkB,CAACD,KAAK,EAAE,KAAK,CAAC;EAChE;;EAEA;EACAE,iBAAiBA,CAACC,GAAG,EAAEC,QAAQ,EAAE;IAAA;IAAA9B,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IAC/B,OAAO;MACL4B,IAAI,EAAE,kDAAkDF,GAAG,mDAAmDA,GAAG,yBAAyB;MAC1IG,MAAM,EAAE,8CAA8CH,GAAG,yBAAyB;MAClFI,MAAM,EAAE,+CAA+CJ,GAAG;IAC5D,CAAC;EACH;;EAEA;EACA,MAAMK,OAAOA,CAACR,KAAK,EAAEG,GAAG,EAAEC,QAAQ;EAAA;EAAA,CAAA9B,cAAA,GAAAiB,CAAA,UAAG,EAAE,GAAE;IAAA;IAAAjB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACvC,IAAI;MACF,MAAMgC,UAAU;MAAA;MAAA,CAAAnC,cAAA,GAAAG,CAAA,QAAG,IAAI,CAACsB,6BAA6B,CAACC,KAAK,CAAC;MAAC;MAAA1B,cAAA,GAAAG,CAAA;MAC7D,IAAI,CAACgC,UAAU,CAACC,OAAO,EAAE;QAAA;QAAApC,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAG,CAAA;QACvB,OAAO;UACLkC,OAAO,EAAE,KAAK;UACdd,KAAK,EAAEY,UAAU,CAACZ,KAAK;UACvBe,OAAO,EAAEH,UAAU,CAACG,OAAO;UAC3BC,IAAI;UAAE;UAAA,CAAAvC,cAAA,GAAAiB,CAAA,UAAAkB,UAAU,CAACI,IAAI;UAAA;UAAA,CAAAvC,cAAA,GAAAiB,CAAA,UAAI,eAAe;QAC1C,CAAC;MACH,CAAC;MAAA;MAAA;QAAAjB,cAAA,GAAAiB,CAAA;MAAA;MAAAjB,cAAA,GAAAG,CAAA;MAED,IAAI,CAAC,IAAI,CAACU,YAAY,EAAE;QAAA;QAAAb,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAG,CAAA;QACtB;QACA,IAAI,CAACS,MAAM,CAACS,IAAI,CAAC,2CAA2C,EAAE;UAC5DK,KAAK,EAAES,UAAU,CAACK,eAAe;UACjCX,GAAG;UACHY,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACpC,CAAC,CAAC;QAAC;QAAA3C,cAAA,GAAAG,CAAA;QAEH,OAAO;UACLkC,OAAO,EAAE,IAAI;UACbO,SAAS,EAAE,QAAQF,IAAI,CAACG,GAAG,CAAC,CAAC,EAAE;UAC/BnB,KAAK,EAAES,UAAU,CAACK,eAAe;UACjCM,QAAQ,EAAEX,UAAU,CAACW,QAAQ;UAC7BC,IAAI,EAAE,IAAI;UACVN,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACpC,CAAC;MACH,CAAC;MAAA;MAAA;QAAA3C,cAAA,GAAAiB,CAAA;MAAA;MAED,MAAMF,SAAS;MAAA;MAAA,CAAAf,cAAA,GAAAG,CAAA,QAAG,IAAI,CAACQ,MAAM,CAACK,YAAY,CAAC,CAAC;MAC5C,MAAMgC,QAAQ;MAAA;MAAA,CAAAhD,cAAA,GAAAG,CAAA,QAAG,IAAI,CAACyB,iBAAiB,CAACC,GAAG,EAAEC,QAAQ,CAAC;MAEtD,MAAMN,OAAO;MAAA;MAAA,CAAAxB,cAAA,GAAAG,CAAA,QAAG,MAAM,IAAI,CAACU,YAAY,CAACoC,QAAQ,CAACC,MAAM,CAAC;QACtDC,IAAI,EAAEH,QAAQ,CAACjB,IAAI;QACnBqB,IAAI,EAAErC,SAAS,CAACK,iBAAiB;QACjCiC,EAAE,EAAElB,UAAU,CAACK;MACjB,CAAC,CAAC;MAAC;MAAAxC,cAAA,GAAAG,CAAA;MAEH,IAAI,CAACS,MAAM,CAACU,IAAI,CAAC,2BAA2B,EAAE;QAC5C+B,EAAE,EAAElB,UAAU,CAACK,eAAe;QAC9BI,SAAS,EAAEpB,OAAO,CAAC8B,GAAG;QACtBR,QAAQ,EAAEX,UAAU,CAACW,QAAQ;QAC7BL,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACpC,CAAC,CAAC;MAAC;MAAA3C,cAAA,GAAAG,CAAA;MAEH,OAAO;QACLkC,OAAO,EAAE,IAAI;QACbO,SAAS,EAAEpB,OAAO,CAAC8B,GAAG;QACtB5B,KAAK,EAAES,UAAU,CAACK,eAAe;QACjCM,QAAQ,EAAEX,UAAU,CAACW,QAAQ;QAC7BL,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACpC,CAAC;IAEH,CAAC,CAAC,OAAOpB,KAAK,EAAE;MAAA;MAAAvB,cAAA,GAAAG,CAAA;MACd,IAAI,CAACS,MAAM,CAACW,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAACC,OAAO,EAAE;QACzDE,KAAK;QACL6B,SAAS,EAAEhC,KAAK,CAACiC,IAAI;QACrBC,SAAS,EAAElC,KAAK,CAACgB;MACnB,CAAC,CAAC;MAAC;MAAAvC,cAAA,GAAAG,CAAA;MAEH,OAAO;QACLkC,OAAO,EAAE,KAAK;QACdd,KAAK,EAAEA,KAAK,CAACC,OAAO;QACpBe,IAAI;QAAE;QAAA,CAAAvC,cAAA,GAAAiB,CAAA,UAAAM,KAAK,CAACgB,IAAI;QAAA;QAAA,CAAAvC,cAAA,GAAAiB,CAAA,UAAI,iBAAiB;MACvC,CAAC;IACH;EACF;;EAEA;EACA,MAAMyC,OAAOA,CAAChC,KAAK,EAAEF,OAAO,EAAEmC,OAAO;EAAA;EAAA,CAAA3D,cAAA,GAAAiB,CAAA,UAAG,CAAC,CAAC,GAAE;IAAA;IAAAjB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IAC1C,IAAI;MACF,MAAMgC,UAAU;MAAA;MAAA,CAAAnC,cAAA,GAAAG,CAAA,QAAG,IAAI,CAACsB,6BAA6B,CAACC,KAAK,CAAC;MAAC;MAAA1B,cAAA,GAAAG,CAAA;MAC7D,IAAI,CAACgC,UAAU,CAACC,OAAO,EAAE;QAAA;QAAApC,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAG,CAAA;QACvB,OAAO;UACLkC,OAAO,EAAE,KAAK;UACdd,KAAK,EAAEY,UAAU,CAACZ,KAAK;UACvBe,OAAO,EAAEH,UAAU,CAACG,OAAO;UAC3BC,IAAI;UAAE;UAAA,CAAAvC,cAAA,GAAAiB,CAAA,UAAAkB,UAAU,CAACI,IAAI;UAAA;UAAA,CAAAvC,cAAA,GAAAiB,CAAA,UAAI,eAAe;QAC1C,CAAC;MACH,CAAC;MAAA;MAAA;QAAAjB,cAAA,GAAAiB,CAAA;MAAA;MAAAjB,cAAA,GAAAG,CAAA;MAED,IAAI,CAAC,IAAI,CAACU,YAAY,EAAE;QAAA;QAAAb,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAG,CAAA;QACtB;QACA,IAAI,CAACS,MAAM,CAACS,IAAI,CAAC,2CAA2C,EAAE;UAC5DK,KAAK,EAAES,UAAU,CAACK,eAAe;UACjChB,OAAO,EAAEA,OAAO,CAACoC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,KAAK;UAC1CnB,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACpC,CAAC,CAAC;QAAC;QAAA3C,cAAA,GAAAG,CAAA;QAEH,OAAO;UACLkC,OAAO,EAAE,IAAI;UACbO,SAAS,EAAE,QAAQF,IAAI,CAACG,GAAG,CAAC,CAAC,EAAE;UAC/BnB,KAAK,EAAES,UAAU,CAACK,eAAe;UACjCM,QAAQ,EAAEX,UAAU,CAACW,QAAQ;UAC7BC,IAAI,EAAE,IAAI;UACVN,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACpC,CAAC;MACH,CAAC;MAAA;MAAA;QAAA3C,cAAA,GAAAiB,CAAA;MAAA;MAED,MAAMF,SAAS;MAAA;MAAA,CAAAf,cAAA,GAAAG,CAAA,QAAG,IAAI,CAACQ,MAAM,CAACK,YAAY,CAAC,CAAC;MAE5C,MAAM6C,aAAa;MAAA;MAAA,CAAA7D,cAAA,GAAAG,CAAA,QAAG,MAAM,IAAI,CAACU,YAAY,CAACoC,QAAQ,CAACC,MAAM,CAAC;QAC5DC,IAAI,EAAE3B,OAAO;QACb4B,IAAI,EAAErC,SAAS,CAACK,iBAAiB;QACjCiC,EAAE,EAAElB,UAAU,CAACK,eAAe;QAC9B,GAAGmB;MACL,CAAC,CAAC;MAAC;MAAA3D,cAAA,GAAAG,CAAA;MAEH,IAAI,CAACS,MAAM,CAACU,IAAI,CAAC,uBAAuB,EAAE;QACxC+B,EAAE,EAAElB,UAAU,CAACK,eAAe;QAC9BI,SAAS,EAAEiB,aAAa,CAACP,GAAG;QAC5BR,QAAQ,EAAEX,UAAU,CAACW,QAAQ;QAC7BL,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACpC,CAAC,CAAC;MAAC;MAAA3C,cAAA,GAAAG,CAAA;MAEH,OAAO;QACLkC,OAAO,EAAE,IAAI;QACbO,SAAS,EAAEiB,aAAa,CAACP,GAAG;QAC5B5B,KAAK,EAAES,UAAU,CAACK,eAAe;QACjCM,QAAQ,EAAEX,UAAU,CAACW,QAAQ;QAC7BL,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACpC,CAAC;IAEH,CAAC,CAAC,OAAOpB,KAAK,EAAE;MAAA;MAAAvB,cAAA,GAAAG,CAAA;MACd,IAAI,CAACS,MAAM,CAACW,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAACC,OAAO,EAAE;QACrDE,KAAK;QACL6B,SAAS,EAAEhC,KAAK,CAACiC,IAAI;QACrBC,SAAS,EAAElC,KAAK,CAACgB;MACnB,CAAC,CAAC;MAAC;MAAAvC,cAAA,GAAAG,CAAA;MAEH,OAAO;QACLkC,OAAO,EAAE,KAAK;QACdd,KAAK,EAAEA,KAAK,CAACC,OAAO;QACpBe,IAAI;QAAE;QAAA,CAAAvC,cAAA,GAAAiB,CAAA,WAAAM,KAAK,CAACgB,IAAI;QAAA;QAAA,CAAAvC,cAAA,GAAAiB,CAAA,WAAI,iBAAiB;MACvC,CAAC;IACH;EACF;;EAEA;EACA,MAAM6C,iBAAiBA,CAAClB,SAAS,EAAE;IAAA;IAAA5C,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACjC,IAAI;MAAA;MAAAH,cAAA,GAAAG,CAAA;MACF;MAAI;MAAA,CAAAH,cAAA,GAAAiB,CAAA,YAAC,IAAI,CAACJ,YAAY;MAAA;MAAA,CAAAb,cAAA,GAAAiB,CAAA,WAAI,CAAC2B,SAAS,GAAE;QAAA;QAAA5C,cAAA,GAAAiB,CAAA;QAAAjB,cAAA,GAAAG,CAAA;QACpC,OAAO;UACLkC,OAAO,EAAE,KAAK;UACdd,KAAK,EAAE;QACT,CAAC;MACH,CAAC;MAAA;MAAA;QAAAvB,cAAA,GAAAiB,CAAA;MAAA;MAED,MAAMO,OAAO;MAAA;MAAA,CAAAxB,cAAA,GAAAG,CAAA,QAAG,MAAM,IAAI,CAACU,YAAY,CAACoC,QAAQ,CAACL,SAAS,CAAC,CAACmB,KAAK,CAAC,CAAC;MAAC;MAAA/D,cAAA,GAAAG,CAAA;MAEpE,OAAO;QACLkC,OAAO,EAAE,IAAI;QACb2B,MAAM,EAAExC,OAAO,CAACwC,MAAM;QACtBP,SAAS,EAAEjC,OAAO,CAACiC,SAAS;QAC5BQ,YAAY,EAAEzC,OAAO,CAACyC,YAAY;QAClCC,WAAW,EAAE1C,OAAO,CAAC0C,WAAW;QAChCC,QAAQ,EAAE3C,OAAO,CAAC2C,QAAQ;QAC1BC,WAAW,EAAE5C,OAAO,CAAC4C;MACvB,CAAC;IAEH,CAAC,CAAC,OAAO7C,KAAK,EAAE;MAAA;MAAAvB,cAAA,GAAAG,CAAA;MACd,IAAI,CAACS,MAAM,CAACW,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAACC,OAAO,EAAE;QACpEoB;MACF,CAAC,CAAC;MAAC;MAAA5C,cAAA,GAAAG,CAAA;MAEH,OAAO;QACLkC,OAAO,EAAE,KAAK;QACdd,KAAK,EAAEA,KAAK,CAACC;MACf,CAAC;IACH;EACF;;EAEA;EACA6C,eAAeA,CAAC3C,KAAK,EAAE;IAAA;IAAA1B,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACrB,OAAOI,sBAAsB,CAAC8D,eAAe,CAAC3C,KAAK,CAAC;EACtD;;EAEA;EACA4C,WAAWA,CAAA,EAAG;IAAA;IAAAtE,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACZ,OAAO,IAAI,CAACU,YAAY,KAAK,IAAI;EACnC;;EAEA;EACA0D,iBAAiBA,CAAC7C,KAAK,EAAE8C,MAAM;EAAA;EAAA,CAAAxE,cAAA,GAAAiB,CAAA,WAAG,SAAS,GAAE;IAAA;IAAAjB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IAC3C,OAAOI,sBAAsB,CAACgE,iBAAiB,CAAC7C,KAAK,EAAE8C,MAAM,CAAC;EAChE;;EAEA;EACAC,qBAAqBA,CAAA,EAAG;IAAA;IAAAzE,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACtB,OAAOI,sBAAsB,CAACkE,qBAAqB,CAAC,CAAC;EACvD;;EAEA;EACA9C,kBAAkBA,CAACD,KAAK,EAAEgD,OAAO,EAAE;IAAA;IAAA1E,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAG,CAAA;IACjC,OAAOI,sBAAsB,CAACoB,kBAAkB,CAACD,KAAK,EAAEgD,OAAO,CAAC;EAClE;AACF;;AAEA;AACA,MAAMC,UAAU;AAAA;AAAA,CAAA3E,cAAA,GAAAG,CAAA,QAAG,IAAIK,UAAU,CAAC,CAAC;AAAC;AAAAR,cAAA,GAAAG,CAAA;AAEpCyE,MAAM,CAACC,OAAO,GAAG;EACfrE,UAAU;EACVmE;AACF,CAAC","ignoreList":[]}