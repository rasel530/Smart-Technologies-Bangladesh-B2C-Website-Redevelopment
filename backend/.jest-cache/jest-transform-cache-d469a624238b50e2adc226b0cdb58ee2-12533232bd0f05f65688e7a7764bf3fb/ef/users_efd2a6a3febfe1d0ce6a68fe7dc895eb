9bb59aa4f4263d1f33a77d665e5c311b
const express = require('express');
const {
  body,
  param,
  query,
  validationResult
} = require('express-validator');
const {
  PrismaClient
} = require('@prisma/client');
const {
  authMiddleware
} = require('../middleware/auth');
const router = express.Router();
const prisma = new PrismaClient();

// Validation middleware
const handleValidationErrors = (req, res, next) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({
      error: 'Validation failed',
      details: errors.array()
    });
  }
  next();
};

// Get all users (admin only)
router.get('/', [query('page').optional().isInt({
  min: 1
}), query('limit').optional().isInt({
  min: 1,
  max: 100
}), query('search').optional().isString().trim()], handleValidationErrors, authMiddleware.adminOnly(), async (req, res) => {
  try {
    const {
      page = 1,
      limit = 10,
      search
    } = req.query;
    const skip = (page - 1) * limit;
    const where = search ? {
      OR: [{
        firstName: {
          contains: search,
          mode: 'insensitive'
        }
      }, {
        lastName: {
          contains: search,
          mode: 'insensitive'
        }
      }, {
        email: {
          contains: search,
          mode: 'insensitive'
        }
      }]
    } : {};
    const [users, total] = await Promise.all([prisma.user.findMany({
      where,
      skip: parseInt(skip),
      take: parseInt(limit),
      select: {
        id: true,
        email: true,
        firstName: true,
        lastName: true,
        phone: true,
        role: true,
        status: true,
        createdAt: true,
        lastLoginAt: true,
        _count: {
          orders: true,
          reviews: true
        }
      },
      orderBy: {
        createdAt: 'desc'
      }
    }), prisma.user.count({
      where
    })]);
    res.json({
      users,
      pagination: {
        page: parseInt(page),
        limit: parseInt(limit),
        total,
        pages: Math.ceil(total / limit)
      }
    });
  } catch (error) {
    console.error('Get users error:', error);
    res.status(500).json({
      error: 'Failed to fetch users',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Get user by ID
router.get('/:id', [param('id').isUUID()], handleValidationErrors, authMiddleware.selfOrAdmin(req.params.id), async (req, res) => {
  try {
    const {
      id
    } = req.params;
    const user = await prisma.user.findUnique({
      where: {
        id
      },
      select: {
        id: true,
        email: true,
        firstName: true,
        lastName: true,
        phone: true,
        dateOfBirth: true,
        gender: true,
        role: true,
        status: true,
        image: true,
        createdAt: true,
        updatedAt: true,
        lastLoginAt: true,
        addresses: true,
        _count: {
          orders: true,
          reviews: true
        }
      }
    });
    if (!user) {
      return res.status(404).json({
        error: 'User not found'
      });
    }
    res.json({
      user
    });
  } catch (error) {
    console.error('Get user error:', error);
    res.status(500).json({
      error: 'Failed to fetch user',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Update user profile
router.put('/:id', [param('id').isUUID(), body('firstName').optional().notEmpty().trim(), body('lastName').optional().notEmpty().trim(), body('phone').optional().isMobilePhone('any'), body('dateOfBirth').optional().isISO8601().toDate(), body('gender').optional().isIn(['MALE', 'FEMALE', 'OTHER'])], handleValidationErrors, authMiddleware.selfOrAdmin(req.params.id), async (req, res) => {
  try {
    const {
      id
    } = req.params;
    const {
      firstName,
      lastName,
      phone,
      dateOfBirth,
      gender
    } = req.body;

    // Check if user exists
    const existingUser = await prisma.user.findUnique({
      where: {
        id
      }
    });
    if (!existingUser) {
      return res.status(404).json({
        error: 'User not found'
      });
    }

    // Check if phone is already used by another user
    if (phone && phone !== existingUser.phone) {
      const phoneUser = await prisma.user.findFirst({
        where: {
          phone,
          NOT: {
            id
          }
        }
      });
      if (phoneUser) {
        return res.status(409).json({
          error: 'Phone number already exists'
        });
      }
    }
    const updateData = {};
    if (firstName !== undefined) updateData.firstName = firstName;
    if (lastName !== undefined) updateData.lastName = lastName;
    if (phone !== undefined) updateData.phone = phone;
    if (dateOfBirth !== undefined) updateData.dateOfBirth = dateOfBirth;
    if (gender !== undefined) updateData.gender = gender;
    const updatedUser = await prisma.user.update({
      where: {
        id
      },
      data: updateData,
      select: {
        id: true,
        email: true,
        firstName: true,
        lastName: true,
        phone: true,
        dateOfBirth: true,
        gender: true,
        role: true,
        status: true,
        image: true,
        updatedAt: true
      }
    });
    res.json({
      message: 'User updated successfully',
      user: updatedUser
    });
  } catch (error) {
    console.error('Update user error:', error);
    res.status(500).json({
      error: 'Failed to update user',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Delete user (admin only)
router.delete('/:id', [param('id').isUUID()], handleValidationErrors, authMiddleware.adminOnly(), async (req, res) => {
  try {
    const {
      id
    } = req.params;

    // Check if user exists
    const user = await prisma.user.findUnique({
      where: {
        id
      },
      include: {
        _count: {
          select: {
            orders: true,
            reviews: true
          }
        }
      }
    });
    if (!user) {
      return res.status(404).json({
        error: 'User not found'
      });
    }

    // Check if user has orders (prevent deletion if they do)
    if (user._count.orders > 0) {
      return res.status(400).json({
        error: 'Cannot delete user with existing orders',
        suggestion: 'Consider deactivating the user instead'
      });
    }
    await prisma.user.delete({
      where: {
        id
      }
    });
    res.json({
      message: 'User deleted successfully'
    });
  } catch (error) {
    console.error('Delete user error:', error);
    res.status(500).json({
      error: 'Failed to delete user',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Get user addresses
router.get('/:id/addresses', [param('id').isUUID()], handleValidationErrors, authMiddleware.selfOrAdmin(req.params.id), async (req, res) => {
  try {
    const {
      id
    } = req.params;
    const addresses = await prisma.address.findMany({
      where: {
        userId: id
      },
      orderBy: {
        isDefault: 'desc'
      }
    });
    res.json({
      addresses
    });
  } catch (error) {
    console.error('Get user addresses error:', error);
    res.status(500).json({
      error: 'Failed to fetch addresses',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJvZHkiLCJwYXJhbSIsInF1ZXJ5IiwidmFsaWRhdGlvblJlc3VsdCIsIlByaXNtYUNsaWVudCIsImF1dGhNaWRkbGV3YXJlIiwicm91dGVyIiwiUm91dGVyIiwicHJpc21hIiwiaGFuZGxlVmFsaWRhdGlvbkVycm9ycyIsInJlcSIsInJlcyIsIm5leHQiLCJlcnJvcnMiLCJpc0VtcHR5Iiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZGV0YWlscyIsImFycmF5IiwiZ2V0Iiwib3B0aW9uYWwiLCJpc0ludCIsIm1pbiIsIm1heCIsImlzU3RyaW5nIiwidHJpbSIsImFkbWluT25seSIsInBhZ2UiLCJsaW1pdCIsInNlYXJjaCIsInNraXAiLCJ3aGVyZSIsIk9SIiwiZmlyc3ROYW1lIiwiY29udGFpbnMiLCJtb2RlIiwibGFzdE5hbWUiLCJlbWFpbCIsInVzZXJzIiwidG90YWwiLCJQcm9taXNlIiwiYWxsIiwidXNlciIsImZpbmRNYW55IiwicGFyc2VJbnQiLCJ0YWtlIiwic2VsZWN0IiwiaWQiLCJwaG9uZSIsInJvbGUiLCJjcmVhdGVkQXQiLCJsYXN0TG9naW5BdCIsIl9jb3VudCIsIm9yZGVycyIsInJldmlld3MiLCJvcmRlckJ5IiwiY291bnQiLCJwYWdpbmF0aW9uIiwicGFnZXMiLCJNYXRoIiwiY2VpbCIsImNvbnNvbGUiLCJtZXNzYWdlIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiaXNVVUlEIiwic2VsZk9yQWRtaW4iLCJwYXJhbXMiLCJmaW5kVW5pcXVlIiwiZGF0ZU9mQmlydGgiLCJnZW5kZXIiLCJpbWFnZSIsInVwZGF0ZWRBdCIsImFkZHJlc3NlcyIsInB1dCIsIm5vdEVtcHR5IiwiaXNNb2JpbGVQaG9uZSIsImlzSVNPODYwMSIsInRvRGF0ZSIsImlzSW4iLCJleGlzdGluZ1VzZXIiLCJwaG9uZVVzZXIiLCJmaW5kRmlyc3QiLCJOT1QiLCJ1cGRhdGVEYXRhIiwidW5kZWZpbmVkIiwidXBkYXRlZFVzZXIiLCJ1cGRhdGUiLCJkYXRhIiwiZGVsZXRlIiwiaW5jbHVkZSIsInN1Z2dlc3Rpb24iLCJhZGRyZXNzIiwidXNlcklkIiwiaXNEZWZhdWx0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInVzZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHsgYm9keSwgcGFyYW0sIHF1ZXJ5LCB2YWxpZGF0aW9uUmVzdWx0IH0gPSByZXF1aXJlKCdleHByZXNzLXZhbGlkYXRvcicpO1xyXG5jb25zdCB7IFByaXNtYUNsaWVudCB9ID0gcmVxdWlyZSgnQHByaXNtYS9jbGllbnQnKTtcclxuY29uc3QgeyBhdXRoTWlkZGxld2FyZSB9ID0gcmVxdWlyZSgnLi4vbWlkZGxld2FyZS9hdXRoJyk7XHJcblxyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XHJcblxyXG4vLyBWYWxpZGF0aW9uIG1pZGRsZXdhcmVcclxuY29uc3QgaGFuZGxlVmFsaWRhdGlvbkVycm9ycyA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRpb25SZXN1bHQocmVxKTtcclxuICBpZiAoIWVycm9ycy5pc0VtcHR5KCkpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxyXG4gICAgICBkZXRhaWxzOiBlcnJvcnMuYXJyYXkoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIG5leHQoKTtcclxufTtcclxuXHJcbi8vIEdldCBhbGwgdXNlcnMgKGFkbWluIG9ubHkpXHJcbnJvdXRlci5nZXQoJy8nLCBbXHJcbiAgcXVlcnkoJ3BhZ2UnKS5vcHRpb25hbCgpLmlzSW50KHsgbWluOiAxIH0pLFxyXG4gIHF1ZXJ5KCdsaW1pdCcpLm9wdGlvbmFsKCkuaXNJbnQoeyBtaW46IDEsIG1heDogMTAwIH0pLFxyXG4gIHF1ZXJ5KCdzZWFyY2gnKS5vcHRpb25hbCgpLmlzU3RyaW5nKCkudHJpbSgpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGF1dGhNaWRkbGV3YXJlLmFkbWluT25seSgpLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBwYWdlID0gMSwgbGltaXQgPSAxMCwgc2VhcmNoIH0gPSByZXEucXVlcnk7XHJcbiAgICBjb25zdCBza2lwID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xyXG5cclxuICAgIGNvbnN0IHdoZXJlID0gc2VhcmNoID8ge1xyXG4gICAgICBPUjogW1xyXG4gICAgICAgIHsgZmlyc3ROYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgbGFzdE5hbWU6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgeyBlbWFpbDogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfVxyXG4gICAgICBdXHJcbiAgICB9IDoge307XHJcblxyXG4gICAgY29uc3QgW3VzZXJzLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIHByaXNtYS51c2VyLmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZSxcclxuICAgICAgICBza2lwOiBwYXJzZUludChza2lwKSxcclxuICAgICAgICB0YWtlOiBwYXJzZUludChsaW1pdCksXHJcbiAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICAgIGVtYWlsOiB0cnVlLFxyXG4gICAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgICAgbGFzdE5hbWU6IHRydWUsXHJcbiAgICAgICAgICBwaG9uZTogdHJ1ZSxcclxuICAgICAgICAgIHJvbGU6IHRydWUsXHJcbiAgICAgICAgICBzdGF0dXM6IHRydWUsXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXHJcbiAgICAgICAgICBsYXN0TG9naW5BdDogdHJ1ZSxcclxuICAgICAgICAgIF9jb3VudDoge1xyXG4gICAgICAgICAgICBvcmRlcnM6IHRydWUsXHJcbiAgICAgICAgICAgIHJldmlld3M6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICB9KSxcclxuICAgICAgcHJpc21hLnVzZXIuY291bnQoeyB3aGVyZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICB1c2VycyxcclxuICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgIHBhZ2U6IHBhcnNlSW50KHBhZ2UpLFxyXG4gICAgICAgIGxpbWl0OiBwYXJzZUludChsaW1pdCksXHJcbiAgICAgICAgdG90YWwsXHJcbiAgICAgICAgcGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIGxpbWl0KVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0dldCB1c2VycyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIHVzZXJzJyxcclxuICAgICAgbWVzc2FnZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5tZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcidcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBHZXQgdXNlciBieSBJRFxyXG5yb3V0ZXIuZ2V0KCcvOmlkJywgW1xyXG4gIHBhcmFtKCdpZCcpLmlzVVVJRCgpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGF1dGhNaWRkbGV3YXJlLnNlbGZPckFkbWluKHJlcS5wYXJhbXMuaWQpLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuXHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIGlkOiB0cnVlLFxyXG4gICAgICAgIGVtYWlsOiB0cnVlLFxyXG4gICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcclxuICAgICAgICBsYXN0TmFtZTogdHJ1ZSxcclxuICAgICAgICBwaG9uZTogdHJ1ZSxcclxuICAgICAgICBkYXRlT2ZCaXJ0aDogdHJ1ZSxcclxuICAgICAgICBnZW5kZXI6IHRydWUsXHJcbiAgICAgICAgcm9sZTogdHJ1ZSxcclxuICAgICAgICBzdGF0dXM6IHRydWUsXHJcbiAgICAgICAgaW1hZ2U6IHRydWUsXHJcbiAgICAgICAgY3JlYXRlZEF0OiB0cnVlLFxyXG4gICAgICAgIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgICBsYXN0TG9naW5BdDogdHJ1ZSxcclxuICAgICAgICBhZGRyZXNzZXM6IHRydWUsXHJcbiAgICAgICAgX2NvdW50OiB7XHJcbiAgICAgICAgICBvcmRlcnM6IHRydWUsXHJcbiAgICAgICAgICByZXZpZXdzOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXMuanNvbih7IHVzZXIgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdHZXQgdXNlciBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIHVzZXInLFxyXG4gICAgICBtZXNzYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVycm9yLm1lc3NhZ2UgOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIFVwZGF0ZSB1c2VyIHByb2ZpbGVcclxucm91dGVyLnB1dCgnLzppZCcsIFtcclxuICBwYXJhbSgnaWQnKS5pc1VVSUQoKSxcclxuICBib2R5KCdmaXJzdE5hbWUnKS5vcHRpb25hbCgpLm5vdEVtcHR5KCkudHJpbSgpLFxyXG4gIGJvZHkoJ2xhc3ROYW1lJykub3B0aW9uYWwoKS5ub3RFbXB0eSgpLnRyaW0oKSxcclxuICBib2R5KCdwaG9uZScpLm9wdGlvbmFsKCkuaXNNb2JpbGVQaG9uZSgnYW55JyksXHJcbiAgYm9keSgnZGF0ZU9mQmlydGgnKS5vcHRpb25hbCgpLmlzSVNPODYwMSgpLnRvRGF0ZSgpLFxyXG4gIGJvZHkoJ2dlbmRlcicpLm9wdGlvbmFsKCkuaXNJbihbJ01BTEUnLCAnRkVNQUxFJywgJ09USEVSJ10pXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGF1dGhNaWRkbGV3YXJlLnNlbGZPckFkbWluKHJlcS5wYXJhbXMuaWQpLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgIGNvbnN0IHsgZmlyc3ROYW1lLCBsYXN0TmFtZSwgcGhvbmUsIGRhdGVPZkJpcnRoLCBnZW5kZXIgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzXHJcbiAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCFleGlzdGluZ1VzZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiBwaG9uZSBpcyBhbHJlYWR5IHVzZWQgYnkgYW5vdGhlciB1c2VyXHJcbiAgICBpZiAocGhvbmUgJiYgcGhvbmUgIT09IGV4aXN0aW5nVXNlci5waG9uZSkge1xyXG4gICAgICBjb25zdCBwaG9uZVVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IHBob25lLCBOT1Q6IHsgaWQgfSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKHBob25lVXNlcikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwOSkuanNvbih7XHJcbiAgICAgICAgICBlcnJvcjogJ1Bob25lIG51bWJlciBhbHJlYWR5IGV4aXN0cydcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7fTtcclxuICAgIGlmIChmaXJzdE5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5maXJzdE5hbWUgPSBmaXJzdE5hbWU7XHJcbiAgICBpZiAobGFzdE5hbWUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5sYXN0TmFtZSA9IGxhc3ROYW1lO1xyXG4gICAgaWYgKHBob25lICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEucGhvbmUgPSBwaG9uZTtcclxuICAgIGlmIChkYXRlT2ZCaXJ0aCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmRhdGVPZkJpcnRoID0gZGF0ZU9mQmlydGg7XHJcbiAgICBpZiAoZ2VuZGVyICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuZ2VuZGVyID0gZ2VuZGVyO1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgZGF0YTogdXBkYXRlRGF0YSxcclxuICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgaWQ6IHRydWUsXHJcbiAgICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgIGxhc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgIHBob25lOiB0cnVlLFxyXG4gICAgICAgIGRhdGVPZkJpcnRoOiB0cnVlLFxyXG4gICAgICAgIGdlbmRlcjogdHJ1ZSxcclxuICAgICAgICByb2xlOiB0cnVlLFxyXG4gICAgICAgIHN0YXR1czogdHJ1ZSxcclxuICAgICAgICBpbWFnZTogdHJ1ZSxcclxuICAgICAgICB1cGRhdGVkQXQ6IHRydWVcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiAnVXNlciB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsXHJcbiAgICAgIHVzZXI6IHVwZGF0ZWRVc2VyXHJcbiAgICB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1VwZGF0ZSB1c2VyIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gdXBkYXRlIHVzZXInLFxyXG4gICAgICBtZXNzYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVycm9yLm1lc3NhZ2UgOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIERlbGV0ZSB1c2VyIChhZG1pbiBvbmx5KVxyXG5yb3V0ZXIuZGVsZXRlKCcvOmlkJywgW1xyXG4gIHBhcmFtKCdpZCcpLmlzVVVJRCgpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGF1dGhNaWRkbGV3YXJlLmFkbWluT25seSgpLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuXHJcbiAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0c1xyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgX2NvdW50OiB7XHJcbiAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgb3JkZXJzOiB0cnVlLFxyXG4gICAgICAgICAgICByZXZpZXdzOiB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiB1c2VyIGhhcyBvcmRlcnMgKHByZXZlbnQgZGVsZXRpb24gaWYgdGhleSBkbylcclxuICAgIGlmICh1c2VyLl9jb3VudC5vcmRlcnMgPiAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdDYW5ub3QgZGVsZXRlIHVzZXIgd2l0aCBleGlzdGluZyBvcmRlcnMnLFxyXG4gICAgICAgIHN1Z2dlc3Rpb246ICdDb25zaWRlciBkZWFjdGl2YXRpbmcgdGhlIHVzZXIgaW5zdGVhZCdcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgcHJpc21hLnVzZXIuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiAnVXNlciBkZWxldGVkIHN1Y2Nlc3NmdWxseSdcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGVsZXRlIHVzZXIgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBlcnJvcjogJ0ZhaWxlZCB0byBkZWxldGUgdXNlcicsXHJcbiAgICAgIG1lc3NhZ2U6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gR2V0IHVzZXIgYWRkcmVzc2VzXHJcbnJvdXRlci5nZXQoJy86aWQvYWRkcmVzc2VzJywgW1xyXG4gIHBhcmFtKCdpZCcpLmlzVVVJRCgpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGF1dGhNaWRkbGV3YXJlLnNlbGZPckFkbWluKHJlcS5wYXJhbXMuaWQpLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuXHJcbiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBwcmlzbWEuYWRkcmVzcy5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IHVzZXJJZDogaWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBpc0RlZmF1bHQ6ICdkZXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXMuanNvbih7IGFkZHJlc3NlcyB9KTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0dldCB1c2VyIGFkZHJlc3NlcyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGFkZHJlc3NlcycsXHJcbiAgICAgIG1lc3NhZ2U6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTTtFQUFFQyxJQUFJO0VBQUVDLEtBQUs7RUFBRUMsS0FBSztFQUFFQztBQUFpQixDQUFDLEdBQUdKLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUM3RSxNQUFNO0VBQUVLO0FBQWEsQ0FBQyxHQUFHTCxPQUFPLENBQUMsZ0JBQWdCLENBQUM7QUFDbEQsTUFBTTtFQUFFTTtBQUFlLENBQUMsR0FBR04sT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBRXhELE1BQU1PLE1BQU0sR0FBR1IsT0FBTyxDQUFDUyxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNQyxNQUFNLEdBQUcsSUFBSUosWUFBWSxDQUFDLENBQUM7O0FBRWpDO0FBQ0EsTUFBTUssc0JBQXNCLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDakQsTUFBTUMsTUFBTSxHQUFHVixnQkFBZ0IsQ0FBQ08sR0FBRyxDQUFDO0VBQ3BDLElBQUksQ0FBQ0csTUFBTSxDQUFDQyxPQUFPLENBQUMsQ0FBQyxFQUFFO0lBQ3JCLE9BQU9ILEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFDMUJDLEtBQUssRUFBRSxtQkFBbUI7TUFDMUJDLE9BQU8sRUFBRUwsTUFBTSxDQUFDTSxLQUFLLENBQUM7SUFDeEIsQ0FBQyxDQUFDO0VBQ0o7RUFDQVAsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDOztBQUVEO0FBQ0FOLE1BQU0sQ0FBQ2MsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUNkbEIsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDbUIsUUFB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