58b96d58d85e1dbada3b18275d133ffa
const express = require('express');
const {
  body,
  validationResult
} = require('express-validator');
const bcrypt = require('bcryptjs');
const jwt = require('jsonwebtoken');
const {
  PrismaClient
} = require('@prisma/client');
const router = express.Router();
const prisma = new PrismaClient();

// Validation middleware
const handleValidationErrors = (req, res, next) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({
      error: 'Validation failed',
      details: errors.array()
    });
  }
  next();
};

// Register endpoint
router.post('/register', [body('email').isEmail().normalizeEmail(), body('password').isLength({
  min: 6
}), body('firstName').notEmpty().trim(), body('lastName').notEmpty().trim(), body('phone').optional().isMobilePhone('any')], handleValidationErrors, async (req, res) => {
  try {
    const {
      email,
      password,
      firstName,
      lastName,
      phone
    } = req.body;

    // Check if user already exists
    const existingUser = await prisma.user.findFirst({
      where: {
        OR: [{
          email
        }, ...(phone ? [{
          phone
        }] : [])]
      }
    });
    if (existingUser) {
      return res.status(409).json({
        error: 'User already exists',
        field: existingUser.email === email ? 'email' : 'phone'
      });
    }

    // Hash password
    const securityConfig = require('../services/config').configService.getSecurityConfig();
    const hashedPassword = await bcrypt.hash(password, securityConfig.bcryptRounds);

    // Create user
    const user = await prisma.user.create({
      data: {
        email,
        password: hashedPassword,
        firstName,
        lastName,
        phone,
        role: 'CUSTOMER'
      },
      select: {
        id: true,
        email: true,
        firstName: true,
        lastName: true,
        phone: true,
        role: true,
        status: true,
        createdAt: true
      }
    });

    // Generate JWT token
    const jwtSecretRegister = process.env.JWT_SECRET;
    if (!jwtSecretRegister) {
      throw new Error('JWT_SECRET environment variable is required');
    }
    const token = jwt.sign({
      userId: user.id,
      email: user.email,
      role: user.role
    }, jwtSecretRegister, {
      expiresIn: '7d'
    });
    res.status(201).json({
      message: 'User registered successfully',
      user,
      token
    });
  } catch (error) {
    console.error('Registration error:', error);
    res.status(500).json({
      error: 'Registration failed',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Login endpoint
router.post('/login', [body('email').isEmail().normalizeEmail(), body('password').notEmpty()], handleValidationErrors, async (req, res) => {
  try {
    const {
      email,
      password
    } = req.body;

    // Find user
    const user = await prisma.user.findUnique({
      where: {
        email
      }
    });
    if (!user || !user.password) {
      return res.status(401).json({
        error: 'Invalid credentials'
      });
    }

    // Verify password
    const isValidPassword = await bcrypt.compare(password, user.password);
    if (!isValidPassword) {
      return res.status(401).json({
        error: 'Invalid credentials'
      });
    }

    // Update last login
    await prisma.user.update({
      where: {
        id: user.id
      },
      data: {
        lastLoginAt: new Date()
      }
    });

    // Generate JWT token
    const jwtSecretLogin = process.env.JWT_SECRET;
    if (!jwtSecretLogin) {
      throw new Error('JWT_SECRET environment variable is required');
    }
    const token = jwt.sign({
      userId: user.id,
      email: user.email,
      role: user.role
    }, jwtSecretLogin, {
      expiresIn: '7d'
    });
    res.json({
      message: 'Login successful',
      user: {
        id: user.id,
        email: user.email,
        firstName: user.firstName,
        lastName: user.lastName,
        role: user.role,
        status: user.status
      },
      token
    });
  } catch (error) {
    console.error('Login error:', error);
    res.status(500).json({
      error: 'Login failed',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Logout endpoint
router.post('/logout', async (req, res) => {
  try {
    // In a real implementation, you would invalidate the token
    // For now, we'll just return success
    res.json({
      message: 'Logout successful'
    });
  } catch (error) {
    console.error('Logout error:', error);
    res.status(500).json({
      error: 'Logout failed',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error'
    });
  }
});

// Refresh token endpoint
router.post('/refresh', async (req, res) => {
  try {
    const {
      token
    } = req.body;
    if (!token) {
      return res.status(401).json({
        error: 'Token required'
      });
    }

    // Verify token
    const jwtSecretRefresh = process.env.JWT_SECRET;
    if (!jwtSecretRefresh) {
      throw new Error('JWT_SECRET environment variable is required');
    }
    const decoded = jwt.verify(token, jwtSecretRefresh);

    // Get user info
    const user = await prisma.user.findUnique({
      where: {
        id: decoded.userId
      },
      select: {
        id: true,
        email: true,
        firstName: true,
        lastName: true,
        role: true,
        status: true
      }
    });
    if (!user) {
      return res.status(401).json({
        error: 'User not found'
      });
    }

    // Generate new token
    const jwtSecretNew = process.env.JWT_SECRET;
    if (!jwtSecretNew) {
      throw new Error('JWT_SECRET environment variable is required');
    }
    const newToken = jwt.sign({
      userId: user.id,
      email: user.email,
      role: user.role
    }, jwtSecretNew, {
      expiresIn: '7d'
    });
    res.json({
      message: 'Token refreshed successfully',
      user,
      token: newToken
    });
  } catch (error) {
    console.error('Token refresh error:', error);
    res.status(401).json({
      error: 'Invalid token',
      message: process.env.NODE_ENV === 'development' ? error.message : 'Token expired or invalid'
    });
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImJvZHkiLCJ2YWxpZGF0aW9uUmVzdWx0IiwiYmNyeXB0Iiwiand0IiwiUHJpc21hQ2xpZW50Iiwicm91dGVyIiwiUm91dGVyIiwicHJpc21hIiwiaGFuZGxlVmFsaWRhdGlvbkVycm9ycyIsInJlcSIsInJlcyIsIm5leHQiLCJlcnJvcnMiLCJpc0VtcHR5Iiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZGV0YWlscyIsImFycmF5IiwicG9zdCIsImlzRW1haWwiLCJub3JtYWxpemVFbWFpbCIsImlzTGVuZ3RoIiwibWluIiwibm90RW1wdHkiLCJ0cmltIiwib3B0aW9uYWwiLCJpc01vYmlsZVBob25lIiwiZW1haWwiLCJwYXNzd29yZCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwicGhvbmUiLCJleGlzdGluZ1VzZXIiLCJ1c2VyIiwiZmluZEZpcnN0Iiwid2hlcmUiLCJPUiIsImZpZWxkIiwic2VjdXJpdHlDb25maWciLCJjb25maWdTZXJ2aWNlIiwiZ2V0U2VjdXJpdHlDb25maWciLCJoYXNoZWRQYXNzd29yZCIsImhhc2giLCJiY3J5cHRSb3VuZHMiLCJjcmVhdGUiLCJkYXRhIiwicm9sZSIsInNlbGVjdCIsImlkIiwiY3JlYXRlZEF0Iiwiand0U2VjcmV0UmVnaXN0ZXIiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsIkVycm9yIiwidG9rZW4iLCJzaWduIiwidXNlcklkIiwiZXhwaXJlc0luIiwibWVzc2FnZSIsImNvbnNvbGUiLCJOT0RFX0VOViIsImZpbmRVbmlxdWUiLCJpc1ZhbGlkUGFzc3dvcmQiLCJjb21wYXJlIiwidXBkYXRlIiwibGFzdExvZ2luQXQiLCJEYXRlIiwiand0U2VjcmV0TG9naW4iLCJqd3RTZWNyZXRSZWZyZXNoIiwiZGVjb2RlZCIsInZlcmlmeSIsImp3dFNlY3JldE5ldyIsIm5ld1Rva2VuIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImF1dGguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3QgeyBib2R5LCB2YWxpZGF0aW9uUmVzdWx0IH0gPSByZXF1aXJlKCdleHByZXNzLXZhbGlkYXRvcicpO1xyXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpO1xyXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcclxuY29uc3QgeyBQcmlzbWFDbGllbnQgfSA9IHJlcXVpcmUoJ0BwcmlzbWEvY2xpZW50Jyk7XHJcblxyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XHJcblxyXG4vLyBWYWxpZGF0aW9uIG1pZGRsZXdhcmVcclxuY29uc3QgaGFuZGxlVmFsaWRhdGlvbkVycm9ycyA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRpb25SZXN1bHQocmVxKTtcclxuICBpZiAoIWVycm9ycy5pc0VtcHR5KCkpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxyXG4gICAgICBkZXRhaWxzOiBlcnJvcnMuYXJyYXkoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIG5leHQoKTtcclxufTtcclxuXHJcbi8vIFJlZ2lzdGVyIGVuZHBvaW50XHJcbnJvdXRlci5wb3N0KCcvcmVnaXN0ZXInLCBbXHJcbiAgYm9keSgnZW1haWwnKS5pc0VtYWlsKCkubm9ybWFsaXplRW1haWwoKSxcclxuICBib2R5KCdwYXNzd29yZCcpLmlzTGVuZ3RoKHsgbWluOiA2IH0pLFxyXG4gIGJvZHkoJ2ZpcnN0TmFtZScpLm5vdEVtcHR5KCkudHJpbSgpLFxyXG4gIGJvZHkoJ2xhc3ROYW1lJykubm90RW1wdHkoKS50cmltKCksXHJcbiAgYm9keSgncGhvbmUnKS5vcHRpb25hbCgpLmlzTW9iaWxlUGhvbmUoJ2FueScpXHJcbl0sIGhhbmRsZVZhbGlkYXRpb25FcnJvcnMsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCwgZmlyc3ROYW1lLCBsYXN0TmFtZSwgcGhvbmUgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHVzZXIgYWxyZWFkeSBleGlzdHNcclxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRGaXJzdCh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgT1I6IFtcclxuICAgICAgICAgIHsgZW1haWwgfSxcclxuICAgICAgICAgIC4uLihwaG9uZSA/IFt7IHBob25lIH1dIDogW10pXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwOSkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdVc2VyIGFscmVhZHkgZXhpc3RzJyxcclxuICAgICAgICBmaWVsZDogZXhpc3RpbmdVc2VyLmVtYWlsID09PSBlbWFpbCA/ICdlbWFpbCcgOiAncGhvbmUnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEhhc2ggcGFzc3dvcmRcclxuICAgIGNvbnN0IHNlY3VyaXR5Q29uZmlnID0gcmVxdWlyZSgnLi4vc2VydmljZXMvY29uZmlnJykuY29uZmlnU2VydmljZS5nZXRTZWN1cml0eUNvbmZpZygpO1xyXG4gICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgc2VjdXJpdHlDb25maWcuYmNyeXB0Um91bmRzKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgdXNlclxyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmNyZWF0ZSh7XHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBlbWFpbCxcclxuICAgICAgICBwYXNzd29yZDogaGFzaGVkUGFzc3dvcmQsXHJcbiAgICAgICAgZmlyc3ROYW1lLFxyXG4gICAgICAgIGxhc3ROYW1lLFxyXG4gICAgICAgIHBob25lLFxyXG4gICAgICAgIHJvbGU6ICdDVVNUT01FUidcclxuICAgICAgfSxcclxuICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgaWQ6IHRydWUsXHJcbiAgICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgIGxhc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgIHBob25lOiB0cnVlLFxyXG4gICAgICAgIHJvbGU6IHRydWUsXHJcbiAgICAgICAgc3RhdHVzOiB0cnVlLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogdHJ1ZVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBKV1QgdG9rZW5cclxuICAgIGNvbnN0IGp3dFNlY3JldFJlZ2lzdGVyID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVDtcclxuICAgIGlmICghand0U2VjcmV0UmVnaXN0ZXIpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdKV1RfU0VDUkVUIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIHJlcXVpcmVkJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oXHJcbiAgICAgIHsgdXNlcklkOiB1c2VyLmlkLCBlbWFpbDogdXNlci5lbWFpbCwgcm9sZTogdXNlci5yb2xlIH0sXHJcbiAgICAgIGp3dFNlY3JldFJlZ2lzdGVyLFxyXG4gICAgICB7IGV4cGlyZXNJbjogJzdkJyB9XHJcbiAgICApO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcclxuICAgICAgbWVzc2FnZTogJ1VzZXIgcmVnaXN0ZXJlZCBzdWNjZXNzZnVsbHknLFxyXG4gICAgICB1c2VyLFxyXG4gICAgICB0b2tlblxyXG4gICAgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdSZWdpc3RyYXRpb24gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICBlcnJvcjogJ1JlZ2lzdHJhdGlvbiBmYWlsZWQnLFxyXG4gICAgICBtZXNzYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IGVycm9yLm1lc3NhZ2UgOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIExvZ2luIGVuZHBvaW50XHJcbnJvdXRlci5wb3N0KCcvbG9naW4nLCBbXHJcbiAgYm9keSgnZW1haWwnKS5pc0VtYWlsKCkubm9ybWFsaXplRW1haWwoKSxcclxuICBib2R5KCdwYXNzd29yZCcpLm5vdEVtcHR5KClcclxuXSwgaGFuZGxlVmFsaWRhdGlvbkVycm9ycywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICAvLyBGaW5kIHVzZXJcclxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgZW1haWwgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKCF1c2VyIHx8ICF1c2VyLnBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGNyZWRlbnRpYWxzJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZnkgcGFzc3dvcmRcclxuICAgIGNvbnN0IGlzVmFsaWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKTtcclxuICAgIGlmICghaXNWYWxpZFBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIGNyZWRlbnRpYWxzJ1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgbGFzdCBsb2dpblxyXG4gICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQ6IHVzZXIuaWQgfSxcclxuICAgICAgZGF0YTogeyBsYXN0TG9naW5BdDogbmV3IERhdGUoKSB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBKV1QgdG9rZW5cclxuICAgIGNvbnN0IGp3dFNlY3JldExvZ2luID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVDtcclxuICAgIGlmICghand0U2VjcmV0TG9naW4pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdKV1RfU0VDUkVUIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIHJlcXVpcmVkJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oXHJcbiAgICAgIHsgdXNlcklkOiB1c2VyLmlkLCBlbWFpbDogdXNlci5lbWFpbCwgcm9sZTogdXNlci5yb2xlIH0sXHJcbiAgICAgIGp3dFNlY3JldExvZ2luLFxyXG4gICAgICB7IGV4cGlyZXNJbjogJzdkJyB9XHJcbiAgICApO1xyXG5cclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgbWVzc2FnZTogJ0xvZ2luIHN1Y2Nlc3NmdWwnLFxyXG4gICAgICB1c2VyOiB7XHJcbiAgICAgICAgaWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICAgICAgZmlyc3ROYW1lOiB1c2VyLmZpcnN0TmFtZSxcclxuICAgICAgICBsYXN0TmFtZTogdXNlci5sYXN0TmFtZSxcclxuICAgICAgICByb2xlOiB1c2VyLnJvbGUsXHJcbiAgICAgICAgc3RhdHVzOiB1c2VyLnN0YXR1c1xyXG4gICAgICB9LFxyXG4gICAgICB0b2tlblxyXG4gICAgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdMb2dpbiBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnTG9naW4gZmFpbGVkJyxcclxuICAgICAgbWVzc2FnZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5tZXNzYWdlIDogJ0ludGVybmFsIHNlcnZlciBlcnJvcidcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBMb2dvdXQgZW5kcG9pbnRcclxucm91dGVyLnBvc3QoJy9sb2dvdXQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB5b3Ugd291bGQgaW52YWxpZGF0ZSB0aGUgdG9rZW5cclxuICAgIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgcmV0dXJuIHN1Y2Nlc3NcclxuICAgIHJlcy5qc29uKHtcclxuICAgICAgbWVzc2FnZTogJ0xvZ291dCBzdWNjZXNzZnVsJ1xyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ291dCBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgIGVycm9yOiAnTG9nb3V0IGZhaWxlZCcsXHJcbiAgICAgIG1lc3NhZ2U6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyb3IubWVzc2FnZSA6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuLy8gUmVmcmVzaCB0b2tlbiBlbmRwb2ludFxyXG5yb3V0ZXIucG9zdCgnL3JlZnJlc2gnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyB0b2tlbiB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICAgIGVycm9yOiAnVG9rZW4gcmVxdWlyZWQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmeSB0b2tlblxyXG4gICAgY29uc3Qgand0U2VjcmV0UmVmcmVzaCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQ7XHJcbiAgICBpZiAoIWp3dFNlY3JldFJlZnJlc2gpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdKV1RfU0VDUkVUIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIHJlcXVpcmVkJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBqd3RTZWNyZXRSZWZyZXNoKTtcclxuICAgIFxyXG4gICAgLy8gR2V0IHVzZXIgaW5mb1xyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICB3aGVyZTogeyBpZDogZGVjb2RlZC51c2VySWQgfSxcclxuICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgaWQ6IHRydWUsXHJcbiAgICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgICAgZmlyc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgIGxhc3ROYW1lOiB0cnVlLFxyXG4gICAgICAgIHJvbGU6IHRydWUsXHJcbiAgICAgICAgc3RhdHVzOiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghdXNlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICAgIGVycm9yOiAnVXNlciBub3QgZm91bmQnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIG5ldyB0b2tlblxyXG4gICAgY29uc3Qgand0U2VjcmV0TmV3ID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVDtcclxuICAgIGlmICghand0U2VjcmV0TmV3KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSldUX1NFQ1JFVCBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyByZXF1aXJlZCcpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBuZXdUb2tlbiA9IGp3dC5zaWduKFxyXG4gICAgICB7IHVzZXJJZDogdXNlci5pZCwgZW1haWw6IHVzZXIuZW1haWwsIHJvbGU6IHVzZXIucm9sZSB9LFxyXG4gICAgICBqd3RTZWNyZXROZXcsXHJcbiAgICAgIHsgZXhwaXJlc0luOiAnN2QnIH1cclxuICAgICk7XHJcblxyXG4gICAgcmVzLmpzb24oe1xyXG4gICAgICBtZXNzYWdlOiAnVG9rZW4gcmVmcmVzaGVkIHN1Y2Nlc3NmdWxseScsXHJcbiAgICAgIHVzZXIsXHJcbiAgICAgIHRva2VuOiBuZXdUb2tlblxyXG4gICAgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdUb2tlbiByZWZyZXNoIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcclxuICAgICAgZXJyb3I6ICdJbnZhbGlkIHRva2VuJyxcclxuICAgICAgbWVzc2FnZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBlcnJvci5tZXNzYWdlIDogJ1Rva2VuIGV4cGlyZWQgb3IgaW52YWxpZCdcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNO0VBQUVDLElBQUk7RUFBRUM7QUFBaUIsQ0FBQyxHQUFHRixPQUFPLENBQUMsbUJBQW1CLENBQUM7QUFDL0QsTUFBTUcsTUFBTSxHQUFHSCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ2xD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