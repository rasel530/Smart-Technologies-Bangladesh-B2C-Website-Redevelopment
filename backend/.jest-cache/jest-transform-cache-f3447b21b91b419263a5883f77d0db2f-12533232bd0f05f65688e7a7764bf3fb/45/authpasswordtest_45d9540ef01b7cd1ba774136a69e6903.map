{"version":3,"names":["_getJestObj","mock","jest","require","request","express","PrismaClient","passwordService","jwt","describe","app","prisma","mockUser","beforeEach","use","json","id","email","firstName","lastName","phone","password","role","status","clearAllMocks","validatePasswordStrength","mockReturnValue","isValid","score","strength","feedback","warnings","suggestions","hashPassword","mockResolvedValue","verifyPassword","isPasswordReused","savePasswordToHistory","test","userData","user","findFirst","create","response","post","send","expect","toBe","toHaveBeenCalledWith","toHaveBeenCalled","body","error","details","toEqual","passwordPolicy","any","Object","toContain","mockAuthMiddleware","req","res","next","passwordData","currentPassword","newPassword","confirmPassword","findUnique","update","message","emailData","emailVerificationToken","mockEmailService","emailService","sendPasswordResetEmail","success","messageId","generateStrongPassword","resetData","token","userId","expiresAt","Date","now","delete","get","policy"],"sources":["auth-password.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\nconst { PrismaClient } = require('@prisma/client');\r\nconst { passwordService } = require('../services/passwordService');\r\nconst jwt = require('jsonwebtoken');\r\n\r\n// Mock dependencies\r\njest.mock('../services/passwordService');\r\njest.mock('../services/emailService');\r\njest.mock('@prisma/client');\r\n\r\ndescribe('Auth Password Endpoints', () => {\r\n  let app;\r\n  let prisma;\r\n  let mockUser;\r\n\r\n  beforeEach(() => {\r\n    app = express();\r\n    app.use(express.json());\r\n    \r\n    // Mock Prisma Client\r\n    prisma = new PrismaClient();\r\n    \r\n    mockUser = {\r\n      id: 'user-123',\r\n      email: 'test@example.com',\r\n      firstName: 'Test',\r\n      lastName: 'User',\r\n      phone: '+8801712345678',\r\n      password: 'hashed_password',\r\n      role: 'CUSTOMER',\r\n      status: 'ACTIVE'\r\n    };\r\n\r\n    // Reset all mocks\r\n    jest.clearAllMocks();\r\n    \r\n    // Setup default mock returns\r\n    passwordService.validatePasswordStrength.mockReturnValue({\r\n      isValid: true,\r\n      score: 4,\r\n      strength: 'strong',\r\n      feedback: [],\r\n      warnings: [],\r\n      suggestions: []\r\n    });\r\n    \r\n    passwordService.hashPassword.mockResolvedValue('new_hashed_password');\r\n    passwordService.verifyPassword.mockResolvedValue(true);\r\n    passwordService.isPasswordReused.mockResolvedValue(false);\r\n    passwordService.savePasswordToHistory.mockResolvedValue({ id: 'history-123' });\r\n  });\r\n\r\n  describe('POST /auth/register with password validation', () => {\r\n    test('should register user with strong password', async () => {\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'StrongPassword123!',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        phone: '+8801712345678'\r\n      };\r\n\r\n      // Mock Prisma operations\r\n      prisma.user.findFirst.mockResolvedValue(null);\r\n      prisma.user.create.mockResolvedValue({\r\n        id: 'user-123',\r\n        email: userData.email,\r\n        firstName: userData.firstName,\r\n        lastName: userData.lastName,\r\n        phone: '+8801712345678',\r\n        role: 'CUSTOMER',\r\n        status: 'PENDING'\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/auth/register')\r\n        .send(userData);\r\n\r\n      expect(response.status).toBe(201);\r\n      expect(passwordService.validatePasswordStrength).toHaveBeenCalledWith(\r\n        userData.password,\r\n        {\r\n          firstName: userData.firstName,\r\n          lastName: userData.lastName,\r\n          email: userData.email,\r\n          phone: userData.phone\r\n        }\r\n      );\r\n      expect(passwordService.hashPassword).toHaveBeenCalledWith(userData.password);\r\n      expect(passwordService.savePasswordToHistory).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should reject registration with weak password', async () => {\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'weak',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        phone: '+8801712345678'\r\n      };\r\n\r\n      passwordService.validatePasswordStrength.mockReturnValue({\r\n        isValid: false,\r\n        score: 1,\r\n        strength: 'weak',\r\n        feedback: ['Password is too weak'],\r\n        warnings: ['Common password pattern'],\r\n        suggestions: ['Use a mix of characters']\r\n      });\r\n\r\n      prisma.user.findFirst.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/register')\r\n        .send(userData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Password does not meet requirements');\r\n      expect(response.body.details).toEqual({\r\n        strength: 'weak',\r\n        score: 1,\r\n        feedback: ['Password is too weak'],\r\n        warnings: ['Common password pattern'],\r\n        suggestions: ['Use a mix of characters'],\r\n        passwordPolicy: expect.any(Object)\r\n      });\r\n    });\r\n\r\n    test('should reject password shorter than 8 characters', async () => {\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'Ab1!', // Only 4 characters\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        phone: '+8801712345678'\r\n      };\r\n\r\n      prisma.user.findFirst.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/register')\r\n        .send(userData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toContain('minimum');\r\n    });\r\n  });\r\n\r\n  describe('POST /auth/change-password', () => {\r\n    beforeEach(() => {\r\n      // Setup auth middleware mock\r\n      const mockAuthMiddleware = (req, res, next) => {\r\n        req.user = mockUser;\r\n        next();\r\n      };\r\n      \r\n      app.use('/auth/change-password', mockAuthMiddleware);\r\n    });\r\n\r\n    test('should change password successfully', async () => {\r\n      const passwordData = {\r\n        currentPassword: 'CurrentPassword123!',\r\n        newPassword: 'NewPassword456!',\r\n        confirmPassword: 'NewPassword456!'\r\n      };\r\n\r\n      prisma.user.findUnique.mockResolvedValue(mockUser);\r\n      prisma.user.update.mockResolvedValue({});\r\n\r\n      const response = await request(app)\r\n        .post('/auth/change-password')\r\n        .send(passwordData);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.message).toBe('Password changed successfully');\r\n      expect(passwordService.verifyPassword).toHaveBeenCalledWith(\r\n        passwordData.currentPassword,\r\n        mockUser.password\r\n      );\r\n      expect(passwordService.validatePasswordStrength).toHaveBeenCalled();\r\n      expect(passwordService.isPasswordReused).toHaveBeenCalled();\r\n      expect(passwordService.hashPassword).toHaveBeenCalledWith(passwordData.newPassword);\r\n      expect(passwordService.savePasswordToHistory).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should reject if current password is incorrect', async () => {\r\n      const passwordData = {\r\n        currentPassword: 'WrongPassword',\r\n        newPassword: 'NewPassword456!',\r\n        confirmPassword: 'NewPassword456!'\r\n      };\r\n\r\n      passwordService.verifyPassword.mockResolvedValue(false);\r\n      prisma.user.findUnique.mockResolvedValue(mockUser);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/change-password')\r\n        .send(passwordData);\r\n\r\n      expect(response.status).toBe(401);\r\n      expect(response.body.error).toBe('Invalid current password');\r\n    });\r\n\r\n    test('should reject if new passwords do not match', async () => {\r\n      const passwordData = {\r\n        currentPassword: 'CurrentPassword123!',\r\n        newPassword: 'NewPassword456!',\r\n        confirmPassword: 'DifferentPassword789!'\r\n      };\r\n\r\n      prisma.user.findUnique.mockResolvedValue(mockUser);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/change-password')\r\n        .send(passwordData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Passwords do not match');\r\n    });\r\n\r\n    test('should reject if new password is same as current', async () => {\r\n      const passwordData = {\r\n        currentPassword: 'SamePassword123!',\r\n        newPassword: 'SamePassword123!',\r\n        confirmPassword: 'SamePassword123!'\r\n      };\r\n\r\n      passwordService.verifyPassword.mockResolvedValue(true);\r\n      prisma.user.findUnique.mockResolvedValue(mockUser);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/change-password')\r\n        .send(passwordData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Same password');\r\n    });\r\n\r\n    test('should reject if new password was previously used', async () => {\r\n      const passwordData = {\r\n        currentPassword: 'CurrentPassword123!',\r\n        newPassword: 'OldPassword456!',\r\n        confirmPassword: 'OldPassword456!'\r\n      };\r\n\r\n      passwordService.isPasswordReused.mockResolvedValue(true);\r\n      prisma.user.findUnique.mockResolvedValue(mockUser);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/change-password')\r\n        .send(passwordData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Password already used');\r\n      expect(response.body.message).toContain('last 5 changes');\r\n    });\r\n  });\r\n\r\n  describe('POST /auth/forgot-password', () => {\r\n    test('should send password reset email', async () => {\r\n      const emailData = { email: 'test@example.com' };\r\n      \r\n      prisma.user.findUnique.mockResolvedValue(mockUser);\r\n      prisma.emailVerificationToken.create.mockResolvedValue({ id: 'token-123' });\r\n\r\n      const mockEmailService = require('../services/emailService');\r\n      mockEmailService.emailService.sendPasswordResetEmail.mockResolvedValue({\r\n        success: true,\r\n        messageId: 'email-123'\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/auth/forgot-password')\r\n        .send(emailData);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.message).toBe('Password reset email sent successfully');\r\n      expect(passwordService.generateStrongPassword).toHaveBeenCalled();\r\n      expect(passwordService.hashPassword).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should not reveal if user exists', async () => {\r\n      const emailData = { email: 'nonexistent@example.com' };\r\n      \r\n      prisma.user.findUnique.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/forgot-password')\r\n        .send(emailData);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.message).toContain('If an account with that email exists');\r\n    });\r\n  });\r\n\r\n  describe('POST /auth/reset-password', () => {\r\n    test('should reset password successfully', async () => {\r\n      const resetData = {\r\n        token: 'valid-token-123',\r\n        newPassword: 'NewPassword456!',\r\n        confirmPassword: 'NewPassword456!'\r\n      };\r\n\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue({\r\n        id: 'token-123',\r\n        userId: 'user-123',\r\n        expiresAt: new Date(Date.now() + 60000), // Future\r\n        user: mockUser\r\n      });\r\n\r\n      prisma.user.update.mockResolvedValue({});\r\n      prisma.emailVerificationToken.delete.mockResolvedValue({});\r\n\r\n      const response = await request(app)\r\n        .post('/auth/reset-password')\r\n        .send(resetData);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.message).toBe('Password reset successfully');\r\n      expect(passwordService.validatePasswordStrength).toHaveBeenCalled();\r\n      expect(passwordService.isPasswordReused).toHaveBeenCalled();\r\n    });\r\n\r\n    test('should reject invalid token', async () => {\r\n      const resetData = {\r\n        token: 'invalid-token',\r\n        newPassword: 'NewPassword456!',\r\n        confirmPassword: 'NewPassword456!'\r\n      };\r\n\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/reset-password')\r\n        .send(resetData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Invalid token');\r\n    });\r\n\r\n    test('should reject expired token', async () => {\r\n      const resetData = {\r\n        token: 'expired-token',\r\n        newPassword: 'NewPassword456!',\r\n        confirmPassword: 'NewPassword456!'\r\n      };\r\n\r\n      prisma.emailVerificationToken.findUnique.mockResolvedValue({\r\n        id: 'token-123',\r\n        userId: 'user-123',\r\n        expiresAt: new Date(Date.now() - 60000), // Past\r\n        user: mockUser\r\n      });\r\n\r\n      const response = await request(app)\r\n        .post('/auth/reset-password')\r\n        .send(resetData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Token expired');\r\n    });\r\n  });\r\n\r\n  describe('GET /auth/password-policy', () => {\r\n    test('should return password policy', async () => {\r\n      const response = await request(app)\r\n        .get('/auth/password-policy');\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body.policy).toEqual(expect.any(Object));\r\n      expect(response.body.message).toBe('Current password policy requirements');\r\n    });\r\n  });\r\n\r\n  describe('Security Features', () => {\r\n    test('should enforce minimum strength score', async () => {\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'FairPassword123',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        phone: '+8801712345678'\r\n      };\r\n\r\n      passwordService.validatePasswordStrength.mockReturnValue({\r\n        isValid: false,\r\n        score: 1, // Below minimum score of 2\r\n        strength: 'weak',\r\n        feedback: ['Password score is too low'],\r\n        warnings: [],\r\n        suggestions: []\r\n      });\r\n\r\n      prisma.user.findFirst.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/register')\r\n        .send(userData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.error).toBe('Password does not meet requirements');\r\n    });\r\n\r\n    test('should prevent common Bangladeshi patterns', async () => {\r\n      const userData = {\r\n        email: 'test@example.com',\r\n        password: 'Dhaka123456',\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n        phone: '+8801712345678'\r\n      };\r\n\r\n      passwordService.validatePasswordStrength.mockReturnValue({\r\n        isValid: false,\r\n        score: 2,\r\n        strength: 'fair',\r\n        feedback: ['Password cannot contain common Bangladeshi terms'],\r\n        warnings: [],\r\n        suggestions: []\r\n      });\r\n\r\n      prisma.user.findFirst.mockResolvedValue(null);\r\n\r\n      const response = await request(app)\r\n        .post('/auth/register')\r\n        .send(userData);\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(response.body.details.feedback).toContain('Bangladeshi');\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}