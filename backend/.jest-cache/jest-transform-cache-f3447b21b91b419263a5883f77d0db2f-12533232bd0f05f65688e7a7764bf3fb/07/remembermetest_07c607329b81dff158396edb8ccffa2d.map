{"version":3,"names":["_getJestObj","mock","logSecurity","jest","fn","logAuth","info","warn","error","get","key","isTestingMode","isEmailVerificationDisabled","isPhoneVerificationDisabled","require","request","express","sessionService","sessionMiddleware","PrismaClient","app","use","json","urlencoded","extended","describe","server","prisma","beforeAll","listen","afterAll","close","$disconnect","beforeEach","clearAllMocks","test","mockReq","ip","mockReturnValue","result","createSession","rememberMe","loginType","expect","toHaveProperty","maxAge","toBe","persistent","createRememberMeToken","success","createResult","validationResult","validateRememberMeToken","token","valid","userId","redis","tokenKey","del","reason","toContain","tokenResult","refreshResult","refreshFromRememberMeToken","mockRes","cookie","clearCookie","headers","setSessionCookie","toHaveBeenCalledWith","any","Object","String","not","clearSessionCookie","testApp","testServer","authRoutes","response","post","send","identifier","password","status","body","mockUser","id","set","allDevices","toMatch","toHaveLength","mockReq1","mockReq2","useFakeTimers","advanceTimersByTime","validation","useRealTimers","loginResponse","cookies","rememberMeCookie","find","startsWith","toBeDefined","refreshResponse","sessionId"],"sources":["remember-me.test.js"],"sourcesContent":["const request = require('supertest');\r\nconst express = require('express');\r\nconst { sessionService } = require('../services/sessionService');\r\nconst { sessionMiddleware } = require('../middleware/session');\r\nconst { PrismaClient } = require('@prisma/client');\r\n\r\nconst app = express();\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\n// Mock services for testing\r\njest.mock('../services/logger', () => ({\r\n  logSecurity: jest.fn(),\r\n  logAuth: jest.fn(),\r\n  info: jest.fn(),\r\n  warn: jest.fn(),\r\n  error: jest.fn()\r\n}));\r\n\r\njest.mock('../services/config', () => ({\r\n  get: jest.fn((key) => {\r\n    if (key === 'REDIS_URL') return 'redis://localhost:6379';\r\n    return null;\r\n  }),\r\n  isTestingMode: () => true,\r\n  isEmailVerificationDisabled: () => true,\r\n  isPhoneVerificationDisabled: () => true\r\n}));\r\n\r\ndescribe('Remember Me Functionality', () => {\r\n  let server;\r\n  let prisma;\r\n\r\n  beforeAll(async () => {\r\n    prisma = new PrismaClient();\r\n    server = app.listen(0);\r\n  });\r\n\r\n  afterAll(async () => {\r\n    if (server) server.close();\r\n    await prisma.$disconnect();\r\n  });\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('Session Service - Remember Me Features', () => {\r\n    describe('createSession with remember me', () => {\r\n      test('should create session with remember me enabled', async () => {\r\n        const mockReq = {\r\n          ip: '127.0.0.1',\r\n          get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n        };\r\n\r\n        const result = await sessionService.createSession('user-123', mockReq, {\r\n          rememberMe: true,\r\n          loginType: 'password'\r\n        });\r\n\r\n        expect(result).toHaveProperty('sessionId');\r\n        expect(result).toHaveProperty('expiresAt');\r\n        expect(result).toHaveProperty('maxAge');\r\n        expect(result).toHaveProperty('rememberMe', true);\r\n        expect(result).toHaveProperty('persistent', true);\r\n        expect(result.maxAge).toBe(7 * 24 * 60 * 60 * 1000); // 7 days\r\n      });\r\n\r\n      test('should create session without remember me', async () => {\r\n        const mockReq = {\r\n          ip: '127.0.0.1',\r\n          get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n        };\r\n\r\n        const result = await sessionService.createSession('user-123', mockReq, {\r\n          rememberMe: false,\r\n          loginType: 'password'\r\n        });\r\n\r\n        expect(result.rememberMe).toBe(false);\r\n        expect(result.persistent).toBe(false);\r\n        expect(result.maxAge).toBe(24 * 60 * 60 * 1000); // 24 hours\r\n      });\r\n    });\r\n\r\n    describe('Remember Me Token Management', () => {\r\n      test('should create remember me token successfully', async () => {\r\n        const mockReq = {\r\n          ip: '127.0.0.1',\r\n          get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n        };\r\n\r\n        const result = await sessionService.createRememberMeToken('user-123', mockReq);\r\n\r\n        expect(result.success).toBe(true);\r\n        expect(result).toHaveProperty('token');\r\n        expect(result).toHaveProperty('expiresAt');\r\n      });\r\n\r\n      test('should validate remember me token successfully', async () => {\r\n        const mockReq = {\r\n          ip: '127.0.0.1',\r\n          get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n        };\r\n\r\n        // First create a token\r\n        const createResult = await sessionService.createRememberMeToken('user-123', mockReq);\r\n        expect(createResult.success).toBe(true);\r\n\r\n        // Then validate it\r\n        const validationResult = await sessionService.validateRememberMeToken(createResult.token);\r\n        expect(validationResult.valid).toBe(true);\r\n        expect(validationResult.userId).toBe('user-123');\r\n      });\r\n\r\n      test('should reject expired remember me token', async () => {\r\n        const mockReq = {\r\n          ip: '127.0.0.1',\r\n          get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n        };\r\n\r\n        // Create token and manually expire it\r\n        const createResult = await sessionService.createRememberMeToken('user-123', mockReq);\r\n        \r\n        // Mock expiration by directly manipulating Redis\r\n        if (sessionService.redis) {\r\n          const tokenKey = `remember_me:${createResult.token}`;\r\n          await sessionService.redis.del(tokenKey);\r\n        }\r\n\r\n        const validationResult = await sessionService.validateRememberMeToken(createResult.token);\r\n        expect(validationResult.valid).toBe(false);\r\n        expect(validationResult.reason).toContain('expired');\r\n      });\r\n\r\n      test('should refresh session from remember me token', async () => {\r\n        const mockReq = {\r\n          ip: '127.0.0.1',\r\n          get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n        };\r\n\r\n        // Create remember me token\r\n        const tokenResult = await sessionService.createRememberMeToken('user-123', mockReq);\r\n        expect(tokenResult.success).toBe(true);\r\n\r\n        // Refresh session from token\r\n        const refreshResult = await sessionService.refreshFromRememberMeToken(tokenResult.token, mockReq);\r\n        expect(refreshResult.success).toBe(true);\r\n        expect(refreshResult).toHaveProperty('sessionId');\r\n        expect(refreshResult).toHaveProperty('expiresAt');\r\n        expect(refreshResult.maxAge).toBe(7 * 24 * 60 * 60 * 1000); // 7 days\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Session Middleware - Remember Me Cookie Management', () => {\r\n    let mockRes;\r\n\r\n    beforeEach(() => {\r\n      mockRes = {\r\n        cookie: jest.fn(),\r\n        clearCookie: jest.fn(),\r\n        headers: {}\r\n      };\r\n    });\r\n\r\n    test('should set remember me cookies when enabled', () => {\r\n      sessionMiddleware.setSessionCookie(mockRes, 'session-123', {\r\n        rememberMe: true,\r\n        maxAge: 7 * 24 * 60 * 60 * 1000\r\n      });\r\n\r\n      expect(mockRes.cookie).toHaveBeenCalledWith('sessionId', 'session-123', expect.any(Object));\r\n      expect(mockRes.cookie).toHaveBeenCalledWith('rememberMe', expect.any(String), expect.any(Object));\r\n      expect(mockRes.cookie).toHaveBeenCalledWith('rememberMeEnabled', 'true', expect.any(Object));\r\n    });\r\n\r\n    test('should not set remember me cookies when disabled', () => {\r\n      sessionMiddleware.setSessionCookie(mockRes, 'session-123', {\r\n        rememberMe: false,\r\n        maxAge: 24 * 60 * 60 * 1000\r\n      });\r\n\r\n      expect(mockRes.cookie).toHaveBeenCalledWith('sessionId', 'session-123', expect.any(Object));\r\n      expect(mockRes.cookie).not.toHaveBeenCalledWith('rememberMe', expect.any(String), expect.any(Object));\r\n      expect(mockRes.clearCookie).toHaveBeenCalledWith('rememberMe', expect.any(Object));\r\n      expect(mockRes.clearCookie).toHaveBeenCalledWith('rememberMeEnabled', expect.any(Object));\r\n    });\r\n\r\n    test('should clear all remember me cookies on logout', () => {\r\n      sessionMiddleware.clearSessionCookie(mockRes);\r\n\r\n      expect(mockRes.clearCookie).toHaveBeenCalledWith('sessionId', expect.any(Object));\r\n      expect(mockRes.clearCookie).toHaveBeenCalledWith('rememberMe', expect.any(Object));\r\n      expect(mockRes.clearCookie).toHaveBeenCalledWith('rememberMeEnabled', expect.any(Object));\r\n    });\r\n  });\r\n\r\n  describe('API Endpoints - Remember Me', () => {\r\n    let testApp;\r\n    let testServer;\r\n\r\n    beforeAll(async () => {\r\n      // Import auth routes for testing\r\n      const authRoutes = require('../routes/auth');\r\n      testApp = express();\r\n      testApp.use(express.json());\r\n      testApp.use('/api/v1/auth', authRoutes);\r\n      testServer = testApp.listen(0);\r\n    });\r\n\r\n    afterAll(async () => {\r\n      if (testServer) testServer.close();\r\n    });\r\n\r\n    test('POST /api/v1/auth/login with remember me true', async () => {\r\n      const response = await request(testApp)\r\n        .post('/api/v1/auth/login')\r\n        .send({\r\n          identifier: 'test@example.com',\r\n          password: 'password123',\r\n          rememberMe: true\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('rememberMe', true);\r\n      expect(response.body).toHaveProperty('maxAge', 7 * 24 * 60 * 60 * 1000);\r\n    });\r\n\r\n    test('POST /api/v1/auth/login with remember me false', async () => {\r\n      const response = await request(testApp)\r\n        .post('/api/v1/auth/login')\r\n        .send({\r\n          identifier: 'test@example.com',\r\n          password: 'password123',\r\n          rememberMe: false\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('rememberMe', false);\r\n      expect(response.body.maxAge).toBe(24 * 60 * 60 * 1000);\r\n    });\r\n\r\n    test('POST /api/v1/auth/validate-remember-me', async () => {\r\n      // Mock a valid remember me token\r\n      const mockReq = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n      };\r\n\r\n      const tokenResult = await sessionService.createRememberMeToken('user-123', mockReq);\r\n      expect(tokenResult.success).toBe(true);\r\n\r\n      const response = await request(testApp)\r\n        .post('/api/v1/auth/validate-remember-me')\r\n        .send({\r\n          token: tokenResult.token\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('tokenValid', true);\r\n      expect(response.body).toHaveProperty('user');\r\n    });\r\n\r\n    test('POST /api/v1/auth/refresh-from-remember-me', async () => {\r\n      // Mock a valid remember me token\r\n      const mockReq = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n      };\r\n\r\n      const tokenResult = await sessionService.createRememberMeToken('user-123', mockReq);\r\n      expect(tokenResult.success).toBe(true);\r\n\r\n      const response = await request(testApp)\r\n        .post('/api/v1/auth/refresh-from-remember-me')\r\n        .send({\r\n          token: tokenResult.token\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('sessionId');\r\n      expect(response.body).toHaveProperty('rememberMe', true);\r\n      expect(response.body).toHaveProperty('refreshedFrom', 'remember_me_token');\r\n    });\r\n\r\n    test('POST /api/v1/auth/disable-remember-me', async () => {\r\n      // Mock authenticated request\r\n      const mockUser = { id: 'user-123' };\r\n      \r\n      const response = await request(testApp)\r\n        .post('/api/v1/auth/disable-remember-me')\r\n        .set('Authorization', 'Bearer mock-session-token')\r\n        .send({\r\n          allDevices: false\r\n        });\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty('message');\r\n      expect(response.body.allDevices).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Security Features', () => {\r\n    test('should generate secure remember me token', async () => {\r\n      const mockReq = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n      };\r\n\r\n      const result = await sessionService.createRememberMeToken('user-123', mockReq);\r\n\r\n      expect(result.token).toMatch(/^[a-f0-9]{32}$/); // Hex string\r\n      expect(result.token).toHaveLength(64); // 32 bytes = 64 hex chars\r\n    });\r\n\r\n    test('should validate device fingerprint for remember me', async () => {\r\n      const mockReq1 = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Windows NT 10.0; Win64; x64)')\r\n      };\r\n\r\n      const mockReq2 = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)')\r\n      };\r\n\r\n      // Create token with first device\r\n      const tokenResult = await sessionService.createRememberMeToken('user-123', mockReq1);\r\n      expect(tokenResult.success).toBe(true);\r\n\r\n      // Try to refresh with different device fingerprint\r\n      const refreshResult = await sessionService.refreshFromRememberMeToken(tokenResult.token, mockReq2);\r\n      expect(refreshResult.success).toBe(false);\r\n      expect(refreshResult.reason).toContain('Device fingerprint mismatch');\r\n    });\r\n\r\n    test('should handle remember me token expiration', async () => {\r\n      const mockReq = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n      };\r\n\r\n      const result = await sessionService.createRememberMeToken('user-123', mockReq);\r\n      \r\n      // Fast forward time and check expiration\r\n      jest.useFakeTimers();\r\n      jest.advanceTimersByTime(31 * 24 * 60 * 60 * 1000); // 31 days later\r\n\r\n      const validation = await sessionService.validateRememberMeToken(result.token);\r\n      expect(validation.valid).toBe(false);\r\n      expect(validation.reason).toContain('expired');\r\n\r\n      jest.useRealTimers();\r\n    });\r\n  });\r\n\r\n  describe('Integration Tests', () => {\r\n    test('complete remember me flow', async () => {\r\n      const mockReq = {\r\n        ip: '127.0.0.1',\r\n        get: jest.fn().mockReturnValue('Mozilla/5.0 (Test Browser)')\r\n      };\r\n\r\n      // Step 1: Login with remember me\r\n      const loginResponse = await request(app)\r\n        .post('/api/v1/auth/login')\r\n        .send({\r\n          identifier: 'test@example.com',\r\n          password: 'password123',\r\n          rememberMe: true\r\n        });\r\n\r\n      expect(loginResponse.status).toBe(200);\r\n      expect(loginResponse.body.rememberMe).toBe(true);\r\n\r\n      // Step 2: Extract remember me cookie\r\n      const cookies = loginResponse.headers['set-cookie'];\r\n      const rememberMeCookie = cookies.find(cookie => cookie.startsWith('rememberMe='));\r\n      expect(rememberMeCookie).toBeDefined();\r\n\r\n      // Step 3: Validate remember me token (would need token extraction in real flow)\r\n      // This is a simplified test - in real flow, token would be extracted from cookie\r\n      const tokenResult = await sessionService.createRememberMeToken('user-123', mockReq);\r\n      expect(tokenResult.success).toBe(true);\r\n\r\n      // Step 4: Refresh session using token\r\n      const refreshResponse = await request(app)\r\n        .post('/api/v1/auth/refresh-from-remember-me')\r\n        .send({\r\n          token: tokenResult.token\r\n        });\r\n\r\n      expect(refreshResponse.status).toBe(200);\r\n      expect(refreshResponse.body.rememberMe).toBe(true);\r\n      expect(refreshResponse.body.sessionId).toBeDefined();\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}